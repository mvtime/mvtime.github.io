"use strict";(self["webpackChunkmvtime"]=self["webpackChunkmvtime"]||[]).push([[167],{1664:function(e,s,t){t.d(s,{A:function(){return m}});var a=t(6768),l=t(4232);const i=["title"],r=(0,a.Lk)("div",{class:"task_card_icon_container"},[(0,a.Lk)("div",{class:"task_card_icon_container__img"})],-1),o=[r],n={class:"task_card_details"},c={class:"task_card_details__title"},_={class:"task_card_details__extended"},d={class:"task_card_details__extended__date"},u={class:"task_card_details__extended__type"};function h(e,s,t,r,h,g){return(0,a.uX)(),(0,a.CE)("a",{class:"task_card",style:(0,l.Tr)({"--color-calendar-task":t.task.color})},[(0,a.Lk)("div",{class:"task_card_icon",title:t.task.class_name},o,8,i),(0,a.Lk)("div",n,[(0,a.Lk)("div",c,(0,l.v_)(t.task.name),1),(0,a.Lk)("div",_,[(0,a.Lk)("span",d,(0,l.v_)(t.task.date.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})),1),(0,a.eW)("  |  "),(0,a.Lk)("span",u,(0,l.v_)(g.type_full),1)])])],4)}var g={name:"ExamCard",props:{task:{type:Object,required:!0}},computed:{type_full(){return this.$magic.type_full(this.task.type)}}},k=t(1241);const p=(0,k.A)(g,[["render",h]]);var m=p},6890:function(e,s,t){t.r(s),t.d(s,{default:function(){return Ht}});t(4114);var a=t(6768),l=t(4232),i=t.p+"img/keyboard.9db02f10.svg";const r=e=>((0,a.Qi)("data-v-1b996766"),e=e(),(0,a.jt)(),e),o=["page"],n={class:"portal_content__spaced"},c={class:"portal_info calendar_width"},_={class:"portal_info_title"},d={class:"portal_info_usertype"},u={class:"portal_info_date"},h={class:"portal_info_welcome"},g={key:0,class:"portal_bottom_bar_container"},k={class:"portal_bottom_button_wrapper"},p=["_theme"],m=r((()=>(0,a.Lk)("div",{class:"theme_icon"},null,-1))),f=[m],y={class:"portal_bottom_button_wrapper"},v=r((()=>(0,a.Lk)("div",{class:"settings_icon"},null,-1))),$=[v],C=r((()=>(0,a.Lk)("div",{class:"admin_icon"},null,-1))),b=[C],w=r((()=>(0,a.Lk)("img",{alt:"icon",src:i,class:"toast-icon"},null,-1))),L={style:{"text-decoration":"underline"}},A={key:0},D={class:"portal_mobile_nav"},E=["id","onClick"],X=["src"];function T(e,s,t,i,r,m){const v=(0,a.g2)("LeftBar"),C=(0,a.g2)("ClassBar"),T=(0,a.g2)("StudyBlock"),q=(0,a.g2)("CalendarBlock"),S=(0,a.g2)("RightBar"),x=(0,a.g2)("router-view"),B=(0,a.g2)("OverlayWrapper");return(0,a.uX)(),(0,a.CE)("main",{class:"portal",page:r.page},[(0,a.bF)(v,{ref:"LeftBar",class:(0,l.C4)({paged:"left"==r.page}),paged:"left"==r.page,onToggle_filtered_class:m.toggle_filtered_class,onClear_filters:s[0]||(s[0]=e=>r.filtered_classes=[]),onSet_filtered_classes:s[1]||(s[1]=e=>r.filtered_classes=e||[]),filtered_classes:r.filtered_classes,onClose_right_bar:m.close_right_bar,onDragclass:s[2]||(s[2]=e=>{m.close_left_bar(),m.drag_class(e)}),onDrag:s[3]||(s[3]=s=>e.$refs.calendar.check_leave(s)),onDragend:s[4]||(s[4]=s=>e.$refs.calendar.drop_class(s)),onMounted:s[5]||(s[5]=s=>{r.loaded&&e.$refs.LeftBar.load()})},null,8,["class","paged","onToggle_filtered_class","filtered_classes","onClose_right_bar"]),(0,a.Lk)("div",{class:"portal_content",onClick:s[18]||(s[18]=e=>{m.close_right_bar(),m.close_left_bar()})},[(0,a.Lk)("div",n,[(0,a.Lk)("header",c,[(0,a.Lk)("div",_,[(0,a.Lk)("span",d,(0,l.v_)(e.$store.is_teacher?"Teacher":"Student")+" Dashboard",1),(0,a.Lk)("span",u,(0,l.v_)((new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),1)]),(0,a.Lk)("div",h,(0,l.v_)(e.$store.recently_joined?`Welcome to ${this.$env.VUE_APP_BRAND_NAME_SHORT}`:e.$store.non_recent_signin?"Welcome Back":m.random_welcome)+" "+(0,l.v_)(m.name)+"! ",1)]),r.loaded&&m.fullpage?((0,a.uX)(),(0,a.CE)("div",g,[(0,a.Lk)("div",k,[(0,a.Lk)("button",{class:"portal_bottom_button theme_button click-action",title:"Switch Theme",_theme:e.$store.get_theme,onClick:s[6]||(s[6]=(...s)=>e.$store.toggle_theme&&e.$store.toggle_theme(...s))},f,8,p)]),(0,a.bF)(C,{class:"portal_bottom_bar class_add_bar",onDragclass:s[7]||(s[7]=e=>m.drag_class(e)),onToggle_filtered_class:m.toggle_filtered_class,onClear_filters:s[8]||(s[8]=e=>r.filtered_classes=[]),onSet_filtered_classes:s[9]||(s[9]=e=>r.filtered_classes=e||[]),filtered_classes:r.filtered_classes,onDrag:s[10]||(s[10]=s=>e.$refs.calendar.check_leave(s)),onDragend:s[11]||(s[11]=s=>e.$refs.calendar.drop_class(s))},null,8,["onToggle_filtered_class","filtered_classes"]),(0,a.Lk)("div",y,[(0,a.Lk)("button",{class:"portal_bottom_button settings_button click-action",title:"Settings",onClick:s[12]||(s[12]=s=>e.$router.push({name:"settings",query:e.$route.query}))},$),e.$store.is_admin?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"portal_bottom_button admin_button click-action",title:"Admin Panel",onClick:s[13]||(s[13]=s=>e.$router.push({name:"admin",query:e.$route.query}))},b)):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0),r.is_study?((0,a.uX)(),(0,a.Wv)(T,{key:1,filtered_classes:r.filtered_classes,fullpage:m.fullpage,onTaskclick:s[14]||(s[14]=e=>m.show_task(e)),ref:"study",onMounted:s[15]||(s[15]=s=>{r.loaded&&e.$refs.study.run_get_tasks()})},null,8,["filtered_classes","fullpage"])):((0,a.uX)(),(0,a.Wv)(q,{key:2,filtered_classes:r.filtered_classes,fullpage:m.fullpage,onTaskclick:s[16]||(s[16]=e=>m.show_task(e)),ref:"calendar",dragging_class:r.dragging_class,onMounted:s[17]||(s[17]=s=>{r.loaded&&e.$refs.calendar.run_get_tasks()})},null,8,["filtered_classes","fullpage","dragging_class"]))])]),(0,a.bF)(S,{ref:"RightBar",class:(0,l.C4)({paged:"right"==r.page}),paged:"right"==r.page,onClose_left_bar:m.close_left_bar,onMounted:s[19]||(s[19]=s=>{r.loaded&&e.$refs.RightBar.load()})},null,8,["class","paged","onClose_left_bar"]),e.$shortcuts.is_active("addTaskDown")||e.$shortcuts.is_active("addTaskToast")?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,l.C4)(["action_add_shortcut_hint toast default noremove",{out:e.$shortcuts.is_active("addTaskToast")&&!e.$shortcuts.is_active("addTaskDown")}])},[w,(0,a.Lk)("div",null,[(0,a.eW)(" Waiting for rest of shortcut ( "),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.$magic.types,(s=>((0,a.uX)(),(0,a.CE)("span",{key:s.key},[(0,a.Lk)("span",L,(0,l.v_)(s.shortcuts[0].toLowerCase()),1),(0,a.Lk)("span",null,(0,l.v_)(s.name.slice(1)),1),e.$magic.types.indexOf(s)!==e.$magic.types.length-1?((0,a.uX)(),(0,a.CE)("span",A,", ")):(0,a.Q3)("",!0)])))),128)),(0,a.eW)(" ) ")])],2)):(0,a.Q3)("",!0),(0,a.Lk)("nav",D,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(["left","block","right"],(e=>(0,a.Lk)("button",{class:(0,l.C4)(["portal_mobile_nav_page",{active:r.page==e}]),id:"portal_mobile__"+e,key:e,onClick:s=>r.page=e},[(0,a.Lk)("span",{class:(0,l.C4)(["portal_mobile_nav_page__icon",{alt:r.page==e}]),src:`portal-${e}-icon`},null,10,X)],10,E))),64))]),["portal","study"].includes(e.$route.name)?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(B,{key:1,onClose:s[21]||(s[21]=s=>m.close_path?e.$router.push(m.close_path):e.$router.push({name:r.is_study?"study":"portal",query:{...e.$route.query,date:void 0}}))},{default:(0,a.k6)((e=>[(0,a.bF)(x,{class:"router_center_view",onClose:e.close,onClear_filters:s[20]||(s[20]=e=>r.filtered_classes=[])},null,8,["onClose"])])),_:1}))],8,o)}const q=e=>((0,a.Qi)("data-v-eb5465b8"),e=e(),(0,a.jt)(),e),S={class:"sidebar_overflow"},x={class:"branding-title gohome"},B=q((()=>(0,a.Lk)("div",{class:"flex_spacer"},null,-1))),j=q((()=>(0,a.Lk)("div",{class:"flex_spacer"},null,-1))),I=["_theme"],M=q((()=>(0,a.Lk)("div",{class:"theme_icon"},null,-1))),F=q((()=>(0,a.Lk)("div",{class:"toggle_text"},"Switch Theme",-1))),Q=[M,F];function R(e,s,t,i,r,o){const n=(0,a.g2)("ActionsPanel"),c=(0,a.g2)("ClassList"),_=(0,a.g2)("SidebarToggle");return(0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["left-bar portal_sidebar",{active:r.sidebar_open}]),onClick:s[2]||(s[2]=(...e)=>o.show_if_inactive&&o.show_if_inactive(...e))},[(0,a.Lk)("div",S,[(0,a.Lk)("div",x,(0,l.v_)(e.$env.VUE_APP_BRAND_NAME_LONG),1),B,e.$store&&e.$store.is_teacher?((0,a.uX)(),(0,a.Wv)(n,{key:0})):(0,a.Q3)("",!0),(0,a.bF)(c,(0,a.v6)(e.$attrs,{onDragclass:s[0]||(s[0]=s=>e.$emit("dragclass",s))}),null,16),j]),(0,a.Lk)("button",{_theme:e.$store.get_theme,class:"theme_button click-action",title:"Switch Theme",onClick:s[1]||(s[1]=(...s)=>e.$store.toggle_theme&&e.$store.toggle_theme(...s))},Q,8,I),(0,a.bF)(_,{class:"right",onClick:o.close_sidebar},null,8,["onClick"])],2)}const P=e=>((0,a.Qi)("data-v-2e4cb15c"),e=e(),(0,a.jt)(),e),W={class:"sidebar_toggle click-action",title:"Close Sidebar"},N=P((()=>(0,a.Lk)("div",{class:"arrow-icon"},null,-1))),U=[N];function O(e,s,t,l,i,r){return(0,a.uX)(),(0,a.CE)("button",W,U)}var K={name:"SidebarToggle"},z=t(1241);const H=(0,z.A)(K,[["render",O],["__scopeId","data-v-2e4cb15c"]]);var V=H;const Y=e=>((0,a.Qi)("data-v-c169f6cc"),e=e(),(0,a.jt)(),e),J={class:"class_list"},G={class:"class_list_header"},Z=Y((()=>(0,a.Lk)("h5",null,"Classes",-1))),ee=Y((()=>(0,a.Lk)("hr",{class:"class_list_hr"},null,-1))),se=["href","draggable","onDragstart","onDragend","onClick"],te=["_email","title","onClick"],ae={key:0,class:"class_swatch__icon class_swatch_remove__icon"},le={key:1,class:"class_swatch__icon class_swatch_edit__icon"},ie={class:"class_name"},re=Y((()=>(0,a.Lk)("div",{class:"class_swatch"},[(0,a.Lk)("div",{class:"class_swatch__add_icon"})],-1))),oe=Y((()=>(0,a.Lk)("span",{class:"class_name"},"Join a Class",-1))),ne=[re,oe];function ce(e,s,t,i,r,o){return(0,a.uX)(),(0,a.CE)("div",J,[(0,a.Lk)("div",{class:(0,l.C4)(["class_list__not_empty",{filtering:!!t.filtered_classes.length}])},[(0,a.Lk)("div",G,[Z,t.filtered_classes.length?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:s[0]||(s[0]=s=>e.$emit("clear_filters")),title:"Clear class section filters"}," Clear ")):(0,a.Q3)("",!0)]),ee,(0,a.Lk)("div",{class:(0,l.C4)(["classes_container",{filtering:!!t.filtered_classes.length}])},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.classes,(s=>((0,a.uX)(),(0,a.CE)("a",{class:(0,l.C4)(["classes_container_class",{filter_active:t.filtered_classes.includes(s.id),classes_container_class__dragging:r.dragging&&r.dragging.ref==s.ref}]),ref_for:!0,ref:s.ref,href:"/view/"+o.clean_ref(s.ref),draggable:e.$store.is_teacher&&s.email==e.$store.user.email&&"study"!=e.$route.name,onDragstart:a=>{e.$emit("dragclass",s),e.$emit("set_filtered_classes",[s.id]),r.dragging=s,r.prev_dragging=t.filtered_classes},onDragend:t=>{r.dragging=null,e.$emit("dragclass",{...s,_done:!0}),e.$emit("set_filtered_classes",r.prev_dragging)},key:s.name,onClick:t=>{e.$emit("toggle_filtered_class",s.id),t.preventDefault()},style:(0,l.Tr)({"--color-class":s.color,"--color-class-alt":s.color+"40"})},[(0,a.Lk)("div",{class:"class_swatch",_email:s.email,title:e.$store.is_teacher&&s.email==e.$store.user.email?"Edit Class":"Leave Class",onClick:t=>{e.$store.is_teacher&&s.email==e.$store.user.email?o.edit_class(s):o.leave_class(s),t.preventDefault(),t.stopPropagation()}},[e.$store.is_teacher&&s.email==e.$store.user.email?((0,a.uX)(),(0,a.CE)("div",le)):((0,a.uX)(),(0,a.CE)("div",ae))],8,te),(0,a.Lk)("span",ie,(0,l.v_)(e.$store.class_text(s)),1)],46,se)))),128)),(e.$store.is_teacher,(0,a.uX)(),(0,a.CE)("div",{key:0,class:"classes_container_class classes_container_class__add_class",onClick:s[1]||(s[1]=s=>e.$router.push({name:"addclass",query:e.$route.query}))},ne))],2)],2)])}var _e={props:{filtered_classes:{type:Array,default:()=>[]}},name:"ClassList",data(){return{dragging:null,prev_dragging:[]}},computed:{classes(){return this.$store.classes.map((e=>({...e,email:e.id.split("/")[0]})))}},emits:["toggle_filtered_class","clear_filters","dragclass","set_filtered_classes"],methods:{clean_ref(e){let[s,t]=e.split("/");return s=s.split("@")[0],[s,t].join("~")},leave_class(e){this.$router.push({name:"leave",params:{ref:this.clean_ref(e.id)},query:this.$route.query})},edit_class(e){this.$router.push({name:"editclass",params:{ref:this.clean_ref(e.id)},query:this.$route.query})}}};const de=(0,z.A)(_e,[["render",ce],["__scopeId","data-v-c169f6cc"]]);var ue=de;const he={class:"teacher_actions"},ge=["disabled","title","onClick"],ke=(0,a.Lk)("div",{class:"teacher_action__icon icon__add"},null,-1),pe={class:"teacher_action__text"},me=(0,a.Lk)("div",{class:"teacher_action__icon icon__create"},null,-1),fe=(0,a.Lk)("div",{class:"teacher_action__text"},"Create a Class",-1),ye=[me,fe];function ve(e,s,t,i,r,o){return(0,a.uX)(),(0,a.CE)("div",he,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.selected_types,(s=>((0,a.uX)(),(0,a.CE)("div",{disabled:!o.has_classes,title:o.has_classes?`${s.list_as} (${s.shortcuts.map((e=>"+ and "+e)).join(", ")})`:"Please create a class first",key:s.key,class:"teacher_action",onClick:t=>{o.has_classes?e.$router.push({name:"newtask",params:{tasktype:s.key},query:this.$route.query}):o.warn_missing_class()}},[ke,(0,a.Lk)("div",pe,(0,l.v_)(s.list_as),1)],8,ge)))),128)),(0,a.Lk)("div",{class:"teacher_action",onClick:s[0]||(s[0]=s=>e.$router.push({name:"createclass",query:e.$route.query}))},ye)])}var $e=t(4186),Ce={data(){return{plusDown:!1,equalDown:!1,toastTimeout:null}},mounted(){window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.short.register_all(this.shortcuts,"Teacher")},beforeUnmount(){window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup),this.short.remove_tag("Teacher")},computed:{selected_types(){return this.$magic.types.slice(0,2)},task_types(){return this.$magic.types.map((e=>[e.key,e.list_as,e.shortcuts]))},shortcuts(){return this.task_types.map((e=>({key:e[2].map((e=>"= + "+e)).join(", "),description:e[1]})))},short(){return this.$shortcuts},has_classes(){return this.$store?.active_doc?.classes?.length>0}},methods:{keyup(e){if("+"===e.key)this.plusDown=!1;else{if("="!==e.key)return;this.equalDown=!1}this.short.set_activity(this.plusDown||this.equalDown,"addTaskDown"),this.plusDown||this.equalDown||(window.clearTimeout(this.toastTimeout),this.short.set_activity(!0,"addTaskToast"),this.toastTimeout=window.setTimeout((()=>{this.short.set_activity(!1,"addTaskToast")}),500))},keydown(e){const s=e.key.toLowerCase();if(e.metaKey||"+"!==s&&"="!==s||("+"===s?this.plusDown=!0:"="===s&&(this.equalDown=!0),this.short.set_activity(this.plusDown||this.equalDown,"addTaskDown")),"newtask"==this.$route.name&&(this.plusDown||this.equalDown)){const t=this.task_types.find((e=>e[2].includes(s)));t&&(this.$router.push({name:"newtask",params:{tasktype:t[0]},query:this.$route.query}),e.preventDefault(),e.stopPropagation())}else if(this.short.is_active("addTaskDown")&&this.has_classes&&this.task_types.some((e=>e[2].includes(s)))){const t=this.task_types.find((e=>e[2].includes(s)));this.$router.push({name:"newtask",params:{tasktype:t[0]},query:this.$route.query}),e.preventDefault(),e.stopPropagation()}},warn_missing_class(){new $e.MY("Please create a class first",2e3)}}};const be=(0,z.A)(Ce,[["render",ve]]);var we=be,Le={name:"LeftBar",components:{SidebarToggle:V,ClassList:ue,ActionsPanel:we},props:{paged:{type:Boolean,default:!1}},emits:["close_right_bar","set_class","mounted","dragclass"],data(){return{sidebar_open:!1}},computed:{},mounted(){this.$emit("mounted"),window.addEventListener("resize",this.close_sidebar)},unmounted(){window.removeEventListener("resize",this.close_sidebar)},methods:{placeholderToast:$e.jT,show_if_inactive(){this.sidebar_open||(this.sidebar_open=!0),this.$emit("close_right_bar")},close_sidebar(){this.sidebar_open&&setTimeout((()=>this.sidebar_open=!1),10)},set_class(e){this.$emit("set_class",e)},load(){this.loading=!1}},watch:{paged(){this.paged&&(this.sidebar_open=!0)}}};const Ae=(0,z.A)(Le,[["render",R],["__scopeId","data-v-eb5465b8"]]);var De=Ae,Ee=t(334);const Xe=e=>((0,a.Qi)("data-v-47567720"),e=e(),(0,a.jt)(),e),Te={class:"sidebar_overflow"},qe={class:"sidebar_first_block auth-action can-logout doprompt"},Se={key:0,class:"linked_acc_icon"},xe=Xe((()=>(0,a.Lk)("img",{class:"linked_acc_icon__img",width:"24",height:"24",src:Ee,alt:"Linked Account"},null,-1))),Be=[xe],je=["title"],Ie=["src"],Me=Xe((()=>(0,a.Lk)("div",{class:"auth_logout can_logout"},"Log Out",-1))),Fe=Xe((()=>(0,a.Lk)("div",{class:"flex_spacer"},null,-1))),Qe=Xe((()=>(0,a.Lk)("div",{class:"flex_spacer"},null,-1))),Re=Xe((()=>(0,a.Lk)("div",{class:"settings_icon"},null,-1))),Pe=[Re],We=Xe((()=>(0,a.Lk)("div",{class:"admin_icon"},null,-1))),Ne=[We];function Ue(e,s,t,i,r,o){const n=(0,a.g2)("UpcomingTasks"),c=(0,a.g2)("SidebarToggle");return(0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["right-bar portal_sidebar",{active:r.sidebar_open}]),onClick:s[2]||(s[2]=(...e)=>o.show_if_inactive&&o.show_if_inactive(...e))},[(0,a.Lk)("div",Te,[(0,a.Lk)("div",qe,[e.$store&&e.$store.personal_account?((0,a.uX)(),(0,a.CE)("div",Se,Be)):e.$store&&e.$store.user&&o.user_pfp?((0,a.uX)(),(0,a.CE)("div",{key:1,class:"active_acc_icon",title:`Logged in as ${e.$store.user.displayName} (${this.$store.user.email})`},[(0,a.Lk)("img",{class:"active_acc_icon__img",width:"26",height:"26",src:o.user_pfp,referrerpolicy:"no-referrer",alt:"Account Profile Image"},null,8,Ie)],8,je)):(0,a.Q3)("",!0),Me]),Fe,(0,a.bF)(n,{loading:r.loading},null,8,["loading"]),Qe]),(0,a.Lk)("button",{class:"settings_button click-action",title:"Settings",onClick:s[0]||(s[0]=s=>e.$router.push({name:"settings",query:e.$route.query}))},Pe),e.$store.is_admin?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"portal_bottom_button admin_button click-action",title:"Admin Panel",onClick:s[1]||(s[1]=s=>e.$router.push({name:"admin",query:e.$route.query}))},Ne)):(0,a.Q3)("",!0),(0,a.bF)(c,{onClick:o.close_sidebar},null,8,["onClick"])],2)}var Oe=t(5130);const Ke=e=>((0,a.Qi)("data-v-73205d16"),e=e(),(0,a.jt)(),e),ze={class:"upcoming_tasks"},He={key:0,class:"upcoming_tasks__not_empty"},Ve=Ke((()=>(0,a.Lk)("hr",{class:"upcoming_tasks_hr"},null,-1))),Ye={key:1,class:"loading_tasks loading_icon",alt:"Loading..."},Je={key:1,class:"upcoming_tasks__empty"},Ge=Ke((()=>(0,a.Lk)("h5",null,"No upcoming tasks!",-1))),Ze=[Ge];function es(e,s,t,l,i,r){const o=(0,a.g2)("router-link"),n=(0,a.g2)("ExamCard");return(0,a.uX)(),(0,a.CE)("div",ze,[r.tasks&&r.tasks.length||t.loading?((0,a.uX)(),(0,a.CE)("div",He,[(0,a.Lk)("h5",null,[(0,a.bF)(o,{to:{name:"study"},class:"upcoming_tasks__title"},{default:(0,a.k6)((()=>[(0,a.eW)("Upcoming")])),_:1})]),Ve,r.tasks&&r.tasks.length?((0,a.uX)(),(0,a.Wv)(Oe.F,{key:0,class:"tasks_container",name:"upcoming-group",tag:"div"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.tasks,(s=>((0,a.uX)(),(0,a.Wv)(n,{class:"tasks_container_task",task:s,key:s.ref,href:`/view/${e.$store.path_to_ref(s.ref)}`,target:"_blank",onClick:e=>{e.preventDefault(),r.show_task(s)}},null,8,["task","href","onClick"])))),128))])),_:1})):((0,a.uX)(),(0,a.CE)("img",Ye))])):((0,a.uX)(),(0,a.CE)("div",Je,Ze))])}var ss=t(1664),ts={name:"UpcomingTasks",props:{loading:{type:Boolean,default:!1}},components:{ExamCard:ss.A},computed:{tasks(){return this.$store.upcoming_todo.slice(0,6)}},methods:{show_task(e){this.$router.push({name:"viewtask",params:{ref:this.$store.path_to_ref(e.ref)},query:this.$route.query})}}};const as=(0,z.A)(ts,[["render",es],["__scopeId","data-v-73205d16"]]);var ls=as,is={name:"RightBar",components:{SidebarToggle:V,UpcomingTasks:ls},props:{paged:{type:Boolean,default:!1}},emits:["close_left_bar","mounted"],data(){return{sidebar_open:!1,loading:!0}},computed:{user_pfp(){return this.$store&&this.$store.user&&this.$store.user.photoURL?this.$store.user.photoURL.replace("s96-c","s26-c"):null}},mounted(){this.$emit("mounted"),window.addEventListener("resize",this.close_sidebar)},unmounted(){window.removeEventListener("resize",this.close_sidebar)},methods:{show_if_inactive(){this.sidebar_open||(this.sidebar_open=!0),this.$emit("close_left_bar")},close_sidebar(){this.sidebar_open&&setTimeout((()=>this.sidebar_open=!1),10)},load(){this.loading=!1}},watch:{paged(){this.paged&&(this.sidebar_open=!0)}}};const rs=(0,z.A)(is,[["render",Ue],["__scopeId","data-v-47567720"]]);var os=rs;const ns=e=>((0,a.Qi)("data-v-0c6fb4f8"),e=e(),(0,a.jt)(),e),cs={class:"study_header portal_main_block_header"},_s={class:"portal_main_block_header__left"},ds=ns((()=>(0,a.Lk)("div",{class:"study_name portal_main_block_title"},[(0,a.eW)(" Upcoming"),(0,a.Lk)("span",{class:"desktop_only may_break_text"}," Assignments")],-1))),us={class:"portal_main_block_actions_wrapper"},hs={class:"portal_main_block_actions portal_main_block_actions_freeform"},gs=["onClick","title"],ks={class:"portal_main_block_actions portal_main_block_actions_freeform"},ps=["onClick","title"],ms=ns((()=>(0,a.Lk)("div",{class:"action_icon session-icon"},null,-1))),fs=[ms],ys=["href"],vs={key:1,class:"study_list__name study_list__name__days"},$s=ns((()=>(0,a.Lk)("hr",{class:"study_list__separator"},null,-1))),Cs=["finished"],bs=["for","title","onClick"],ws=ns((()=>(0,a.Lk)("div",{class:"study_list_task_checkbox__fixed"},[(0,a.Lk)("span",{class:"study_list_task_checkbox__dot"})],-1))),Ls=[ws],As=["for","onClick","href"],Ds={class:"study_list_task__name__text"},Es={class:"study_list_task__date study_list_task__boxed"},Xs=["href"],Ts={key:1,class:"study_list__name study_list__name__days"},qs=ns((()=>(0,a.Lk)("hr",{class:"study_list__separator"},null,-1))),Ss=["finished"],xs=["for","title","onClick"],Bs=ns((()=>(0,a.Lk)("div",{class:"study_list_task_checkbox__fixed"},[(0,a.Lk)("span",{class:"study_list_task_checkbox__dot"})],-1))),js=[Bs],Is=["for","onClick","href"],Ms={class:"study_list_task__name__text"},Fs={class:"study_list_task__date study_list_task__boxed"};function Qs(e,s,t,i,r,o){const n=(0,a.g2)("LoadingCover");return(0,a.uX)(),(0,a.CE)("main",{class:(0,l.C4)(["study portal_main_block",{study_fullpage:t.fullpage}])},[r.is_ready?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(n,{key:0,class:"study_loading",covering:"Study Tasks"})),(0,a.Lk)("div",cs,[(0,a.Lk)("div",_s,[(0,a.Lk)("button",{class:"portal_main_block_action portal_main_block_action_alt fullpage_toggle_button",onClick:s[0]||(s[0]=(...e)=>o.toggle_fullscreen&&o.toggle_fullscreen(...e)),title:"Toggle fullscreen (f)"},[(0,a.Lk)("div",{class:(0,l.C4)(["action_icon expand-icon",{alt:t.fullpage}])},null,2)]),ds]),(0,a.Lk)("div",us,[(0,a.Lk)("nav",hs,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.sorts,(e=>((0,a.uX)(),(0,a.CE)("button",{class:(0,l.C4)(["portal_main_block_action portal_main_block_action_freeform portal_main_block_action__text",{active:r.sort==e[0]}]),onClick:s=>r.sort=e[0],title:`${e[2]} (${e[3]})`,key:e[0]},(0,l.v_)(e[1]),11,gs)))),128))]),(0,a.Lk)("nav",ks,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.lengths,(e=>((0,a.uX)(),(0,a.CE)("button",{class:(0,l.C4)(["portal_main_block_action portal_main_block_action_freeform portal_main_block_action__text",{active:r.days==e[0]}]),onClick:s=>r.days=e[0],title:`${e[2]} (${e[3]})`,key:e[0]},(0,l.v_)(e[1]),11,ps)))),128))]),"studysession"!=e.$route.name?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"portal_main_block_action portal_main_block_action_alt",title:"Create Study Session (s)",onClick:s[1]||(s[1]=(...e)=>o.start_session&&o.start_session(...e))},fs)):(0,a.Q3)("",!0),(0,a.Lk)("button",{class:"portal_main_block_action portal_main_block_action_alt",title:"View Calendar (c)",onClick:s[2]||(s[2]=(...e)=>o.swap_to_calendar&&o.swap_to_calendar(...e))},[(0,a.Lk)("div",{class:(0,l.C4)(["action_icon cal-icon",{alt:e.$store.upcoming&&e.$store.upcoming.length}])},null,2)])])]),"classes"==r.sort?((0,a.uX)(),(0,a.Wv)(Oe.F,{key:1,class:(0,l.C4)(["study_list_group study_list_group__classes",{filtered:t.filtered_classes.length}]),name:"study-group",tag:"div"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.arranged_classes,(s=>((0,a.uX)(),(0,a.CE)("div",{class:"study_list",key:"classes"==r.sort?s[0].class_id:s[0].date.toISOString().split("T")[0],style:(0,l.Tr)({"--color-class":"classes"==r.sort?o.classes[s[0].class_id].color:"var(--color-on-calendar)","--color-class-alt":"classes"==r.sort?o.classes[s[0].class_id].color+"2d":"var(--color-on-bg)"})},["classes"==r.sort?((0,a.uX)(),(0,a.CE)("a",{key:0,class:"study_list__name study_list__name__classes",href:`/view/${e.$store.path_to_ref(o.classes[s[0].class_id].ref)}`},(0,l.v_)(s[0].class_name),9,ys)):((0,a.uX)(),(0,a.CE)("div",vs,(0,l.v_)(s[0].date.toLocaleDateString(void 0,{month:"long",day:"numeric"})),1)),$s,(0,a.bF)(Oe.F,{class:"study_list_tasks",name:"study-list",tag:"div"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s,(s=>((0,a.uX)(),(0,a.CE)("div",{class:"study_list_task",key:s.ref,finished:o.is_finished(s.ref),style:(0,l.Tr)({"--color-class":o.classes[s.class_id].color,"--color-class-alt":o.classes[s.class_id].color+"2d"})},[(0,a.Lk)("label",{for:s.ref,class:"study_list_task_checkbox",title:"Mark task as "+(o.is_finished(s.ref)?"unfinished":"finished"),onClick:e=>o.toggle_finished(s.ref)},Ls,8,bs),(0,a.Lk)("a",{class:"study_list_task__name study_list_task__boxed",for:s.ref,onClick:t=>{e.$emit("taskclick",s),t.preventDefault()},href:"/view/"+e.$store.path_to_ref(s.ref)},[(0,a.Lk)("span",Ds,(0,l.v_)(e.$magic.prefix(s))+" "+(0,l.v_)(s.name),1)],8,As),(0,a.Lk)("span",Es,(0,l.v_)(s.date&&s.date.toLocaleDateString(void 0,{month:"numeric",day:"numeric"})||"Invalid Date"),1)],12,Cs)))),128))])),_:2},1024)],4)))),128))])),_:1},8,["class"])):((0,a.uX)(),(0,a.Wv)(Oe.F,{key:2,class:(0,l.C4)(["study_list_group study_list_group__dates",{filtered:t.filtered_classes.length}]),name:"study-group",tag:"div"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.arranged_dates,(s=>((0,a.uX)(),(0,a.CE)("div",{class:"study_list",key:s[0].date.toISOString().split("T")[0],style:{"--color-class":"var(--color-on-calendar)","--color-class-alt":"var(--color-on-bg)"}},["classes"==r.sort?((0,a.uX)(),(0,a.CE)("a",{key:0,class:"study_list__name study_list__name__classes",href:`/view/${e.$store.path_to_ref(o.classes[s[0].class_id].ref)}`},(0,l.v_)(s[0].class_name),9,Xs)):((0,a.uX)(),(0,a.CE)("div",Ts,(0,l.v_)(s[0].date.toLocaleDateString(void 0,{month:"long",day:"numeric"})),1)),qs,(0,a.bF)(Oe.F,{class:"study_list_tasks",name:"study-list",tag:"div"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s,(s=>((0,a.uX)(),(0,a.CE)("div",{class:"study_list_task",key:s.ref,finished:o.is_finished(s.ref),style:(0,l.Tr)({"--color-class":o.classes[s.class_id].color,"--color-class-alt":o.classes[s.class_id].color+"2d"})},[(0,a.Lk)("label",{for:s.ref,class:"study_list_task_checkbox",title:"Mark task as "+(o.is_finished(s.ref)?"unfinished":"finished"),onClick:e=>o.toggle_finished(s.ref)},js,8,xs),(0,a.Lk)("a",{class:"study_list_task__name study_list_task__boxed",for:s.ref,onClick:t=>{e.$emit("taskclick",s),t.preventDefault()},href:"/view/"+e.$store.path_to_ref(s.ref)},[(0,a.Lk)("span",Ms,(0,l.v_)(e.$magic.prefix(s))+" "+(0,l.v_)(s.name),1)],8,Is),(0,a.Lk)("span",Fs,(0,l.v_)(s.date&&s.date.toLocaleDateString(void 0,{month:"numeric",day:"numeric"})||"Invalid Date"),1)],12,Ss)))),128))])),_:2},1024)])))),128))])),_:1},8,["class"]))],2)}const Rs=e=>((0,a.Qi)("data-v-523271bf"),e=e(),(0,a.jt)(),e),Ps=["title"],Ws=Rs((()=>(0,a.Lk)("div",{class:"loading_cover__overlay"},null,-1))),Ns={class:"loading_cover__content"},Us=Rs((()=>(0,a.Lk)("div",{class:"loading_cover__content__icon"},[(0,a.Lk)("img",{class:"loading_icon"})],-1)));function Os(e,s,t,l,i,r){return(0,a.uX)(),(0,a.CE)("div",{class:"loading_cover",title:"Loading "+t.covering},[Ws,(0,a.Lk)("div",Ns,[Us,(0,a.RG)(e.$slots,"default",{},void 0,!0)])],8,Ps)}var Ks={name:"LoadingCover",props:{covering:{type:String,default:"Content"}}};const zs=(0,z.A)(Ks,[["render",Os],["__scopeId","data-v-523271bf"]]);var Hs=zs,Vs={name:"StudyBlock",components:{LoadingCover:Hs},props:{filtered_classes:{Array:Array,default:()=>[]},fullpage:{Boolean:Boolean,default:!1}},emits:["taskclick","mounted"],data(){return{sort:"classes",sorts:[["classes","Class","Group tasks by course section","g"],["dates","Date","Group tasks by end date","t"]],tasks:[],is_ready:!1,days:7,lengths:[[1,"Day","Tasks today","d"],[7,"Week","Tasks in the next week","w"],[31,"Month","Tasks in the next month","m"],[Number.MAX_SAFE_INTEGER,"All","All upcoming tasks","a"]]}},mounted(){this.$status.log("👓 Study page mounted"),this.$emit("mounted"),this.tasks=this.$store.tasks,window.addEventListener("keydown",this.handle_key),this.$shortcuts.register_all(this.shortcuts,"Study Portal")},beforeUnmount(){window.removeEventListener("keydown",this.handle_key),this.$shortcuts.remove_tag("Study Portal")},computed:{shortcuts(){return[{key:"f",description:"Toggle fullscreen",top:!0},{key:"` or c",description:"Swap to calendar",top:!0},{key:"s",description:"Create study session",top:!0},...this.lengths.map((e=>({key:e[3],description:`View ${e[1].toLowerCase()} tasks`})))]},classes(){let e={};for(let s of this.$store.classes)e[s.id]=s;return e},filtered_tasks(){let e=this.tasks?.filter((e=>!this.filtered_classes.length||this.filtered_classes.includes(e.class_id)));const s=Date.now(),t=576e5;return e=e.filter((e=>{const a=e?.date?.getTime?e.date.getTime():0;return"note"!=e.type&&a>=s-t&&a<=s+24*this.days*60*60*1e3})).sort(((e,s)=>e.date<s.date?-1:e.date>s.date?1:0)),e.sort(((e,s)=>{let t=this.$store.finished_tasks.includes(e.ref),a=this.$store.finished_tasks.includes(s.ref);return t&&!a?1:!t&&a?-1:0})),e},arranged_classes(){return this.arranged("classes")},arranged_dates(){return this.arranged("dates")}},methods:{arranged(e){let s=this.filtered_tasks,t={};for(let l of s)if("classes"==e)t[l.class_id]||(t[l.class_id]=[]),t[l.class_id].push(l);else{let e=l.date.toISOString().split("T")[0];t[e]||(t[e]=[]),t[e].push(l)}let a=[];for(let l in t)a.push(t[l]);return a.sort(((s,t)=>{if("classes"==e){let e=this.classes[s[0].class_id],a=this.classes[t[0].class_id];return e.period-a.period}return s[0].date<t[0].date?-1:s[0].date>t[0].date?1:0})),a},toggle_fullscreen(){const e=!this.fullpage;let s={...this.$route.query};e?s.calendar=!0:delete s.calendar,this.$router.push({...this.$route,query:s})},handle_key(e){if(!(e.ctrlKey||e.metaKey||e.shiftKey||"study"!=this.$route.name))if("f"==e.key)this.toggle_fullscreen();else if("c"==e.key||"`"==e.key)this.swap_to_calendar();else if("s"==e.key)this.start_session();else{let s=this.lengths.find((s=>s[3]==e.key));s&&(this.days=s[0])}},swap_to_calendar(){this.$router.push({name:"portal",query:this.$route.query})},start_session(){this.$router.push({name:"studysession",query:this.$route.query})},run_get_tasks(){this.tasks=this.$store.tasks,this.is_ready=!0},is_finished(e){return this.$store.finished_tasks?.includes(e)},toggle_finished(e){this.$store.set_finished(!this.is_finished(e),e).then((()=>{this.$status.log("📦 Task completion status set")})).catch((e=>{this.$status.error("🔥 Couldn't set task finished",e)}))}},watch:{"$store.classes":{handler(e,s){e.length!=s.length&&this.is_ready&&(this.$status.log("📦 Classes array length changed, calendar updating tasks"),this.$store.fetch_classes().then((()=>{this.run_get_tasks()})).catch((e=>{this.$status.error("🔥 Couldn't fetch classes",e)})))},deep:!0},"$store.tasks":{handler(){this.tasks=this.$store.tasks},deep:!0},$route:{handler(){"study"==this.$route.name&&this.$route.query.selected&&this.$router.replace({query:{...this.$route.query,selected:void 0,time:void 0,passed:void 0}})},deep:!0}}};const Ys=(0,z.A)(Vs,[["render",Qs],["__scopeId","data-v-0c6fb4f8"]]);var Js=Ys;const Gs=e=>((0,a.Qi)("data-v-03a15d4f"),e=e(),(0,a.jt)(),e),Zs={class:"calendar_header portal_main_block_header"},et={class:"portal_main_block_header__left"},st=["title"],tt={class:"portal_main_block_actions_wrapper"},at={class:"portal_main_block_actions"},lt=Gs((()=>(0,a.Lk)("div",{class:"action_icon arrow-icon left"},null,-1))),it=[lt],rt=Gs((()=>(0,a.Lk)("div",{class:"action_icon arrow-icon right"},null,-1))),ot=[rt],nt={class:"calendar_day__weekday_label__text"},ct=["_date","onDragover"],_t=["onClick"],dt={class:"calendar_day_date__short"},ut={class:"calendar_day_date__long",style:{display:"none"}},ht={class:"calendar_day_tasks"},gt=["is_note","title","draggable","onDragstart","href","onClick"],kt={key:0,class:"calendar_day_task_editable"},pt={key:1},mt=Gs((()=>(0,a.Lk)("span",{class:"calendar_day_task__swatch"},null,-1))),ft=Gs((()=>(0,a.Lk)("span",{class:"calendar_day_task__note"}," NOTE ",-1))),yt=[mt,ft],vt={key:2},$t={key:0,class:"calendar__no_tasks",style:{display:"none"}};function Ct(e,s,t,i,r,o){const n=(0,a.g2)("LoadingCover");return(0,a.uX)(),(0,a.CE)("main",{class:(0,l.C4)(["calendar portal_main_block",{calendar_fullpage:t.fullpage}]),onDrag:s[6]||(s[6]=(...e)=>o.check_leave&&o.check_leave(...e)),onMousewheel:s[7]||(s[7]=(...e)=>o.page_flip&&o.page_flip(...e))},[r.is_ready?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(n,{key:0,class:"calendar_loading",covering:"Calendar Tasks"})),(0,a.Lk)("div",Zs,[(0,a.Lk)("div",et,[(0,a.Lk)("button",{class:"portal_main_block_action portal_main_block_action_alt fullpage_toggle_button",onClick:s[0]||(s[0]=(...e)=>o.toggle_fullscreen&&o.toggle_fullscreen(...e)),title:"Toggle fullscreen (f)"},[(0,a.Lk)("div",{class:(0,l.C4)(["action_icon expand-icon",{alt:t.fullpage}])},null,2)]),(0,a.Lk)("div",{class:"calendar_date portal_main_block_title",title:"Currently viewing "+r.loaded_month.toLocaleDateString(void 0,{month:"long",year:"numeric"})},(0,l.v_)(r.loaded_month.toLocaleDateString("en-US",{month:"long",year:"numeric"})),9,st)]),(0,a.Lk)("div",tt,[(0,a.Lk)("nav",at,[(0,a.Lk)("button",{class:"portal_main_block_action",onClick:s[1]||(s[1]=(...e)=>o.prev_month&&o.prev_month(...e)),title:"Previous month (Left)"},it),(0,a.Lk)("button",{class:"portal_main_block_action",onClick:s[2]||(s[2]=(...e)=>o.this_month&&o.this_month(...e)),title:"Current month (Home)"},[(0,a.Lk)("div",{class:(0,l.C4)(["action_icon cal-icon",{alt:r.tasks&&r.tasks.length}])},null,2)]),(0,a.Lk)("button",{class:"portal_main_block_action",onClick:s[3]||(s[3]=(...e)=>o.next_month&&o.next_month(...e)),title:"Next month (Right)"},ot)]),(e.$store.is_teacher,(0,a.uX)(),(0,a.CE)("button",{key:0,class:"portal_main_block_action portal_main_block_action_alt",onClick:s[4]||(s[4]=(...e)=>o.swap_to_study&&o.swap_to_study(...e)),title:"View study portal (s)"},[(0,a.Lk)("div",{class:(0,l.C4)(["action_icon todo-icon",{alt:e.$store.upcoming_todo&&e.$store.upcoming_todo.length}])},null,2)]))])]),(0,a.Lk)("div",{class:"calendar_days_container hidescroll",style:(0,l.Tr)({"--color-dragging":r.drag.task&&r.drag.task.color||r.drag.class&&r.drag.class.color,"--color-dragging-alt":r.drag.task&&r.drag.task.color||r.drag.class&&r.drag.class.color?(r.drag.task&&r.drag.task.color||r.drag.class&&r.drag.class.color)+"80":null})},[(0,a.Lk)("div",{class:(0,l.C4)(["calendar_days",{calendar_days__current:o.day_matches(r.loaded_month,new Date((new Date).setDate(1))),calendar_days__changed:r.is_changed}]),ref:"calendar_days"},[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],(e=>(0,a.Lk)("div",{class:"calendar_day calendar_day__weekday_label",key:e},[(0,a.Lk)("span",nt,(0,l.v_)(e),1)]))),64)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.days,(t=>((0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["calendar_day",{calendar_day__placeholder:t.is_placeholder&&!e.$store.simplified,calendar_day__hastask:!!t.tasks&&t.tasks.length,calendar_day__today:t.is_today,calendar_day__past:t.is_past,calendar_day__drag_to:r.drag.to==t.date,calendar_day__drag_class_to:r.drag.to==t.date&&r.drag.class,calendar_day__drag_from:r.drag.from==t.date}]),_date:t.date.toISOString().split("T")[0],onDragover:e=>o.drag_over(t.date),key:t.date},[(0,a.Lk)("div",{class:(0,l.C4)(["calendar_day_date",{"click-action":e.$store.is_teacher}]),onClick:s=>{e.$store.is_teacher&&e.$router.push({name:"newtask",query:{date:o.format_date(t.date),...this.$route.query}})}},[(0,a.Lk)("span",dt,(0,l.v_)(t.date.getDate()),1),(0,a.Lk)("span",ut,(0,l.v_)(t.date.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})),1)],10,_t),(0,a.Lk)("div",ht,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.tasks,(i=>((0,a.uX)(),(0,a.CE)("a",{class:(0,l.C4)(["calendar_day_task click-action",{calendar_day_task__dragging:r.drag.task==i,calendar_day_task__loading:r.drag.task==i&&r.drag.load,calendar_day_task__finished:o.is_completed(i)}]),is_note:"note"===i.type,key:i.name,title:i.name,draggable:i&&e.$store.is_teacher&&e.$store.user&&i.ref.split("/")[0]==e.$store.active_doc.email&&"study"!=e.$route.name,onDragstart:e=>r.drag={task:i,from:t.date},onDragend:s[5]||(s[5]=(...e)=>o.drag_drop&&o.drag_drop(...e)),style:(0,l.Tr)({"--color-calendar-task":i.color,"--color-calendar-task-alt":i.color+"40"}),href:"/view/"+o.get_link(i.ref),onClick:s=>{s.preventDefault(),s.ctrlKey||s.metaKey?"note"!=i.type&&e.$store.set_finished(!e.$store.finished_tasks.includes(i.ref),i.ref):e.$emit("taskclick",i)}},[i&&e.$store.is_teacher&&e.$store.user&&i.ref.split("/")[0]==e.$store.active_doc.email?((0,a.uX)(),(0,a.CE)("div",kt,[(0,a.Lk)("span",{class:(0,l.C4)(["task_icon task_edit__icon",{loading_bg:r.drag.load}])},null,2)])):(0,a.Q3)("",!0),"note"===i.type?((0,a.uX)(),(0,a.CE)("span",pt,yt)):((0,a.uX)(),(0,a.CE)("span",vt,(0,l.v_)(i.name),1))],46,gt)))),128))])],42,ct)))),128)),o.tasks_loaded_month?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",$t," Relax! No Tasks. "))],2)],4)],34)}var bt=t(6301),wt={name:"CalendarBlock",components:{LoadingCover:Hs},props:{filtered_classes:{Array:Array,default:()=>[]},dragging_class:{Object:Object,default:()=>null},fullpage:{Boolean:Boolean,default:!1}},emits:["taskclick","mounted"],data(){return{wheel:{initial:!1,timeout:null},loaded_month:new Date((new Date).setDate(1)),is_ready:!1,tasks:[],is_changed:!1,drag:{},shortcuts:[{key:"f",description:"Toggle fullscreen"},{key:"Ctrl + 🖱",description:"Mark task finished"},{key:"` or s",description:"Swap to study portal",top:!0},{key:"ArrowLeft",description:"Previous month"},{key:"Shift + ArrowLeft",description:"Previous year"},{key:"ArrowRight",description:"Next month"},{key:"Shift + ArrowRight",description:"Next year"},{key:"Home",description:"Current month"}]}},mounted(){this.$status.log("📅 Calendar mounted"),this.$emit("mounted"),this.tasks=this.$store.tasks,window.addEventListener("keydown",this.handle_key),this.$shortcuts.register_all(this.shortcuts,"Calendar")},beforeUnmount(){window.removeEventListener("keydown",this.handle_key),this.$shortcuts.remove_tag("Calendar")},methods:{page_flip(e){if(0==e.button&&!(Math.abs(e.deltaX)<Math.max(Math.abs(e.deltaY),10)))return this.wheel.initial||(e.deltaX>0?this.next_month():e.deltaX<0&&this.prev_month(),this.wheel.initial=!0,this.timeout=setTimeout((()=>{this.wheel.initial=!1}),700)),e.deltaX?(e.preventDefault(),e.stopPropagation(),!1):void 0},toggle_fullscreen(){const e=!this.fullpage;let s={...this.$route.query};e?s.calendar=!0:delete s.calendar,this.$router.push({...this.$route,query:s})},handle_key(e){if(e.ctrlKey||e.metaKey||"portal"!=this.$route.name)return;if(!e.shiftKey){if("s"==e.key||"`"==e.key)return void this.swap_to_study();if("f"==e.key&&!e.ctrlKey&&!e.metaKey)return void this.toggle_fullscreen()}const s=e.shiftKey;let t=()=>{};if("ArrowLeft"==e.key)t=this.prev_month;else if("ArrowRight"==e.key)t=this.next_month;else if("Home"==e.key)return void this.this_month();for(let a=0;a<(s?12:1);a++)t()},swap_to_study(){this.$router.push({name:"study",query:this.$route.query})},check_leave(e){try{const s=this.$refs.calendar_days.getBoundingClientRect();this.drag.to&&(e.clientX||e.clientX)&&(e.clientX<s.left||e.clientX>s.right||e.clientY<s.top||e.clientY>s.bottom)&&(this.drag.to=null)}catch(s){this.$status.error("🔥 Couldn't check if mouse left calendar",s)}},drop_class(){this.drag?.class&&this.drag?.to&&(this.$status.log("📅 Dropped class on calendar day"),this.$router.push({name:"newtask",query:{class:this.drag.class.id,date:new Date(this.drag.to.getTime()-60*this.drag.to.getTimezoneOffset()*1e3).toISOString().split("T")[0],...this.$route.query}})),this.drag={}},drag_over(e){this.drag.to!=e&&(this.drag.class?this.drag.to=e:this.drag.to=this.drag.to!=this.drag.from?e:null)},drag_drop(){if(this.drag.to&&this.drag.from&&this.drag.to!=this.drag.from&&this.drag.task){let e=this.drag.to;this.drag.load=!0,this.drag.to=null,this.$store.update_task(this.drag.task.ref,{...this.drag.task,date:new Date(e-60*e.getTimezoneOffset()*1e3).toISOString().split("T")[0]}).then((()=>{new $e.rQ(`Moved ${this.drag.task.type} ${this.drag.task.name?'"'+this.drag.task.name+'" ':""}to ${e.toLocaleDateString()}`,2e3),this.$status.log("📅 Moved task date"),this.drag={}})).catch((e=>{new $e.Qp("Couldn't update task",e,2e3),this.$status.error("🔥 Couldn't update task",e),this.drag={}}))}else this.drag={}},format_date(e){return e.toISOString().split("T")[0]||""},day_matches(e,s){return e.getDate()===s.getDate()&&e.getMonth()===s.getMonth()&&e.getFullYear()===s.getFullYear()},is_completed(e){return this.$store.finished_tasks?.includes(e.ref)},get_day_tasks(e){return this.tasks.filter((s=>{if(this.$store?.account_doc?.prefs?.hide_finished&&this.is_completed(s))return!1;const t=(0,bt.kX)(s.date);return this.day_matches(t,e)&&(!this.filtered_classes.length||this.filtered_classes.includes(s.class_id))})).sort(((e,s)=>{if(this.is_completed(e)&&!this.is_completed(s))return 1;if(!this.is_completed(e)&&this.is_completed(s))return-1;if(e.type!=s.type){let t=!this.$store?.account_doc?.prefs?.derank_notes;if(t&&"note"==e.type)return-1;if(t&&"note"==s.type)return 1;if("note"==e.type&&"note"!=s.type)return 1;if("note"!=e.type&&"note"==s.type)return-1}return e.period&&!s.period?-1:!e.period&&s.period?1:e.period&&s.period?e.period-s.period:void 0}))},next_month(){this.is_changed=!0,this.loaded_month=new Date(this.loaded_month.setMonth(this.loaded_month.getMonth()+1))},this_month(){let e=new Date((new Date).setDate(1));this.day_matches(this.loaded_month,e)&&(this.is_changed=!this.is_changed),this.loaded_month=e},prev_month(){this.is_changed=!0,this.loaded_month=new Date(this.loaded_month.setMonth(this.loaded_month.getMonth()-1))},run_get_tasks(){this.tasks=this.$store.tasks,this.is_ready=!0},get_link(e){let[s,t,a]=e.split("/");return s=s.split("@")[0],[s,t,a].join("~")}},computed:{tasks_loaded_month(){return this.tasks.some((e=>{(0,bt.kX)(e.date);return!0}))},days(){const e=[],s=(0,bt.kX)((new Date).toISOString().split("T")[0]),t=this.loaded_month.getTime();function a(){return new Date(t)}const l=new Date(a().setDate(1)),i=new Date(a().setMonth(a().getMonth()+1,0));for(let r=l.getDay();r>0;r--){const t=new Date(a().setDate(1-r));e.push({date:t,tasks:this.get_day_tasks(t),is_placeholder:!0,is_past:t.getTime()<s.getTime()})}for(let r=1;r<=i.getDate();r++){const t=new Date(a().setDate(r));e.push({date:t,tasks:this.get_day_tasks(t),is_today:this.day_matches(t,new Date),is_past:t.getTime()<s.getTime()})}for(let r=1;e.length<42;r++){const t=new Date(a().setDate(i.getDate()+r));e.push({date:t,tasks:this.get_day_tasks(t),is_placeholder:!0,is_past:t.getTime()<s.getTime()})}return e}},watch:{dragging_class(e,s){e?.ref!=s?.ref&&(this.drag={}),this.drag.class=this.dragging_class},"$store.classes":{handler(e,s){e.length!=s.length&&this.is_ready&&(this.$status.log("📦 Classes array length changed, calendar updating tasks"),this.$store.fetch_classes().then((()=>{this.run_get_tasks()})).catch((e=>{this.$status.error("🔥 Couldn't fetch classes",e)})))},deep:!0},"$store.tasks":{handler(){this.tasks=this.$store.tasks},deep:!0}}};const Lt=(0,z.A)(wt,[["render",Ct],["__scopeId","data-v-03a15d4f"]]);var At=Lt;const Dt=e=>((0,a.Qi)("data-v-09880625"),e=e(),(0,a.jt)(),e),Et=["disabled"],Xt=Dt((()=>(0,a.Lk)("span",null," Clear",-1))),Tt=[Xt],qt=["title","href","draggable","onDragstart","onDragend","onClick"],St={key:0,class:"class_name"},xt={key:1,class:"class_character"},Bt={key:0,class:"class_character__period"},jt={key:1,class:"class_character__letter"},It=["_email","title","onClick"],Mt={key:0,class:"class_swatch__icon class_swatch_remove__icon"},Ft={key:1,class:"class_swatch__icon class_swatch_edit__icon"},Qt=Dt((()=>(0,a.Lk)("span",null," Create",-1))),Rt=[Qt];function Pt(e,s,t,i,r,o){return(0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["class_bar",{filtering:!!t.filtered_classes.length}])},[r.dragging?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,class:"class_filter_clear class_bar_item class_bar_item__button",onClick:s[0]||(s[0]=s=>e.$emit("clear_filters")),disabled:!t.filtered_classes.length,title:"Clear class section filters"},Tt,8,Et)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.classes,(s=>((0,a.uX)(),(0,a.CE)("a",{class:(0,l.C4)(["class_bar_class class_bar_item",{filter_active:t.filtered_classes.includes(s.id),classes_container_class__dragging:r.dragging&&r.dragging.ref==s.ref}]),title:e.$store.class_text(s),ref_for:!0,ref:s.ref,href:"/view/"+o.clean_ref(s.ref),draggable:e.$store.is_teacher&&s.email==e.$store.user.email&&"study"!=e.$route.name,onDragstart:a=>{e.$emit("dragclass",s),e.$emit("set_filtered_classes",[s.id]),r.dragging=s,r.prev_dragging=t.filtered_classes},onDragend:t=>{r.dragging=null,e.$emit("dragclass",{...s,_done:!0}),e.$emit("set_filtered_classes",r.prev_dragging)},key:s.name,onClick:t=>{e.$emit("toggle_filtered_class",s.id),t.preventDefault()},style:(0,l.Tr)({"--color-class":s.color,"--color-class-alt":s.color+"40"})},[r.dragging&&r.dragging.ref==s.ref?((0,a.uX)(),(0,a.CE)("div",St,(0,l.v_)(e.$store.class_text(s)),1)):((0,a.uX)(),(0,a.CE)("div",xt,[s.period?((0,a.uX)(),(0,a.CE)("span",Bt,(0,l.v_)(s.period),1)):((0,a.uX)(),(0,a.CE)("span",jt,(0,l.v_)(s.name[0]),1))])),(0,a.Lk)("div",{class:"class_swatch",_email:s.email,title:e.$store.is_teacher&&s.email==e.$store.user.email?"Edit Class":"Leave Class",onClick:t=>{e.$store.is_teacher&&s.email==e.$store.user.email?o.edit_class(s):o.leave_class(s),t.preventDefault(),t.stopPropagation()}},[e.$store.is_teacher&&s.email==e.$store.user.email?((0,a.uX)(),(0,a.CE)("div",Ft)):((0,a.uX)(),(0,a.CE)("div",Mt))],8,It)],46,qt)))),128)),(0,a.Lk)("div",{class:"classes_container_class classes_container_class__add_class class_bar_item class_bar_item__button",onClick:s[1]||(s[1]=s=>e.$router.push({name:"addclass",query:e.$route.query}))},[(0,a.Lk)("span",null,(0,l.v_)(e.$store.is_teacher?"Join":"Join a Class"),1)]),e.$store.is_teacher?((0,a.uX)(),(0,a.CE)("div",{key:1,class:"classes_container_class classes_container_class__create_class class_bar_item class_bar_item__button",onClick:s[2]||(s[2]=s=>e.$router.push({name:"createclass",query:e.$route.query}))},Rt)):(0,a.Q3)("",!0)],2)}var Wt={props:{filtered_classes:{type:Array,default:()=>[]}},name:"ClassList",data(){return{dragging:null,prev_dragging:[]}},computed:{classes(){return this.$store.classes.map((e=>({...e,email:e.id.split("/")[0]})))}},emits:["toggle_filtered_class","clear_filters","dragclass","set_filtered_classes"],methods:{clean_ref(e){let[s,t]=e.split("/");return s=s.split("@")[0],[s,t].join("~")},leave_class(e){this.$router.push({name:"leave",params:{ref:this.clean_ref(e.id)},query:this.$route.query})},edit_class(e){this.$router.push({name:"editclass",params:{ref:this.clean_ref(e.id)},query:this.$route.query})}}};const Nt=(0,z.A)(Wt,[["render",Pt],["__scopeId","data-v-09880625"]]);var Ut=Nt,Ot=t(4411),Kt={name:"AppPortal",components:{LeftBar:De,RightBar:os,ClassBar:Ut,StudyBlock:Js,CalendarBlock:At,OverlayWrapper:Ot.A},data(){return{filtered_classes:[],welcomes:["Welcome","Hi","Hello","Hey","Howdy"],loaded:!1,dragging_class:null,is_study:["study","studysession"].includes(this.$route.name),page:"block"}},computed:{fullpage(){return JSON.parse(this.$route.query.calendar||"false")},width(){return window.innerWidth},close_path(){return this.$route?.query?.redirect||this.$route?.meta?.close_path},name(){return this.$store.user?.displayName?.split(" ")[0]||"User"},did_survey(){return this.$store.done_daily_survey},random_welcome(){return this.welcomes[Math.floor(Math.random()*this.welcomes.length)]}},methods:{drag_class(e){this.dragging_class=e},do_survey(){this.$router.replace({name:"daily",query:{...this.$route.query,redirect:this.$route.fullPath}}),new $e.MY(`Please complete the daily survey to use ${this.$env.VUE_APP_BRAND_NAME_SHORT} today!`,3e3)},close_left_bar(){this.$refs.LeftBar?.close_sidebar()},close_right_bar(){this.$refs.RightBar?.close_sidebar()},show_task(e){this.$router.push({name:"viewtask",params:{ref:this.$store.path_to_ref(e.ref)},query:this.$route.query})},toggle_filtered_class(e){this.filtered_classes.includes(e)?this.filtered_classes=this.filtered_classes.filter((s=>s!==e)):this.filtered_classes.push(e)},check_and_do_survey(){this.$store?.user&&!this?.did_survey&&!0!==this.$route?.meta?.noSurvey&&this.do_survey()},check_and_do_join(){this.$store.done_join_form||(this.$router.push({name:"join",query:{...this.$route.query,redirect:this.$route.fullPath}}),new $e.MY(`Please fill out the join form to use ${this.$env.VUE_APP_BRAND_NAME_SHORT}!`,3e3))}},mounted(){this.$status.log("🏗 Portal mounted"),this.check_and_do_join(),this.check_and_do_survey(),this.$store.fetch_classes().then((()=>{this.$refs.study&&this.$refs.study.run_get_tasks(),this.$refs.calendar&&this.$refs.calendar.run_get_tasks(),this.$refs.RightBar.load(),this.$refs.LeftBar.load(),this.loaded=!0})).catch((e=>{this.$status.error("🔥 Couldn't fetch classes",e)}))},watch:{width(e,s){s<=600&&e>600&&(this.page="block")},did_survey(){this.check_and_do_survey()},$time(){this.check_and_do_survey()},$route(){this.is_study||"study"!=this.$route.name?"portal"==this.$route.name&&(this.is_study=!1):this.is_study=!0,"portal"!=this.$route.name&&(this.close_right_bar(),this.close_left_bar()),this.check_and_do_survey()},$store:{handler(){this.check_and_do_join()},deep:!0}}};const zt=(0,z.A)(Kt,[["render",T],["__scopeId","data-v-1b996766"]]);var Ht=zt},334:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJxSURBVHgB7ZmBcdsgFIb/9jqAR6ATNJ3AjJAN7A3iDdwNlE5ANvAIciewN6AbxBskvDOcCUHwQEjJXfTd/WeMEPpBD4QQsLDwtfmGdkijX/b3zmhlRVyM/ludjf4ZHfEJIIN/jJ6NXgqljZSRwAdAxh9RbnpIszZkh7oe59yRDSamZa8PqcMEUMj0wOTmnU64TQBNOAGzmXfq0Yg5wmaycNoCePlg7VCJwHVmaGVkb7T26qeHnWKcRzNe1XjgVM6RtmaHEMh3VHEoCYw37swL5vVyz5aiu6CAScw/ekZVYGqPfAiy0Whv/iljSiI/FljIAqNjzIemVoy6ZWj2B96zxjjcU9tBS+mhQXwJzstBy/Wjn/E9Uig1Y6QgMzRn//T02+gvru8BMZ68tEAeyShTtWyIhQ0Cc2G9+6CMYl4nS+lSOWae/od3cpswf8+8FmsgjzFP6d4e660oj+L7MGD+DmWd1qwBMfPaHnvw8jubr4P8GvOsBnAqTJknbZCnxjwrhDSjoi5hPtbAkHvUvZaewODAqMgfoCpRjo5J2xhhjfcVxp0OodnYg+xoL5Ti7KW3iXISb/eHXF4tZ04hiXxP+IaGQkEjPU5qtAaTXHxKr+xuJvMaBewzlalIeW0bTmn/DlG6xaaAQgFVK8OBelrtaAgU0mUqpN7eJM4XDc0rVLACb66myqUtL2y6Q53RodgXqGTX0EitNhhJy94sVbN90h7A3OZZywYuLWcTjno03tx1zBFOk2yv+2zRdsvRiWa8B8yEQLutR9frk4RMDoFrQ2ruSGzZUUzLz6xr3D6xCtzehYmLFS2Hj7h9al1YWBjJKxvgzZRLiW94AAAAAElFTkSuQmCC"}}]);
//# sourceMappingURL=167.d7dd3592.js.map