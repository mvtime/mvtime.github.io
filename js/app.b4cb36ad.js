(function(){var e={6265:function(e,t,o){"use strict";o.d(t,{Cw:function(){return d},Fi:function(){return u},kX:function(){return h},nv:function(){return _}});o(4114),o(4603),o(7566),o(8721);let a=[],s=new Date;function r(e,t="log.txt"){let o=window.document.createElement("a");o.href=window.URL.createObjectURL(new Blob([e],{type:"text/plain"})),o.download=t,o.click()}function i(e){return e.length?e.map((e=>`${e.time} [${e.type}]: ${JSON.stringify(e.message)}`)).join("\n\n"):`No log entries found; last cleared ${s.toISOString()}`}function n(e){try{const t=e.match(/^([\P{L}\p{Extended_Pictographic}]|(?:[\uD800-\uDBFF][\uDC00-\uDFFF]))/u);return t?t[0]:null}catch(t){return null}}function l(){if(a.push({time:Date.now()||"log",message:arguments[0],type:this}),0==arguments.length)return;let e=Array.from(arguments),t=["%cMVTT","background:#272727;color:#C9B092;padding:7px 12px;font-family:Lato,sans-serif;font-weight:bold;font-size:1.3em"];null!=n(e[0])&&(t[0]+=" %c"+n(e[0]),t[2]="background:#C9B092aa;background:#ffffffaa;color:#272727;padding:3px 5px;margin-left:5px;border-radius:5px;font-family:monospace !important;font-weight:bold;font-size:1.25em",e[0]=e[0].substring(2).trimStart());try{console[this](...t,...e)}catch(o){console.log("‚ö† Couldn't override console.log",o),console.log(...t,...e)}}let c="info";const d={print:l.bind(c),log:l.bind("log"),info:l.bind("info"),debug:l.bind("debug"),warn:l.bind("warn"),error:l.bind("error"),clearStream:()=>{a=[],console.clear(),s=new Date},getStream:(e=[])=>e&&e.length>0?a.filter((t=>e.includes(t.type))):a,textStream(){return i(d.getStream(...arguments))},saveStream:(e="manual")=>{let t=new Date,o=d.getStream(...arguments);t.setSeconds(0,0),u(o,t,e)},_getTone:()=>c,_setTone:e=>{c=e},_resetTone:()=>{c="info"}};function u(e,t,o="manual"){try{r(i(e),`MVTT-log ${o} ${t.toISOString().split(":00.0")[0].replace("T"," ").replace(":","h")}m.log`),d.log("üìú Saved log stream to disk; run `_status.clearStream()` to purge if local")}catch(a){d.error("üìú Couldn't save log stream",a)}}l.bind("info");try{window._status=d,d.log("üìú Initialized logger")}catch(m){d.log("‚ö† Couldn't set window._status",m)}function h(e){return"string"!=typeof e?e:new Date(e.replace(/-/g,"/"))}function _(e){let t=Math.floor(e/1e3%60),o=Math.floor(e/6e4%60),a=Math.floor(e/36e5%24),s=a>0?a+":"+(o<10?"0":""):"";return s+=`${o}:${t<10?"0":""}${t}`,s}},5537:function(e,t,o){"use strict";o.d(t,{Cn:function(){return p},Qg:function(){return n.Qg},RJ:function(){return C},db:function(){return m},j2:function(){return _},l4:function(){return w}});var a=o(6400),s=o(114),r=o(7617),i=o(5942),n=o(9218),l=o(5129),c=o(6265),d=o(6496);const u={apiKey:"AIzaSyDGqqhApln4pxm4EynPCSkfwyK8aopjfCk",authDomain:"auth.mvtt.app",projectId:"mvtrack",storageBucket:"mvtrack.appspot.com",messagingSenderId:"1070634963357",appId:"1:1070634963357:web:2a4abc725fff24a5199f74",measurementId:"G-6LNX1KCR8E"},h=(0,a.Wp)(u),_=(0,s.xI)(h),m=(0,r.aU)(h),p=((0,i.P5)(h),(0,n.Uz)(h,{VUE_APP_BRAND_DOMAIN__VIEWCLASS:"view.mvtt.app",VUE_APP_THEME_ACCENT_COLOR_ALT:"4c4c4c",VUE_APP_BRAND_DOMAIN__ADDCLASS:"add.mvtt.app",VUE_APP_BRAND_DOMAIN__VIEWTASK:"view.mvtt.app",VUE_APP_ORG_NAME:"MVLA",VUE_APP_BRAND_NAME_SHORT:"MVTT",VUE_APP_ORG_LINKS:'[["Docs", "https://mvtt.app/docs"], ["Cal", "https://mvhs.mvla.net/Calendar/"]]',VUE_APP_THEME_COLOR:"f5c14b",VUE_APP_BRAND_MAIL_ADDRESS:"mail@mvtt.app",VUE_APP_BRAND_DOMAIN:"mvtt.app",VUE_APP_BRAND_HOMEPAGE:"http://mvtt.app",VUE_APP_ORG_GRADES:'[[9, "Freshman"], [10, "Sophomore"], [11, "Junior"], [12, "Senior"]]',VUE_APP_THEME_CONSOLE_COLOR_TEXT:"C9B092",VUE_APP_SIDEBAR_DOWNLOAD_URL:"/download/mvtt-sidebar.zip",VUE_APP_BRAND_URL:"https://mvtt.app",VUE_APP_BRAND_DOMAIN__API:"api.mvtt.app",VUE_APP_THEME_CONSOLE_COLOR_BG:"272727",VUE_APP_ORG_TEACHER_GRADE:"Teacher / Educator",VUE_APP_BRAND_NAME_LONG:"MV Task Tracker",VUE_APP_ORG_DOMAIN:"mvla.net",VUE_APP_BRAND_ALLOWED_HOSTS:"mvla.net,*.mvla.net",VUE_APP_THEME_ACCENT_COLOR:"000000",NODE_ENV:"production",BASE_URL:"/"}.FIREBASE_region));let f;_.onAuthStateChanged((e=>{w(e)}));let g,k=!1;function w(e){const t=(0,l.s)();if(e){if(t.set_user(e),y(),!t.user)return;v(e.uid),g=A()}else t.clear()}function v(e){if(c.Cw.log("‚¨• Setting up snapshot"),!e)return void c.Cw.warn("‚ö† No uid provided to setupSnapshot");const t=(0,l.s)();t.hide_timeout(),f=(0,r.aQ)((0,r.H9)(m,"users",e),{includeMetadataChanges:!0},(e=>{if(e.metadata.hasPendingWrites)return void c.Cw.log("‚¨• Snapshot from local changes");if(c.Cw.log("‚è∑ Snapshot from remote"),!e.exists())return void t.create_doc();let o=e.data();t?.user?.uid==e.id?t.account_doc=o:t.linked_account_doc=o}),(e=>{"permission-denied"==e.code?c.Cw.warn("‚ö† Permission denied for snapshot, likely from logging out"):c.Cw.error("‚ö† Couldn't get snapshot from remote",e)})),k=!0}function y(e){clearTimeout(g);let t=(0,l.s)();e&&t.show_timeout(),f&&(f(),c.Cw.log("‚¨• Unsubscribed from remote changes")),k=!1}function b(e){const t=Math.floor(e/1e3/60),o=Math.floor(e/1e3%60);return(t||!o?`${t} minute${1!=t?"s":""}`:"")+(o?`${o} second${1!=o?"s":""}`:"")}function A(e=3e5){return setTimeout((()=>{c.Cw.log(`‚¨• Page unused for ${b(e)}, removing onSnapshot listener`),y(!0)}),e)}function C(e){const t=(0,l.s)();t.hide_timeout(),k||(v(t.personal_account?t.account_doc?.linked_to:t.user.uid),d.A.currentRoute.value&&d.A.currentRoute.value.path.startsWith("/portal")&&(c.Cw.log("‚¨• Refreshing class data"),t.fetch_classes()),c.Cw.log("‚¨• Resubscribed to remote changes")),clearTimeout(g),g=A(e)}},8988:function(e,t,o){"use strict";o(4114);var a=o(5130),s=o(6768),r=o(3367),i=o(4232);const n=e=>((0,s.Qi)("data-v-72179f70"),e=e(),(0,s.jt)(),e),l=["_theme"],c={class:"pause_modal router_center_view",ref:"pause_modal"},d=n((()=>(0,s.Lk)("header",{class:"modal_header"},[(0,s.Lk)("h2",{class:"header_style modal_header_title"},"Session paused")],-1))),u={ref:"pause_contents",class:"overlay_contents"},h=n((()=>(0,s.Lk)("div",{class:"overlay_contents_text"}," Your session was inactive for an extended period of time and has been paused to conserve resources. ",-1))),_=n((()=>(0,s.Lk)("br",null,null,-1))),m=n((()=>(0,s.Lk)("div",{class:"overlay_contents_text"}," You can hide this message using the toggle in your account preferences. ",-1))),p=n((()=>(0,s.Lk)("br",null,null,-1))),f={class:"overlay_contents_text"};function g(e,t,o,a,r,n){const g=(0,s.g2)("OverlayWrapper"),k=(0,s.g2)("LogoutModal"),w=(0,s.g2)("ShortcutsModal"),v=(0,s.g2)("TutorialBlurb"),y=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("main",{id:"themed_body",class:(0,i.C4)(["parent",{simplified:e.$store.simplified}]),ref:"app",_theme:n.theme,onClick:t[5]||(t[5]=(...e)=>n.refreshTimeout&&n.refreshTimeout(...e)),onKeydown:t[6]||(t[6]=(...e)=>n.refreshTimeout&&n.refreshTimeout(...e)),onFocus:t[7]||(t[7]=(...e)=>n.refreshTimeout&&n.refreshTimeout(...e))},[n.do_timeout&&(e.$store.paused||r.animating)?((0,s.uX)(),(0,s.Wv)(g,{key:0,ref:"overlay",class:"pause_modal_overlay",style:{"z-index":"104"}},{default:(0,s.k6)((()=>[(0,s.Lk)("main",c,[d,(0,s.Lk)("div",u,[h,_,m,p,(0,s.Lk)("div",f," Please click anywhere to resume using "+(0,i.v_)(e.$env.VUE_APP_BRAND_NAME_SHORT)+". ",1)],512)],512)])),_:1},512)):(0,s.Q3)("",!0),e.$store.logout_prompt?((0,s.uX)(),(0,s.Wv)(g,{key:1,ref:"logout_modal",onClose:t[0]||(t[0]=t=>e.$store.logout_prompt=!1),style:{"z-index":"103"}},{default:(0,s.k6)((e=>[(0,s.bF)(k,{class:"router_center_view",onClose:e.close},null,8,["onClose"])])),_:1},512)):(0,s.Q3)("",!0),r.show_shortcuts||r.animating_shortcuts?((0,s.uX)(),(0,s.Wv)(g,{key:2,ref:"shortcuts_overlay",onClose:t[1]||(t[1]=e=>r.show_shortcuts=!1),style:{"z-index":"102"}},{default:(0,s.k6)((e=>[(0,s.bF)(w,{class:"router_center_view",ref:"shortcuts_modal",onClose:e.close},null,8,["onClose"])])),_:1},512)):(0,s.Q3)("",!0),n.show_tutorial&&e.$route.fullPath.startsWith("/portal")?((0,s.uX)(),(0,s.Wv)(v,{title:n.tutorial.title,key:"tutorial",options:n.tutorial.options,html:n.tutorial.html||"<i style=text-align:center;width:100%;display:block>Not much to see here!</i>",button_text:n.tutorial.next_text,skip_text:n.tutorial.prev_text,trackel:n.tutorial.el,onNext:t[2]||(t[2]=e=>n.tutorial_nav(1)),onSkip:t[3]||(t[3]=e=>n.tutorial_nav(-1)),onVnodeUnmounted:t[4]||(t[4]=e=>r.tutorial_page=0),style:{"z-index":"101"}},null,8,["title","options","html","button_text","skip_text","trackel"])):(0,s.Q3)("",!0),(0,s.bF)(y)],42,l)}o(4603),o(7566),o(8721);var k=o(9685);function w(e,t,o,a,r,i){const n=(0,s.g2)("Modal");return(0,s.uX)(),(0,s.Wv)(n,{class:"logout_modal",can_continue:!0,title:"Log Out",html:r.html,continue_action:i.logout,skippable:!0,onSkip:t[0]||(t[0]=t=>e.$emit("close")),skip_text:"Cancel",submit_text:"Confirm"},null,8,["html","continue_action"])}var v=o(7251),y={name:"LogoutModal",emits:["close"],components:{Modal:v.A},data(){return{html:'<div class="overlay_contents_text">Are you sure you want to log out?<br><br>You may lose access to what you were working on, and unsaved changes may be discarded.</div>'}},methods:{logout(){this.$store.logout(),this.$emit("close")}},mounted(){setTimeout((()=>{this.$emit("close")}),1e4)}},b=o(1241);const A=(0,b.A)(y,[["render",w]]);var C=A;const P={class:"overlay_contents shortcuts_contents"},E={key:0},T={key:1,class:"shortcuts_sections"},x={class:"shortcuts_section__title"},S={class:"shortcuts_table"},N={class:"shortcut__key"},O={class:"shortcut__description"},L={key:0,class:"shortcuts_section__filler"};function $(e,t,o,a,r,n){return(0,s.uX)(),(0,s.CE)("div",{class:(0,i.C4)(["shortcuts_modal",{empty:!n.sections.length}]),ref:"shortcuts_modal"},[(0,s.Lk)("div",P,[n.sections&&n.sections.length?((0,s.uX)(),(0,s.CE)("div",T,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.sections,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"shortcuts_section",key:e.tag},[(0,s.Lk)("p",x,(0,i.v_)(e.tag||"Other"),1),(0,s.Lk)("table",S,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.list,(e=>((0,s.uX)(),(0,s.CE)("tr",{class:"shortcuts_table_shortcut",key:e.name,tabindex:"1"},[(0,s.Lk)("td",N,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.keys,(e=>((0,s.uX)(),(0,s.CE)("span",{class:"button_pointer_text",key:e},(0,i.v_)(e),1)))),128))]),(0,s.Lk)("td",O,(0,i.v_)(e.description),1)])))),128))])])))),128)),n.sections.length&&n.sections.length%2?((0,s.uX)(),(0,s.CE)("div",L)):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",E,"No Registered Shortcuts"))]),(0,s.Lk)("div",{class:"click_escape nopad",onClick:t[0]||(t[0]=t=>e.$emit("close"))})],2)}var R={name:"ShortcutsModal",computed:{sections(){return this.$shortcuts.sections}},mounted(){this.$refs.shortcuts_modal.focus()},beforeUnmount(){}};const M=(0,b.A)(R,[["render",$],["__scopeId","data-v-1ab3b320"]]);var D=M,V=o(6587),I=o.n(V),j=o(4186),U=JSON.parse('[{"el":".portal_info","title":"Let\'s get started!","html":"At the top of the portal, you\'ll find some common info, like the date, who you\'re signed in as, and what type of account you have. <br><br> You can click \'Next,\' or use space / enter / the arrow keys to continue.","options":{"reclick":".calendar, .study .action_icon.cal-icon, #portal_mobile__block","pagename":"portal"}},{"el":".calendar","title":"The Calendar","html":"The calendar shows you all of your upcoming tasks, which you can click to expand. <br><br> If you\'re a teacher, your calendar will include extra features, and will allow you to drag and drop classes to create new tasks.","options":{"radius":"25px","pagename":"portal"}},{"el":".calendar_header","title":"Calendar Controls","html":"The bar at the top of the calendar allows you to change the view, and navigate to different dates. <br><br> Let\'s take a look what it can do!","options":{"radius":"15px","pagename":"portal"}},{"el":".calendar .portal_main_block_actions","title":"Calendar Pages","html":"These buttons allow you to navigate between pages of the calendar. You\'ll be able to click the center one to return to today\'s date.","options":{"radius":"15px","pagename":"portal"}},{"el":".calendar .portal_main_block_action_alt","title":"Portal Pages","html":"This button lets you switch between the calendar and the task list. <br><br> You might see a yellow-hued dot here, indicating that you have unfinished tasks coming up soon!","options":{"radius":"15px","click_on_complete":true}},{"disable_prev":true,"el":".study","title":"Study Page","html":"On the study page, you can see a list of your upcoming tasks, mark them as complete, and add new tasks. <br><br> If you\'re a teacher, this page won\'t be as useful to you.","options":{"radius":"25px"}},{"el":".study_header","title":"Study Controls","html":"The bar at the top of the study page allows you to customize your study session. <br><br> Let\'s take a look what it can do!","options":{"radius":"15px","pagename":"study"}},{"el":".study .portal_main_block_actions","title":"Study Timeframes","html":"These buttons allow you to change the timeframe of the study page. By default, it\'ll be set to the \'Week\' view, but you can also select \'Day,\' \'Month,\' or \'All.\' <br><br> Hint: hover over the buttons to see their keyboard shortcuts!","options":{"radius":"15px","click_on_complete":".portal_main_block_actions_wrapper > nav > button:last-child","pagename":"study"}},{"el":".study .portal_main_block_action_alt","title":"Portal Pages","html":"This button lets you switch between the calendar and the task list. <br><br> You might see a yellow-hued dot here, indicating that you have unfinished tasks coming up soon!","options":{"radius":"15px","click_on_complete":".study .portal_main_block_action_alt, .right-bar","pagename":"study"}},{"disable_prev":true,"el":".right-bar","title":"Right Sidebar","html":"The right sidebar shows you some quick info about your upcoming tasks, as well as access to more materials and account switching. <br><br> On smaller screens, you can open the sidebar by hovering at the side of the display and clicking the protruding section, or on mobile tapping the arrows in the bottom nav bar.","options":{"radius":"25px 0 0 25px","padding":0,"reclick":".right-bar, #portal_mobile__right","pagename":"portal"}},{"el":".right-bar .auth-action.can-logout","title":"Logout Button","html":"Click here to logout of your account. <br><br> If you\'re having issues with your portal, logging in and out can sometimes help.","options":{"reclick":".right-bar, #portal_mobile__right","pagename":"portal"}},{"el":".right-bar .upcoming_tasks","title":"Upcoming Tasks","html":"This section shows you your upcoming tasks, which you can click to expand. <br><br> It\'ll only show up to 6 tasks, sorted by soonest due date.","options":{"reclick":".right-bar, #portal_mobile__right","pagename":"portal"}},{"el":".right-bar .settings_button","title":"Account Preferences","html":"You can click here to change your account preferences, like toggling teacher mode, adding linked accounts, disabling the session timeout, switching themes, and viewing your survey statistics! <br><br> Next, let\'s take a look at the other sidebar","options":{"reclick":".right-bar, #portal_mobile__right","click_on_complete":".left-bar, #portal_mobile__left","radius":"17px","padding":5,"pagename":"portal"}},{"disable_prev":true,"el":".left-bar","title":"Left Sidebar","html":"The left sidebar gives you access to your tasks, classes, and other materials. <br><br> If you\'re a teacher, you\'ll find your controls to create classes and tasks here.","options":{"radius":"0 25px 25px 0","padding":0,"pagename":"portal","reclick":".left-bar, #portal_mobile__left"}},{"el":".left-bar .branding-title","title":"Well, we *are* MVTT","html":"Clicking the MVTT logo will take you back to the portal home page","options":{"reclick":".left-bar, #portal_mobile__left","pagename":"portal"}},{"el":".left-bar .class_list","title":"Class List","html":"Once you\'ve joined some classes, you\'ll see them listed here. <br><br> Clicking on a class will filter your calendar and study pages to only show tasks from filtered (clicked) classes.","options":{"reclick":".left-bar, #portal_mobile__left","pagename":"portal"}},{"el":".left-bar .class_list .classes_container_class__add_class","title":"Adding Classes","html":"Click here to add a class to your account. <br><br> You can join with a class code provided by your teacher, or by entering their email and selecting from a dropdown of all their classes.","options":{"reclick":".left-bar, #portal_mobile__left","padding":5,"radius":"10px","pagename":"portal"}},{"el":".left-bar .theme_button","title":"Theme Toggle","html":"It doesn\'t all have to be work! <br><br> Click here to switch between the light and dark modes. This\'ll sync across your devices!","options":{"reclick":".left-bar, #portal_mobile__left","radius":"17px","padding":5,"pagename":"portal","click_on_complete":"#portal_mobile__block"}},{"el":null,"title":"That\'s all for now!","html":"Thanks for taking the tour! <br><br> If you have any questions, feel free to reach out to us by visiting the contact page (try using the title in the left sidebar to get to it from the homepage)! <br><br> In the meantime though, let\'s get you some more resources, then add your first class!","options":{"next_text":"Finish","reclick":"null-filler","click_on_complete":".left-bar .class_list .classes_container_class__add_class"}},{"el":null,"title":"That\'s all for now!","html":"Thanks for taking the tour! <br><br> If you have any questions, feel free to reach out to us by visiting the contact page (try using the title in the left sidebar to get to it from the homepage)! <br><br> In the meantime though, let\'s get you some more resources, then add your first class!","options":{"next_text":"Finish","end":true,"pagename":"tutorial","reclick":"null-filler"}}]');const q={class:"tutorialblurb modaltype",ref:"blurb"},B={key:0,class:"modal_header",ref:"title"},H={class:"header_style modal_header_title"},G={key:1,ref:"contents",class:"overlay_contents"},Q=["innerHTML"],W={class:"bottom_actions"},X=(0,s.Lk)("div",{class:"flex_spacer"},null,-1);function F(e,t,o,a,r,n){return!o.trackel||r.track?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,i.C4)(["tutorialblurb_group",{tutorial_end:n.is_end}])},[(0,s.Lk)("div",{class:"tutorialblurb__overlay",style:(0,i.Tr)({top:r.track.top+"px",left:r.track.left+"px",height:r.track.height+"px",width:r.track.width+"px",borderRadius:o.options&&o.options.radius||"5px"})},null,4),(0,s.Lk)("div",{class:"tutorialblurb_wrapper",ref:"dialog",style:(0,i.Tr)({top:r.track.fake_y+"px",left:r.track.fake_x+"px"})},[r.track.blurb?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"tutorialblurb__blurb nopad",style:(0,i.Tr)({left:r.track.blurb_x+"px"})},null,4)):(0,s.Q3)("",!0),(0,s.Lk)("div",q,[o.title?((0,s.uX)(),(0,s.CE)("header",B,[(0,s.Lk)("h2",H,(0,i.v_)(o.title),1)],512)):(0,s.Q3)("",!0),o.content||o.html?((0,s.uX)(),(0,s.CE)("div",G,[((0,s.uX)(),(0,s.Wv)((0,s.$y)(o.content),{ref:"container",onSkip:t[0]||(t[0]=t=>e.$emit("skip"))},null,544)),o.html?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"overlay_contents__html",innerHTML:o.html},null,8,Q)):(0,s.Q3)("",!0)],512)):(0,s.Q3)("",!0),(0,s.Lk)("div",W,[o.skippable?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"close_action click_escape",onClick:t[1]||(t[1]=t=>e.$emit("skip"))},(0,i.v_)(o.skip_text),1)):(0,s.Q3)("",!0),X,(0,s.Lk)("button",{class:"continue_action click_ctrlenter",onClick:t[2]||(t[2]=t=>e.$emit("next"))},(0,i.v_)(o.button_text),1)])],512)],4)],2)):(0,s.Q3)("",!0)}var K=o(6471),Y=o.n(K),z={name:"TutorialBlurb",emits:["next","skip"],props:{title:{type:String,required:!0},content:{type:Object},html:{type:String},button_text:{type:String,required:!1,default:"Next"},trackel:{required:!0},skippable:{type:Boolean,required:!1,default:!0},skip_text:{type:String,required:!1,default:"Skip"},options:{type:Object,required:!1}},data(){return{track:null,done_welcome:!1,shortcuts:[{key:"Enter, Space, ArrowRight",description:"Next Page"},{key:"ArrowLeft",description:"Back"}]}},mixins:[Y()],mounted(){this.$smoothReflow({el:this.$refs.contents,hideOverflow:!0,childTransitions:!0}),this.$smoothReflow({el:this.$refs.title,hideOverflow:!0,childTransitions:!0}),window.addEventListener("keydown",this.next_key),this.$shortcuts.register_all(this.shortcuts,"Tutorial"),window.addEventListener("resize",this.track_flush),window.addEventListener("scroll",this.track_flush),window.setInterval(this.track_flush,100),this.track_flush()},beforeUnmount(){window.removeEventListener("keydown",this.next_key),this.$shortcuts.remove_tag("Tutorial"),window.removeEventListener("resize",this.track_flush),window.removeEventListener("scroll",this.track_flush),window.clearInterval(this.track_flush)},computed:{is_end(){return this.options?.end}},methods:{track_fn(){const e=void 0===this.options?.padding?10:this.options.padding;if(this.trackel){const t=I()(this.trackel);if(t.length){const o={w:window.innerWidth,h:window.innerHeight,pad:10},a={w:350,h:(this.$refs?.dialog?.offsetHeight||200)+7,offset:o.w<=600?172:20,rail_pad:20},s=t.offset(),r=t.outerWidth(),i=t.outerHeight();let n={blurb:!0,top:s.top-e,left:s.left-e,width:r+2*e,height:i+2*e,x:s.left+r/2-a.offset,y:s.top+i+e+7,exists:!0};return n.fake_x=Math.max(o.pad,Math.min(o.w-a.w-o.pad,n.x)),n.fake_y=Math.max(o.pad,Math.min(o.h-a.h-o.pad,n.y)),n.fake_x+a.w>n.left&&n.fake_x<n.left+n.width&&n.fake_y+a.h>n.top&&n.fake_y<n.top+n.height?(n.blurb=!1,n.blurb_x=a.offset,n.fake_y=window.innerHeight/2-(this.$refs?.dialog?.offsetHeight||200)/2,n.fake_x=window.innerWidth/2-175):(n.blurb_x=n.x-n.fake_x+a.offset,n.blurb_x=Math.max(a.rail_pad,Math.min(a.w-a.rail_pad,n.blurb_x))),this.done_welcome||(new j.rQ(`Welcome to ${this.$env.VUE_APP_BRAND_NAME_SHORT}, let's get you comfortable!`,3500),this.done_welcome=!0),n}}else if(null==this.trackel)return{exists:!1,blurb:!1,fake_y:window.innerHeight/2-(this.$refs?.dialog?.offsetHeight||200)/2,fake_x:window.innerWidth/2-175,top:window.innerHeight/2,left:window.innerWidth/2,width:0,height:0};return this.track},next_key(e){e.preventDefault(),this.track&&("Enter"===e.key||" "===e.key||"ArrowRight"===e.key?this.$emit("next"):"ArrowLeft"===e.key&&this.$emit("skip")),e.stopPropagation()},track_flush(){this.$store.done_tutorial||(this.track=this.track_fn(),this.options?.reclick&&I()(this.options.reclick).click(),this.options?.pagename&&this.$route.name!=this.options.pagename&&this.$route.path.startsWith("/portal")&&this.$router.push({name:this.options.pagename}))}},watch:{trackel(){this.track_flush()},$route(){this.track_flush()},options(){this.options?.end&&setTimeout((()=>{this.$emit("next")}),250)}}};const J=(0,b.A)(z,[["render",F]]);var Z=J,ee={name:"App",components:{OverlayWrapper:k.A,LogoutModal:C,TutorialBlurb:Z,ShortcutsModal:D},data(){return{platform:"",isElectron:!1,animating:!1,animating_shortcuts:!1,tutorial_page:0,show_shortcuts:!1,shortcuts:[{key:"Ctrl + Enter",description:"Submit current form",top:!0},{key:"Escape",description:"Close current modal",top:!0},{key:"Ctrl + \\",description:"Switch light/dark theme",top:!0},{key:"Ctrl + !, Ctrl + 1",description:"Report logs (check console)"},{key:"Ctrl + '",description:"Toggle simplified view",top:!0},{key:"Ctrl + / or Ctrl + ?",description:"Toggle shortcuts menu",top:!0}]}},computed:{do_timeout(){return!this.$store?.account_doc?.prefs?.hide_timeout},pageTitle(){return document.title},theme(){return this.$store.get_theme},show_tutorial(){return!this.$store.done_tutorial&&U&&this.$store},tutorial(){const e=U[this.tutorial_page];return{...e,prev_text:this.tutorial_page&&!e.disable_prev?"Back":"",next_text:e.options?.next_text||(this.tutorial_page==U.length-1?"Finish":"Next")}}},mounted(){this.isElectron=navigator.userAgent.toLowerCase().indexOf(" electron/")>-1,this.isElectron&&(this.platform=this.$route.query.platform,!this.platform&&window.location.search&&(this.platform=window.location.search.split("=")[1]),this.$status.log("Electron Platform: "+this.platform)),this.set_theme(),this.$store.paused=!1,this.$store.logout_prompt=!1,window.addEventListener("focus",this.refreshTimeout),window.addEventListener("keydown",this.global_keydown),this.$shortcuts.register_all(this.shortcuts,"General"),this.$refs.app.addEventListener("click",(e=>{if(e.target.href){e.target.href.includes("://")&&!e.target.href.startsWith("/")||(e.target.href=new URL(e.target.href,window.location.href).href);let t=new URL(e.target.href);if(t?.hostname==this.$env.VUE_APP_BRAND_DOMAIN||t?.hostname==window?.location?.hostname)return;e.preventDefault(),this.$status.log(`üîó Opening outlink in a new tab | "${t.href}"`),window.open("/to/"+encodeURIComponent(t.href),"_blank")}}))},beforeUnmount(){window.removeEventListener("focus",this.refreshTimeout),window.removeEventListener("keydown",this.global_keydown),this.$shortcuts.remove_tag("General")},created(){const e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",t=window.localStorage.getItem("theme");this.isDarkMode="dark"===t||null===t&&"dark"===e},methods:{global_keydown(e){let t,o=!1;if(this.show_shortcuts&&(o=!0),e.shiftKey||"Escape"!=e.key||e.ctrlKey||e.metaKey?e.shiftKey||"Enter"!=e.key||!e.ctrlKey&&!e.metaKey?e.shiftKey||"\\"!=e.key||!e.ctrlKey&&!e.metaKey?e.shiftKey||"'"!=e.key||!e.ctrlKey&&!e.metaKey?"/"==e.key&&(e.ctrlKey||e.metaKey)||"?"==e.key&&(e.ctrlKey||e.metaKey)?(this.show_shortcuts=!this.show_shortcuts,o=!0):"!"!=e.key&&"1"!=e.key||!e.ctrlKey&&!e.metaKey||(this.$store.report_logs(),o=!0):(this.$store.toggle_simplified(),o=!0):(this.$store.toggle_theme(),o=!0):t=I()(".click_ctrlenter"):t=I()(".click_escape"),t){if(t=t.not("[disabled]").not(".disabled").filter(":visible"),!t||!t.length)return;I()(t).first().click()}(t||o)&&(e.preventDefault(),e.stopPropagation())},tutorial_nav(e){const t=this.tutorial?.options?.click_on_complete;e>0&&t&&I()(1==t?this.tutorial.el:t).click(),this.tutorial_page==U.length-1?this.$store.finish_tutorial(!0).then((()=>{new j.rQ("Interface tutorial completed; here's some more resources!",3500)})).catch((e=>{new j.Qp("Couldn't complete tutorial",e,3e3)})):this.tutorial_page+e>=0&&(!this.tutorial.disable_prev||e>0)&&(this.tutorial_page+=e)},refreshTimeout(){this.$store&&this.$store.refresh_timeout()},set_theme(){"light"==this.theme?(I()("meta.theme-color").attr("media",""),I()("meta.theme-color-dark").attr("media","false")):(I()("meta.theme-color-dark").attr("media",""),I()("meta.theme-color").attr("media","false"))}},watch:{"$store.paused":function(e,t){this.do_timeout&&(e?this.$nextTick((()=>{this.$refs.pause_modal.focus()})):t&&this.$refs.overlay&&(this.animating=!0,this.$refs.overlay.close(),setTimeout((()=>{this.animating=!1}),250)))},show_shortcuts:function(e,t){t&&this.$refs.shortcuts_overlay&&(this.animating_shortcuts=!0,this.$refs.shortcuts_overlay.close(),setTimeout((()=>{this.animating_shortcuts=!1}),250))},theme(){this.set_theme()}}};const te=(0,b.A)(ee,[["render",g],["__scopeId","data-v-72179f70"]]);var oe=te,ae=o(6496),se=o(1758),re=o(6265),ie=o(4458);(0,ie.k)("/service-worker.js",{ready(){re.Cw.log("üõ† App is being served from cache by a service worker. For more details, visit https://goo.gl/AFskqB")},registered(){re.Cw.log("üõ† Service worker has been registered.")},cached(){re.Cw.log("üõ† Content has been cached for offline use.")},updatefound(){re.Cw.log("üõ† New content is downloading.")},updated(){re.Cw.log("üõ† New content is available; please refresh."),window.localStorage.clear(),window.location.reload(!0)},offline(){re.Cw.log("üõ† No internet connection found. App is running in offline mode.")},error(e){re.Cw.error("üõë Error during service worker registration:",e)}});var ne=o(5847),le=o(5129);o(3375),o(9225),o(3972),o(9209),o(5714),o(7561),o(6197);function ce(e){if(e)return e=e.replace(" or ",", "),e.split(", ").map((e=>(e=e.replace("Control","Ctrl"),-1!=navigator?.userAgent.indexOf("Mac OS X")&&(e=e.replace("Ctrl","‚åò"),e=e.replace("Meta","‚åò"),e=e.replace("Shift","‚áß"),e=e.replace("Alt","‚å•"),e=e.replace("Escape","esc"),e=e.replace("Home","fn + ‚Üê"),e=e.replace("End","fn + ‚Üí")),e=e.replace("ArrowUp","‚Üë"),e=e.replace("ArrowDown","‚Üì"),e=e.replace("ArrowLeft","‚Üê"),e=e.replace("ArrowRight","‚Üí"),e=e.replace("Enter","‚èé"),e=e.replace("Escape","Esc"),e=e.replace("Backspace","‚å´"),e=e.replace("Delete","‚å¶"),e=e.replace("Tab","‚á•"),e)))}const de=(0,r.nY)({id:"shortcuts",state:()=>({shortcuts:[],keys:[],active:{}}),getters:{get(e){return this.shortcuts.find((t=>t===e))},get_key(e){if(this.keys.includes(e))return this.shortcuts.find((t=>t.key===e))},list(){return this.shortcuts.map((e=>({...e,keys:ce(e.key)})))},sections(){let e=[],t=this.shortcuts.map((e=>e.tag));t=[...new Set(t)];for(let o=0;o<t.length;o++)e.push({tag:t[o],list:this.list.filter((e=>e.tag===t[o]))});return e}},actions:{register(e,t=!1){e?.key&&e?.description?(this.keys.includes(e.key)&&re.Cw.warn(`‚å®Ô∏è Shortcut key "${e.key}" already registered`),this.keys.push(e.key),this.shortcuts.push(e),t||this.sort()):re.Cw.error("‚å®Ô∏è Shortcut must have key and description text")},register_all(e,t){for(let o=0;o<e.length;o++)this.register({...e[o],tag:t},!0);this.sort()},remove(e){this.shortcuts.includes(e)?this.shortcuts.splice(this.shortcuts.indexOf(e),1):re.Cw.error("‚å®Ô∏è Shortcut not registered, cannot remove",e)},remove_all(e,t){for(let o=0;o<e.length;o++)this.remove({...e[o],tag:t})},remove_tag(e){this.shortcuts=this.shortcuts.filter((t=>t.tag!==e)),this.keys=this.shortcuts.map((e=>e.key))},remove_key(e){this.keys.includes(e)?(this.keys.splice(this.keys.indexOf(e),1),this.shortcuts.splice(this.shortcuts.indexOf(this.get_key(e)),1)):re.Cw.error(`‚å®Ô∏è Key "${e}" not registered, cannot remove shortcut`)},remove_keys(e){for(let t=0;t<e.length;t++)this.remove_key(e[t])},sort(){this.shortcuts.sort(((e,t)=>e.tag!==t.tag?"General"!==e.tag&&t.tag?"General"!==t.tag&&e.tag?e.tag.localeCompare(t.tag):1:-1:e.top&&!t.top?-1:!e.top&&t.top?1:e.key!==t.key?e.key.localeCompare(t.key):e.description.localeCompare(t.description)))},clear(){this.shortcuts=[],this.keys=[],re.Cw.log("‚å®Ô∏è Cleared shortcuts")},set_activity(e,t){this.active[t]=e},is_active(e){return this.active[e]}}});var ue=o(962);const he=(0,r.nY)({id:"notifications",state:()=>({}),getters:{enabled(){return"Notification"in window&&"granted"===Notification.permission}},actions:{register(e){"Notification"in window?this.enabled?re.Cw.log("üîî Notifications already enabled"):e||"denied"!==Notification.permission?Notification.requestPermission().then((e=>{"granted"===e?this.add({title:"Notifications Enabled",message:"You can now receive notifications from MVTT"}):(re.Cw.error("üîî Notifications permission denied"),new j.Qp("Cannot enable notifications","permission denied",2500))})):re.Cw.warn("üîî Notifications permission previously denied"):(re.Cw.error("üîî This browser does not support desktop notification"),new j.Qp("Cannot enable notifications","browser lacks support",2500))},add(e,t=(()=>{})){if(!this.enabled)return re.Cw.error("üîî Notifications are not enabled"),new j.MY("Cannot send notification: notifications are not enabled",2500),null;new Notification(e.title,{...e,icon:"/img/icons/app.png",badge:"/img/icons/apple-touch-icon-60x60.png",renotify:!!e.tag,timestamp:Date.now()})},play(e){try{new Audio(e).play()}catch(t){re.Cw.error(`üîî Cannot play sound file "${e}"`,t)}}}}),_e=(0,r.Ey)(),me=(0,a.Ef)(oe);me.use(ae.A),me.use(_e),me.mixin({computed:{$env(){return{VUE_APP_BRAND_DOMAIN__VIEWCLASS:"view.mvtt.app",VUE_APP_THEME_ACCENT_COLOR_ALT:"4c4c4c",VUE_APP_BRAND_DOMAIN__ADDCLASS:"add.mvtt.app",VUE_APP_BRAND_DOMAIN__VIEWTASK:"view.mvtt.app",VUE_APP_ORG_NAME:"MVLA",VUE_APP_BRAND_NAME_SHORT:"MVTT",VUE_APP_ORG_LINKS:'[["Docs", "https://mvtt.app/docs"], ["Cal", "https://mvhs.mvla.net/Calendar/"]]',VUE_APP_THEME_COLOR:"f5c14b",VUE_APP_BRAND_MAIL_ADDRESS:"mail@mvtt.app",VUE_APP_BRAND_DOMAIN:"mvtt.app",VUE_APP_BRAND_HOMEPAGE:"http://mvtt.app",VUE_APP_ORG_GRADES:'[[9, "Freshman"], [10, "Sophomore"], [11, "Junior"], [12, "Senior"]]',VUE_APP_THEME_CONSOLE_COLOR_TEXT:"C9B092",VUE_APP_SIDEBAR_DOWNLOAD_URL:"/download/mvtt-sidebar.zip",VUE_APP_BRAND_URL:"https://mvtt.app",VUE_APP_BRAND_DOMAIN__API:"api.mvtt.app",VUE_APP_THEME_CONSOLE_COLOR_BG:"272727",VUE_APP_ORG_TEACHER_GRADE:"Teacher / Educator",VUE_APP_BRAND_NAME_LONG:"MV Task Tracker",VUE_APP_ORG_DOMAIN:"mvla.net",VUE_APP_BRAND_ALLOWED_HOSTS:"mvla.net,*.mvla.net",VUE_APP_THEME_ACCENT_COLOR:"000000",NODE_ENV:"production",BASE_URL:"/"}},$status(){return re.Cw},$store(){return(0,le.s)()},$shortcuts(){return de()},$magic(){return(0,ue.F)()},$notify(){return he()}}}),me.use(se.A),me.use(ne.A,{preLoad:2,attempt:1}),me.mount("#root"),(0,s.wB)(_e.state,(e=>{window.localStorage.setItem("MVTT_app_state",JSON.stringify(e.main))}),{deep:!0}),window.addEventListener("storage",(e=>{"MVTT_teacher_mode"===e.key&&(re.Cw.log("üè´ Detected teacher mode change, reloading"),window.location.reload())})),re.Cw.log("üõú Started "+(window?.navigator?.onLine?"online":"offline")),window?.navigator?.onLine||new j.y8("Features may not work as intended offline","default",1e4,o(3662)),window.addEventListener("offline",(()=>{new j.y8("Connection lost","default",3500,o(7620)),re.Cw.warn("üõú Connection lost")})),window.addEventListener("online",(()=>{new j.y8("You're back online!","default",3500,o(1087)),re.Cw.log("üõú Connection restored")})),I()(document.body).on("click",".auth-action",(function(){const e=(0,le.s)();!e.user&&I()(this).hasClass("can-login")?e.login():I()(this).hasClass("can-logout")&&(I()(this).hasClass("doprompt")?e.logout_prompt=!0:e.logout())})),I()(document.body).on("click",".gohome",(function(){ae.A.push("/")})),ae.A.afterEach((e=>{e.meta&&e.meta.page_title?document.title="MV Task Tracker | "+e.meta.page_title:document.title="MV Task Tracker";let t=e.meta?.theme_color?.light||"#f5c14b",o=e.meta?.theme_color?.dark||"#f5c14b";I()("meta.theme-color").attr("content",t),I()("meta.theme-color-dark").attr("content",o),(0,j.bn)();const a=document.documentElement.style;a.setProperty("--theme-color",t),a.setProperty("--theme-color-dark",o);let s=e.meta?.theme_color?.text_light||"#000000",r=e.meta?.theme_color?.text_dark||"#ffffff";a.setProperty("--theme-color-text",s),a.setProperty("--theme-color-text-dark",r),a.setProperty("--theme-color-hover",s+"33"),a.setProperty("--theme-color-hover-dark",r+"33")})),window.toast=j.jT,window.$=I(),ae.A.beforeEach((e=>{const t=(0,le.s)();return e.meta&&e.meta.requiresAuth&&t&&!t.user?(new j.y8("Please log in or join to access this page","default",1500,o(5476)),{path:"/",query:{redirect:e.fullPath}}):e.meta&&e.meta.requiresTeacher&&t.user&&!t.is_teacher?(new j.y8("You must be a teacher to access this page","default",1500,o(5476)),{name:"portal"}):e.meta&&e.meta.requiresAdmin&&t.user&&!t.is_admin?(new j.y8("Only administrators can access this page","default",1500,o(5476)),{name:"portal"}):void 0}))},6496:function(e,t,o){"use strict";o.d(t,{A:function(){return Y}});var a=o(1387),s=o(6768);const r={class:"apphome hidescroll scrolloverflow"},i={class:"base fullheightcontent"};function n(e,t,o,a,n,l){const c=(0,s.g2)("BaseNav"),d=(0,s.g2)("router-view"),u=(0,s.g2)("BaseFooter");return(0,s.uX)(),(0,s.CE)("main",r,[(0,s.Lk)("main",i,[(0,s.bF)(c),(0,s.bF)(d,{class:"inner-base"})]),(0,s.bF)(u)])}var l=o(4232);const c=e=>((0,s.Qi)("data-v-4a28aa5c"),e=e(),(0,s.jt)(),e),d={class:"gohome hideoverflow"},u=["_theme"],h=c((()=>(0,s.Lk)("div",{class:"theme_icon"},null,-1))),_=c((()=>(0,s.Lk)("div",{class:"toggle_text"},"Switch Theme",-1))),m=[h,_],p=c((()=>(0,s.Lk)("span",{class:"flex_spacer"},null,-1))),f=c((()=>(0,s.Lk)("hr",null,null,-1))),g={class:"base-pages-nav"},k=["href"],w=c((()=>(0,s.Lk)("span",{class:"flex_spacer"},null,-1)));function v(e,t,o,a,r,i){const n=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("header",null,[(0,s.Lk)("h1",d,(0,l.v_)(e.$env.VUE_APP_BRAND_NAME_LONG),1),(0,s.Lk)("button",{_theme:e.$store.get_theme,class:"theme_button",title:"Switch Theme",onClick:t[0]||(t[0]=(...t)=>e.$store.toggle_theme&&e.$store.toggle_theme(...t))},m,8,u),p,r.mobile&&!r.mobile_menu_open?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"nav-mobile-btn",onClick:t[1]||(t[1]=e=>r.mobile_menu_open=!r.mobile_menu_open)})):(0,s.Q3)("",!0),!r.mobile||r.mobile_menu_open?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,l.C4)(["nav-actions",{mobile:r.mobile}])},[r.mobile?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"nav-mobile-btn alt-btn",onClick:t[2]||(t[2]=e=>r.mobile_menu_open=!r.mobile_menu_open)})):(0,s.Q3)("",!0),f,(0,s.Lk)("nav",g,[(0,s.bF)(n,{class:"click-action-inline",to:"/",onClick:i.closeMenu},{default:(0,s.k6)((()=>[(0,s.eW)("Home")])),_:1},8,["onClick"]),(0,s.bF)(n,{class:"click-action-inline",to:"/about",onClick:i.closeMenu},{default:(0,s.k6)((()=>[(0,s.eW)("About")])),_:1},8,["onClick"]),(0,s.bF)(n,{class:"click-action-inline",to:"/contact",onClick:i.closeMenu},{default:(0,s.k6)((()=>[(0,s.eW)("Contact")])),_:1},8,["onClick"]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(JSON.parse(e.$env.VUE_APP_ORG_LINKS||"[]"),(e=>((0,s.uX)(),(0,s.CE)("a",{class:"click-action-inline",href:e[1],key:e[1],onClick:t[3]||(t[3]=(...e)=>i.closeMenu&&i.closeMenu(...e))},(0,l.v_)(e[0]),9,k)))),128))]),w,(0,s.Lk)("button",{id:"nav-auth-btn",class:(0,l.C4)(["small-action-btn auth-action can-logout can-login click-action",{linked:e.$store.personal_account&&e.$store.user,oauth:!i.logged_in}])}," Log "+(0,l.v_)(i.logged_in?"Out":"In"),3)],2)):(0,s.Q3)("",!0)])}var y={name:"BaseNav",data(){return{mobile_menu_open:!1,mobile:window.innerWidth<=800}},methods:{resize(){this.mobile=window.innerWidth<=800,this.mobile||this.closeMenu()},closeMenu(){this.mobile_menu_open=!1}},mounted(){window.addEventListener("resize",this.resize)},unmounted(){window.removeEventListener("resize",this.resize)},computed:{logged_in(){return!!this.$store.user}}},b=o(1241);const A=(0,b.A)(y,[["render",v],["__scopeId","data-v-4a28aa5c"]]);var C=A;const P=e=>((0,s.Qi)("data-v-24964224"),e=e(),(0,s.jt)(),e),E={class:"desktop_only"},T={class:"mobile_only"},x=P((()=>(0,s.Lk)("span",null,[(0,s.eW)("Website by "),(0,s.Lk)("a",{href:"https://svonk.me/"},"Sander Vonk"),(0,s.eW)(".")],-1)));function S(e,t,o,a,r,i){const n=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("footer",null,[(0,s.Lk)("p",null,[(0,s.Lk)("span",null,[(0,s.eW)("¬© 2022-2023 "),(0,s.Lk)("span",E,(0,l.v_)(e.$env.VUE_APP_BRAND_NAME_LONG),1),(0,s.Lk)("span",T,(0,l.v_)(e.$env.VUE_APP_BRAND_NAME_SHORT),1),(0,s.eW)(".¬†")]),(0,s.eW)(" ‚Åü‚Ää"),x,(0,s.Lk)("span",null,[(0,s.eW)("‚Åü‚Ää Legal: "),(0,s.Lk)("span",null,[(0,s.bF)(n,{to:"/legal/privacy"},{default:(0,s.k6)((()=>[(0,s.eW)("Privacy Policy")])),_:1}),(0,s.eW)(",‚Åü")]),(0,s.Lk)("span",null,[(0,s.bF)(n,{to:"/legal/terms"},{default:(0,s.k6)((()=>[(0,s.eW)("Terms of Service")])),_:1})])])])])}var N={name:"BaseFooter"};const O=(0,b.A)(N,[["render",S],["__scopeId","data-v-24964224"]]);var L=O,$={name:"AppHome",components:{BaseNav:C,BaseFooter:L}};const R=(0,b.A)($,[["render",n]]);var M=R;const D=e=>((0,s.Qi)("data-v-ab8b32b8"),e=e(),(0,s.jt)(),e),V={class:"not-found"},I=D((()=>(0,s.Lk)("h1",{class:"title_text err_text"},"404",-1))),j=D((()=>(0,s.Lk)("h2",{class:"header_style err_text hideoverflow"},"Page Not Found",-1))),U=D((()=>(0,s.Lk)("hr",{class:"err-break"},null,-1))),q=D((()=>(0,s.Lk)("span",null,"¬†|¬†",-1))),B={key:1,class:"nostyle"},H=D((()=>(0,s.Lk)("span",null,"¬†|¬†",-1))),G=D((()=>(0,s.Lk)("div",{class:"err-pad-bottom"},null,-1)));function Q(e,t,o,a,r,i){const n=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",V,[I,j,U,(0,s.Lk)("nav",null,[(0,s.bF)(n,{class:"router-link click-action-inline",to:"/"},{default:(0,s.k6)((()=>[(0,s.eW)("Home")])),_:1}),q,i.logged_in?((0,s.uX)(),(0,s.Wv)(n,{key:0,class:"router-link click-action-inline",to:"/portal"},{default:(0,s.k6)((()=>[(0,s.eW)("Portal")])),_:1})):((0,s.uX)(),(0,s.CE)("span",B,[(0,s.bF)(n,{class:"router-link click-action-inline",to:"/about"},{default:(0,s.k6)((()=>[(0,s.eW)("About")])),_:1}),H,(0,s.bF)(n,{class:"router-link click-action-inline",to:"/contact"},{default:(0,s.k6)((()=>[(0,s.eW)("Contact")])),_:1})]))]),G])}var W={name:"NotFound",computed:{logged_in(){return this.$store.user}}};const X=(0,b.A)(W,[["render",Q],["__scopeId","data-v-ab8b32b8"]]);var F=X;const K=(0,a.aE)({history:(0,a.LA)("/"),routes:[{path:"/",name:"home",component:M,meta:{page_title:"Home",theme_color:{light:"#ffffff",dark:"#16130e"},requiresAuth:!1},children:[{path:"",name:"home",component:()=>o.e(658).then(o.bind(o,8658)),meta:{page_title:"Home",theme_color:{light:"#ffffff",dark:"#16130e"},requiresAuth:!1},children:[{path:"/view/:ref([^~]+~[^~]+~[^~]+)",name:"publicviewtask",component:()=>Promise.all([o.e(255),o.e(892)]).then(o.bind(o,892)),meta:{page_title:"View Task",theme_color:{light:"#bfbfbf",dark:"#0d0d0d"},requiresAuth:!1}},{path:"/view/:ref([^~]+~[^~]+)",name:"publicviewclass",component:()=>Promise.all([o.e(255),o.e(948)]).then(o.bind(o,1948)),meta:{page_title:"View Class",theme_color:{light:"#bfbfbf",dark:"#0d0d0d"},requiresAuth:!1}},{path:"/to/:path?",name:"redirect",component:()=>o.e(143).then(o.bind(o,6143)),meta:{page_title:"Confirm Redirect",theme_color:{light:"#bfbfbf",dark:"#0d0d0d"},requiresAuth:!1}},{path:"/join",name:"join",component:()=>o.e(230).then(o.bind(o,7230)),meta:{page_title:"Join the MVTT Beta",theme_color:{light:"#bfbfbf",dark:"#0d0d0d"},requiresAuth:!1,close_path:"/",blockStandardRedirect:!0}},{path:"/link/:code?",name:"link",component:()=>o.e(101).then(o.bind(o,9101)),props:!0,meta:{page_title:"Link Personal Account",theme_color:{light:"#bfbfbf",dark:"#0d0d0d"},close_path:"/",blockStandardRedirect:!0}}]},{path:"/about",name:"about",component:()=>o.e(960).then(o.bind(o,5960)),meta:{page_title:"About",theme_color:{light:"#ffffff",dark:"#16130e"},requiresAuth:!1}},{path:"/legal/privacy",name:"privacy",component:()=>o.e(503).then(o.bind(o,8503)),meta:{page_title:"Legal - Privacy Policy",theme_color:{light:"#ffffff",dark:"#16130e"},requiresAuth:!1}},{path:"/legal/tos",name:"tos",component:()=>o.e(812).then(o.bind(o,8812)),meta:{page_title:"Legal - Terms of Service",theme_color:{light:"#ffffff",dark:"#16130e"},requiresAuth:!1}},{path:"/download",name:"download",component:()=>o.e(178).then(o.bind(o,9178)),meta:{page_title:"Download [BETA]",theme_color:{light:"#ffffff",dark:"#16130e"},requiresAuth:!1}},{path:"/roadmap",name:"roadmap",component:()=>o.e(651).then(o.bind(o,8651)),meta:{page_title:"Development Roadmap",theme_color:{light:"#ffffff",dark:"#16130e"},requiresAuth:!1}},{path:"/contact",name:"contact",component:()=>o.e(170).then(o.bind(o,1170)),meta:{page_title:"Contact",theme_color:{light:"#ffffff",dark:"#16130e"},requiresAuth:!1}},{path:"/:pathMatch(.*)*",name:"404",component:F,meta:{page_title:"404",theme_color:{light:"#ffffff",dark:"#16130e"}}}]},{path:"/portal/admin",name:"admin",component:()=>o.e(173).then(o.bind(o,9173)),redirect:"/portal/admin/logs",meta:{page_title:"Administrator Panel",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0,requiresAdmin:!0},children:[{path:"/portal/admin/logs",name:"admin_logs",component:()=>o.e(25).then(o.bind(o,2025)),meta:{page_title:"Admin Panel | Logs",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0,requiresAdmin:!0}},{path:"/portal/admin/opts",name:"admin_opts",component:()=>o.e(233).then(o.bind(o,6233)),meta:{page_title:"Admin Panel | District Options",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0,requiresAdmin:!0}},{path:"/portal/admin/usrs",name:"admin_usrs",component:()=>o.e(661).then(o.bind(o,6661)),meta:{page_title:"Admin Panel | Users and Teachers",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0,requiresAdmin:!0}},{path:"/portal/admin/msgs",name:"admin_msgs",component:()=>o.e(663).then(o.bind(o,3663)),meta:{page_title:"Admin Panel | Messages and Alerts",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0,requiresAdmin:!0}},{path:"/portal/admin/usge",name:"admin_usge",component:()=>o.e(491).then(o.bind(o,4491)),meta:{page_title:"Admin Panel | Usage Analytics",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0,requiresAdmin:!0}}]},{path:"/portal",name:"portal",component:()=>o.e(59).then(o.bind(o,9742)),meta:{page_title:"Portal",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0},children:[{path:"/portal/tutorial/add",name:"onboarding",component:()=>o.e(883).then(o.bind(o,6883)),meta:{page_title:"Onboarding",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0,block_close:!0,noSurvey:!0}},{path:"/portal/tutorial/:tab?",name:"tutorial",component:()=>o.e(938).then(o.bind(o,8938)),meta:{page_title:"Tutorial Videos",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0}},{path:"/portal/study",name:"study",component:()=>o.e(59).then(o.bind(o,9742)),meta:{page_title:"Study Portal",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0}},{path:"/portal/study/session/:page?",name:"studysession",component:()=>o.e(75).then(o.bind(o,1075)),meta:{page_title:"Study Session",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0,block_close:!0},children:[{path:"/portal/study/session/:page?/view/:ref?",name:"sessionview",component:()=>Promise.all([o.e(255),o.e(892)]).then(o.bind(o,892)),meta:{page_title:"Session Session | View Task",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0}},{path:"/portal/study/session/:page?/notes/:ref?",name:"sessionnotes",component:()=>o.e(260).then(o.bind(o,260)),meta:{page_title:"Session Session | Task Notes",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0}}]},{path:"/portal/statistics",name:"stats",component:()=>o.e(860).then(o.bind(o,860)),meta:{page_title:"View Statistics",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0}},{path:"/portal/survey/daily",name:"daily",component:()=>o.e(280).then(o.bind(o,1280)),meta:{page_title:"Daily Check-In",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0,block_close:!0,blockStandardRedirect:!0,noSurvey:!0}},{path:"/portal/settings",name:"settings",component:()=>o.e(326).then(o.bind(o,1326)),meta:{page_title:"Settings",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0,noSurvey:!0}},{path:"/portal/add",name:"addclass",component:()=>o.e(583).then(o.bind(o,6583)),meta:{page_title:"Join a Class",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0}},{path:"/portal/add/ref/:ref?",name:"refclass",component:()=>o.e(583).then(o.bind(o,6583)),meta:{page_title:"Join from Reference",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0}},{path:"/portal/add/code/:code",name:"codeclass",component:()=>o.e(583).then(o.bind(o,6583)),meta:{page_title:"Join from Code",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0}},{path:"/portal/add/code",name:"codeenterclass",component:()=>o.e(501).then(o.bind(o,2501)),meta:{page_title:"Enter Class Code",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0}},{path:"/portal/create",name:"createclass",component:()=>o.e(21).then(o.bind(o,21)),meta:{page_title:"Teacher | Create Class",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0,requiresTeacher:!0}},{path:"/portal/new/:tasktype?",name:"newtask",component:()=>o.e(538).then(o.bind(o,7538)),meta:{page_title:"Teacher | Add Task",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0,requiresTeacher:!0}},{path:"/portal/notes/:ref?",name:"notes",component:()=>o.e(260).then(o.bind(o,260)),meta:{page_title:"Your Task Notes",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0}},{path:"/portal/view/:ref?",name:"viewtask",component:()=>Promise.all([o.e(255),o.e(892)]).then(o.bind(o,892)),meta:{page_title:"View Task",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0}},{path:"/portal/view/:ref([^~]+~[^~]+)",name:"viewclass",component:()=>Promise.all([o.e(255),o.e(948)]).then(o.bind(o,1948)),meta:{page_title:"View Class",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0}},{path:"/portal/edit/t/:ref?",name:"edit",component:()=>o.e(420).then(o.bind(o,2420)),meta:{page_title:"Edit Task",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0,requiresTeacher:!0}},{path:"/portal/edit/c/:ref?",name:"editclass",component:()=>o.e(984).then(o.bind(o,4984)),meta:{page_title:"Edit Class",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0,requiresTeacher:!0}},{path:"/portal/archive/:type?/:ref?",name:"archive",component:()=>o.e(277).then(o.bind(o,5658)),meta:{page_title:"Confirm Task Archive",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0,requiresTeacher:!0}},{path:"/portal/leave/:ref?",name:"leave",component:()=>o.e(582).then(o.bind(o,582)),meta:{page_title:"Confirm Class Leave",theme_color:{light:"#b5b5b5",dark:"#0d0d0d"},requiresAuth:!0}}]},{path:"/portal/calendar",name:"calendar",redirect:"/portal?calendar=true",meta:{page_title:"Calendar",theme_color:{light:"#f2f2f2",dark:"#121212"},requiresAuth:!0}},{path:"/app",redirect:"/portal",meta:{requiresAuth:!0}},{path:"/study",redirect:"/portal/study",meta:{requiresAuth:!0}},{path:"/settings",redirect:"/portal/settings",meta:{requiresAuth:!0}},{path:"/survey/daily",redirect:"/portal/survey/daily",meta:{requiresAuth:!0}}],parseQuery:e=>o(9122).parse(e)});var Y=K},5129:function(e,t,o){"use strict";o.d(t,{s:function(){return w}});o(4114),o(3375),o(9225),o(3972),o(9209),o(5714),o(7561),o(6197);var a=o(3367),s=o(6265),r=o(4186),i=o(7617),n=o(3169),l=o.n(n),c=o(5537),d=o(114),u=o(6496),h=o(962);const _=new d.HF,m=navigator?.userAgent?.toLowerCase()?.indexOf(" electron/")>-1;let p="@mvla.net";function f(e){return e?.split("@")[1]==p.substring(1)}function g(){try{return window.self!==window.top}catch(e){return!0}}_.addScope("email"),_.addScope("profile"),c.j2.useDeviceLanguage(),_.setCustomParameters({login_hint:"username"+p});let k=new Date;k=new Date(k.getTime()-60*k.getTimezoneOffset()*1e3),k=k.toISOString().split("T")[0];const w=(0,a.nY)({id:"main",state:()=>{let e={},t=window.localStorage.getItem("MVTT_app_state");if(t&&"undefined"!=t&&"null"!=t)try{return s.Cw.log("‚Üª State from local storage"),e=JSON.parse(t),e.paused=!1,e.logout_prompt=!1,e}catch(o){s.Cw.warn("‚ü≥ Error parsing local storage state",o)}return s.Cw.log("üî® Setting up store from scratch"),{user:null,account_doc:null,linked_account_doc:null,classes:[],tasks:[],loaded_email:null,loaded_classes:null,teacher:{doc_ref:null,collection_ref:null},theme:null,personal_account:!1,paused:!1,logout_prompt:!1}},getters:{ORG_DOMAIN(){return p},simplified(){return this.account_doc?.prefs?.simplified||!1},linked_accounts(){return this.user&&this.active_doc&&this.active_doc.linked||[]},upcoming(){if(!this.tasks)return[];const e=Date.now(),t=288e5;let o=this.tasks.filter((o=>"note"!=o.type&&(o?.date?.getTime?o.date.getTime():0)>=e-t));return o.sort(((e,t)=>e.date<t.date?-1:e.date>t.date?1:0)),o},upcoming_todo(){return this.upcoming?this.upcoming.filter((e=>!this.finished_tasks?.includes(e.ref))):[]},non_recent_signin(){if(!this.user)return!1;let e=this.user?.metadata?.lastSignInTime;if(!e)return!1;e=new Date(e);let t=(new Date).getTime()-e.getTime();return t>864e5},recently_joined(){if(!this.user)return!1;let e=this.user?.metadata?.creationTime;if(!e)return!1;e=new Date(e);let t=(new Date).getTime()-e.getTime();return t<432e5},is_admin(){return this.is_teacher},is_teacher(){if(!this.user)return!1;if(1==this.active_doc?.teacher_mode||"true"==window?.localStorage?.["MVTT_teacher_mode"]){if(1==this.active_doc?.teacher_mode||null==this.active_doc?.teacher_mode)return window.localStorage.setItem("MVTT_teacher_mode",!0),this.personal_account?(s.Cw.log("üè´ No teacher mode for personal account"),!1):(s.Cw.log("üè´ Local teacher mode"),!0);window.localStorage.setItem("MVTT_teacher_mode",!1),s.Cw.log("üè´ Teacher mode disabled locally to reflect remote changes")}let e=this.user.email,[t,o]=e.split("@");return"@"+o==this.ORG_DOMAIN&&!/\d/.test(t)&&"@mvla.net"==this.ORG_DOMAIN&&(s.Cw.log("üè´ Teacher mode enabled for non-student district account"),!0)},done_daily_survey(){return!this.done_tutorial||!!this.active_doc&&(this.active_doc?.prefs?.skip_survey||{VUE_APP_BRAND_DOMAIN__VIEWCLASS:"view.mvtt.app",VUE_APP_THEME_ACCENT_COLOR_ALT:"4c4c4c",VUE_APP_BRAND_DOMAIN__ADDCLASS:"add.mvtt.app",VUE_APP_BRAND_DOMAIN__VIEWTASK:"view.mvtt.app",VUE_APP_ORG_NAME:"MVLA",VUE_APP_BRAND_NAME_SHORT:"MVTT",VUE_APP_ORG_LINKS:'[["Docs", "https://mvtt.app/docs"], ["Cal", "https://mvhs.mvla.net/Calendar/"]]',VUE_APP_THEME_COLOR:"f5c14b",VUE_APP_BRAND_MAIL_ADDRESS:"mail@mvtt.app",VUE_APP_BRAND_DOMAIN:"mvtt.app",VUE_APP_BRAND_HOMEPAGE:"http://mvtt.app",VUE_APP_ORG_GRADES:'[[9, "Freshman"], [10, "Sophomore"], [11, "Junior"], [12, "Senior"]]',VUE_APP_THEME_CONSOLE_COLOR_TEXT:"C9B092",VUE_APP_SIDEBAR_DOWNLOAD_URL:"/download/mvtt-sidebar.zip",VUE_APP_BRAND_URL:"https://mvtt.app",VUE_APP_BRAND_DOMAIN__API:"api.mvtt.app",VUE_APP_THEME_CONSOLE_COLOR_BG:"272727",VUE_APP_ORG_TEACHER_GRADE:"Teacher / Educator",VUE_APP_BRAND_NAME_LONG:"MV Task Tracker",VUE_APP_ORG_DOMAIN:"mvla.net",VUE_APP_BRAND_ALLOWED_HOSTS:"mvla.net,*.mvla.net",VUE_APP_THEME_ACCENT_COLOR:"000000",NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_NOSURVEY?(s.Cw.log(`üìÉ Skipping survey from {${this.active_doc?.prefs?.skip_survey?"user prefs":".env"}} override`),"skipped"):this.active_doc?.done_surveys&&this.active_doc.done_surveys?.includes(k))},done_tutorial(){return!!this.account_doc&&this.account_doc?.done_tutorial},done_join_form(){return!!this.user&&!!this.active_doc?.join_form},account_ref(){return this.user?(0,i.H9)(c.db,"users",this.user.uid):null},linked_account_ref(){return this.user&&this.account_doc&&this.account_doc.linked_to?(0,i.H9)(c.db,"users",this.account_doc.linked_to):null},active_ref(){return this.personal_account?this.linked_account_ref:this.account_ref},active_doc(){return this.personal_account?this.linked_account_doc:this.account_doc},get_theme(){let e=this.theme||window.localStorage.getItem("theme"),t=this.account_doc?.prefs?.theme,o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";return t?(e!=t&&window.localStorage.setItem("theme",t),t||"light"):(e?o=e:window.localStorage.setItem("theme",o),this.account_doc&&(this.account_doc.prefs={...this.account_doc.prefs,theme:o},this.update_wrapper_acc_doc()),e||"light")},get_loaded_classes(){if(!this.loaded_classes||!this.loaded_classes.length)return[];let e=this.loaded_classes;return e.map((e=>(e.is_joined=this.active_doc?.classes?.includes([this.loaded_email,e?.id].join("/")),e)))},finished_tasks(){try{if(!this.active_doc)throw"No active doc";return this.active_doc.finished||[]}catch(e){s.Cw.warn("üîó Couldn't get finished tasks",e)}},notes(){try{if(!this.active_doc)throw"No active doc";return this.active_doc.notes||{}}catch(e){return s.Cw.warn("üîó Couldn't get notes",e),{}}}},actions:{report_logs(){try{const e=s.Cw.getStream(),t=s.Cw.textStream(),o=(0,i.H9)((0,i.rJ)(c.db,"logs"));return(0,i.BN)(o,{date:new Date,date_inversed:-1*(new Date).getTime(),user:this.user?this.user.uid:"no user",email:this.user?this.user.email:"no user",stream:{json:e,text:t}}),new r.rQ("Logs reported and saved locally, check console for details",3500),s.Cw.log(`üìä Reported logs to server as '${o.id}'`),s.Cw.saveStream(o.id),Promise.resolve(o.id)}catch(e){return Promise.reject("Failed to report logs:"+e)}},class_text(e){if(e)return e.period?`P${e.period} - ${e.name}`:e.name},async set_account_pref(e,t){try{if(!this.account_ref)throw"No account doc";if(!e)throw"No pref provided";return await this.update_wrapper_with_merge({prefs:{...this.active_doc.prefs,[e]:t}}),Promise.resolve()}catch(o){return Promise.reject(o)}},get_surveys(e){try{let t=e.map((e=>(0,i.H9)(c.db,"survey","daily",e,this.personal_account?this.account_doc.linked_to:this.user.uid))),o=t.map((e=>(0,i.x7)(e)));return Promise.all(o).then((t=>{let o=t.map(((t,o)=>t.exists()?{date:e[o],data:t.data()}:{date:e[o],error:"No survey data for this date"}));return Promise.resolve(o)}))}catch(t){return Promise.reject(t)}},async get_cached_surveys(e,t=!1){try{const o=(0,i.H9)(c.db,"processed_surveys",this.personal_account?this.account_doc.linked_to:this.user.uid),a=await(0,i.x7)(o),r=a.exists()&&a.data()?.list||[],n=r?.map((e=>e.date)),l=r?.filter((e=>e.error))?.map((e=>e.date))||[],d=e.every((e=>n.includes(e)));if(d&&!t)return s.Cw.log("üìä Using cached surveys"),Promise.resolve(r);{t&&s.Cw.log("üìä Forcing refresh of surveys");const a=t?e:e.filter((e=>!n.includes(e)||l.includes(e))),c=await this.get_surveys(a);let d=[];for(let t of e)a.includes(t)?d.push(c[a.indexOf(t)]):d.push(r[n.indexOf(t)]);return await(0,i.BN)(o,{list:d,updated:Date.now()},{merge:!0}),s.Cw.log("üìä Got surveys from server"),Promise.resolve(d)}}catch(o){return Promise.reject(o)}},note_for(e){return this.notes&&this.notes[this.ref_to_path(e)]||null},async set_note(e,t){try{if(!this.active_doc)throw"No active doc";if(!t)throw"No ref provided";let o=this.ref_to_path(t),a=this.active_doc;return a.notes||(a.notes={}),a.notes[o]=e||null,this.set_active(a),await this.update_remote(),Promise.resolve()}catch(o){return Promise.reject(o)}},async set_finished(e,t){try{if(!this.active_doc)throw"No active doc";if(!t)throw"No reference(s) provided";let o=Array.isArray(t)?t:[t],a=this.active_doc;if(a.finished||(a.finished=[]),e)for(let e of o)a.finished.includes(e)||a.finished.push(e);else a.finished=a.finished.filter((e=>!o.includes(e)));return this.set_active(a),await this.update_remote(),new r.rQ((o.length>1?"Tasks":(0,h.F)().done_prefix(this.tasks.find((e=>e.ref==o[0]))))+(e?" marked as finished":" marked as unfinished"),2e3),Promise.resolve()}catch(o){return new r.Qp("Task(s) could not be "+(e?"marked as finished":"marked as unfinished"),o,2e3),Promise.reject(o)}},path_to_ref(){let e=[...arguments].join("/");if(!e.length)return null;let[t,o,a]=e.split("/");return t&&o?(t=t.split("@")[0],a?`${t}~${o}~${a}`:`${t}~${o}`):null},ref_to_path(){let e=[...arguments].join("~");if(!e.length)return null;let[t,o,a]=e.split("~");return t&&o?(t+=this.ORG_DOMAIN,a?`${t}/${o}/${a}`:`${t}/${o}`):null},hash(e){let t=l().SHA256(e).toString();return t.substring(0,5)},async code_from_ref(e){try{if(!e)return Promise.reject("No ref provided");e=e.split("~").join("/");let[t,o]=e.split("/");if(!t||!o)return Promise.reject("Invalid ref");t=t.split("@")[0]+this.ORG_DOMAIN,e=t+"/"+o;const a=this.hash(e);let s=this.classes.find((t=>t.id==e));if(s?.code!==a){const s=(0,i.H9)(c.db,"codes",a);await(0,i.BN)(s,{ref:e});const r=(0,i.H9)(c.db,"classes",t,"classes",o);await(0,i.mZ)(r,{code:a},{merge:!0})}return Promise.resolve(a)}catch(t){return Promise.reject(t)}},async ref_from_code(e){try{if(!e)throw"No code provided";const t=(0,i.H9)(c.db,"codes",e),o=await(0,i.x7)(t);if(s.Cw.log("üîó Got code doc",o.data()),!o.exists())throw"Code doesn't exist";let a=this.path_to_ref(o.data()?.ref);if(!a)throw"Code doesn't have ref";return Promise.resolve(a)}catch(t){return Promise.reject(t)}},async toggle_teacher(){if(!this.user)return;let e=this.active_doc?.teacher_mode||"true"==window.localStorage.getItem("MVTT_teacher_mode");window.localStorage.setItem("MVTT_teacher_mode",!e);let t=e?"off":"on";this.active_doc&&(this.active_doc.teacher_mode=!e,await this.update_remote(),s.Cw.log(`üè´ Remote teacher mode toggled ${t}`)),s.Cw.log(`üè´ Local teacher mode toggled ${t}`),new r.rQ(`Teacher mode toggled ${t}`,2e3)},async get_tasks(){try{if(!this.classes?.length)return Promise.resolve([]);let e=[],t=this.classes;for(let o=0;o<t.length;o++){let a=t[o].tasks;a=a||[];for(let r=0;r<(a?.length||0);r++){if(t[o].name=t[o].name?t[o].name:"Unnamed Class","string"==typeof a[r].date){a[r].date=a[r].date.split("T")[0];let[e,t,o]=a[r].date.split("-");a[r].date=`${t}-${o}-${e}`,a[r].date=(0,s.kX)(a[r].date),a[r].date=isNaN(a[r].date)?null:a[r].date}a[r].color=t[o].color,e.push({...a[r],class_name:this.class_text(t[o])})}}return e.sort(((e,t)=>(e.name=e.name?e.name:"",t.name=t.name?t.name:"",e.date&&t.date?e.date.getTime()==t.date.getTime()?e.period==t.period?e.name.localeCompare(t.name):e.period-t.period:e.date.getTime()-t.date.getTime():e.name.localeCompare(t.name)))),this.tasks=e,Promise.resolve(e)}catch(e){return Promise.reject(e)}},clear(){this.user=null,this.account_doc=null,this.linked_account_doc=null,this.classes=[],this.tasks=[],this.loaded_email=null,this.loaded_classes=null,this.personal_account=!1,this.teacher={doc_ref:null,collection_ref:null},window.localStorage.removeItem("MVTT_app_state"),u.A.currentRoute?.value?.meta?.requiresAuth&&u.A.push("/")},set_active(e){try{if(!e)throw"No data provided";return this.personal_account?this.linked_account_doc=e:this.account_doc=e,Promise.resolve()}catch(t){return Promise.reject(t)}},async doc_from_uid(e){try{if(!e)throw"No account uid provided";let t=await(0,i.x7)((0,i.H9)(c.db,"users",e));if(s.Cw.log("üîó Got linking account's document"),!t.exists())throw"Account doesn't exist or you haven't been added yet";let o=t.data();return Promise.resolve(o)}catch(t){return s.Cw.warn("üîó Couldn't get linking account's document",t),Promise.reject(t)}},async link_account_uid(e){if(e)if(this.personal_account){this.account_doc||(await this.create_doc(),s.Cw.log("üìÑ Dreated doc",this.account_doc));try{let t=await this.doc_from_uid(e);if(!t)throw"Account doesn't exist or you haven't been invited";this.account_doc.linked_to=e,await this.update_wrapper_acc_doc(),new r.rQ(`Successfully linked to ${t.name}'s account!`,4e3)}catch(t){return new r.Qp("Couldn't link account",t,2e3),Promise.reject(t)}}else new r.MY("This account is a primary account and cannot be linked",3e3)},async invite_linked(e){if(!this.user||!this.active_doc)return;if(this.personal_account&&new r.MY("This account is already linked!",2e3),!e||f(e)||!e.includes("@"))return void new r.MY("Please enter a valid non-MVLA email",2e3);if(this.linked_accounts.includes(e))return void new r.MY("That account is already linked",2e3);this.active_doc.linked||(this.personal_account?this.linked_account_doc.linked=[]:this.account_doc.linked=[]);let t=(0,i.rJ)(c.db,"mail");try{let o=await(0,i.gS)(t,{to:e,cc:this.user.email,from:`${this.active_doc.name} via MV Task Tracker <mail@mvtt.app>`,fromname:this.active_doc.name+" via MV Task Tracker",template:{name:"link_invite",data:{sender_name:this.active_doc.name.split(" ")[0],sender_uid:this.user.uid}}}),a=(0,i.H9)(t,o.id),n=await(0,i.x7)(a),l=1;while(!n.exists()||0==!!n.data()?.delivery?.attempts&&l<=3)await new Promise((e=>setTimeout(e,2e3*(2^l)))),n=await(0,i.x7)(a),s.Cw.log("üìß Checked email doc"),l++;if(!n.data()?.delivery?.info?.accepted?.includes(e)||0==n.data()?.delivery?.attempts)throw s.Cw.log("üìß Email failed to send",n.data()),"Email failed to send";return this.personal_account?this.linked_account_doc.linked.push(e):this.account_doc.linked.push(e),await this.update_remote(),new r.rQ(`We notified ${e}, you'll receive a copy of the email too!`,4e3),Promise.resolve()}catch(o){return new r.Qp(`Couldn't invite "${e}"`,o,2e3),Promise.reject(o)}},async uninvite_linked(e){try{if(!this.user)return;if(this.active_doc.linked.includes(e)){let t=this.active_doc.linked.filter((t=>t!=e));this.personal_account?this.linked_account_doc.linked=t:this.account_doc.linked=t,await this.update_remote(),new r.rQ(`Removed ${e} from your linked accounts`,2e3)}else new r.MY(`${e} is not linked to this account`,2e3);Promise.resolve()}catch(t){return new r.Qp(`Couldn't unlink "${e}"`,t,2e3),Promise.reject(t)}},refresh_timeout(e){this.paused=!1,this.user&&(0,c.RJ)(e)},async login_promise(){return new Promise((e=>{let t=setInterval((()=>{this.user&&(clearInterval(t),e(this.user))}),100)}))},async save_join_form(e){try{if(!this.user||!this.active_doc)throw"No doc to save join form to";return this.personal_account?(this.linked_account_doc=this.linked_account_doc||{},this.linked_account_doc.join_form=e):(this.account_doc=this.account_doc||{},this.account_doc.join_form=e),await this.update_remote(),Promise.resolve()}catch(t){return Promise.reject(t)}},async finish_tutorial(e){try{if(!this.user||!this.account_doc)throw"No doc to save tutorial status to";return this.account_doc.done_tutorial=e,await this.update_wrapper_with_merge({done_tutorial:e}),Promise.resolve()}catch(t){return Promise.reject(t)}},async save_daily_survey(e){try{this.user||await this.login_promise();let t=(0,i.H9)(c.db,"survey","daily",k,this.personal_account?this.account_doc?.linked_to:this.user.uid),o={time:(new Date).getTime(),responses:e};await(0,i.BN)(t,o);let a=this.active_doc?.done_surveys?this.active_doc.done_surveys:[];return a.push(k),this.personal_account?this.linked_account_doc.done_surveys=a:this.account_doc.done_surveys=a,await this.update_remote(),new r.rQ("Saved daily survey",2e3),Promise.resolve()}catch(t){return new r.Qp("Couldn't save daily survey",t,2e3),Promise.reject(t)}},async toggle_theme(){this.theme="light"==this.get_theme?"dark":"light",window.localStorage.setItem("theme",this.theme),this.account_doc&&(this.account_doc.prefs={...this.account_doc.prefs,theme:this.theme},delete this.account_doc.theme,await this.update_wrapper_acc_doc()),new r.rQ(`Switched to ${this.theme} theme`,2e3),this.theme=this.get_theme},async toggle_simplified(){if(!this.account_doc)return;let e=!this.account_doc.prefs?.simplified;this.account_doc.prefs={...this.account_doc.prefs,simplified:e},await this.update_wrapper_acc_doc(),new r.rQ(`Switched to ${e?"simplified":"detailed (classic)"} view`,2e3)},async remove_class_id_helper(e){let t=this.active_doc.classes.filter((t=>t!=e));this.personal_account?this.linked_account_doc.classes=t:this.account_doc.classes=t,this.classes=this.classes.filter((t=>t.id!=e)),this.get_tasks(),await this.update_remote()},async remove_invalid(e){return await this.remove_class_id_helper(e),new r.MY(`Removed non-existent class "${e}"`,2e3),Promise.resolve()},async remove_class(e){try{return await this.remove_class_id_helper(e),s.Cw.log("üóëÔ∏è Removed class from user's doc: "+e),new r.rQ("Left class",2e3),Promise.resolve()}catch(t){return s.Cw.log("üî• Error removing class from user's doc: "+t),new r.Qp("Couldn't leave class",t,2e3),Promise.reject(t)}},set_user(e){s.Cw.log("üîë Setting user"),(0,i.x7)((0,i.H9)(c.db,"users",e.uid)).then((t=>{if(t.exists()?(this.account_doc=t.data(),this.personal_account=this.account_doc?.personal_account):(this.account_doc=null,this.linked_account_doc=null),!e.email||!f(e.email)&&(!this.personal_account||!("link"==u.A?.currentRoute?.value?.name||this.account_doc?.personal_account&&this.account_doc?.linked_to)))return c.j2.signOut(),new r.MY("Please use your MVLA (@mvla.net) email to log in, or use an account that has been linked",4e3),void this.clear();this.user=e,this.personal_account&&this.get_remote(),this.is_teacher&&(s.Cw.log("üè´ In teacher mode"),this.teacher.doc_ref=(0,i.H9)(c.db,"classes",this.user.email),this.teacher.collection_ref=(0,i.rJ)(this.teacher.doc_ref,"classes")),u.A.currentRoute?.value?.query?.redirect&&!u.A.currentRoute?.value?.meta?.blockStandardRedirect&&u.A.replace(u.A.currentRoute?.value?.query?.redirect)})).catch((e=>{c.j2.signOut(),"unavailable"==e.code?(new r.Qp("No connection available, you were signed out"),s.Cw.log("üõú Connection unavailable")):(new r.MY("Something went wrong loading your data; signed out",2e3),s.Cw.log("üî• Error loading user data;",e))}))},async login(){new r.y8("Opening login popup...","default",1e3,o(5476)),await(m||g()?(0,d.$2)(c.j2,_):(0,d.df)(c.j2,_)).then((()=>{if(this.user&&this.user.email&&f(this.user.email))return new r.y8("Logged in as "+this.user.displayName+"!","default",2e3,o(608)),s.Cw.log("üîë Logged in as "+this.user.displayName),(0,c.l4)(this.user),u.A.currentRoute?.value?.query?.redirect||u.A.currentRoute?.value?.meta?.blockStandardRedirect||u.A.push("/portal"),Promise.resolve()})).catch((e=>{let t=(0,r.Cs)(e);return"auth/cancelled-popup-request"==e.code||"auth/popup-closed-by-user"==e.code||"auth/user-cancelled"==e.code?new r.MY(t,2e3):new r.Qp("Couldn't log in",t,2e3),Promise.reject(t)}))},async login_personal(){new r.y8("Opening login popup...","default",1e3,o(5476));const e=new d.HF;e.addScope("email"),e.addScope("profile"),await(m||g()?(0,d.$2)(c.j2,e):(0,d.df)(c.j2,e)).then((e=>(e.user&&e.user.email&&!f(e.user.email)||this.logout(),new r.y8("Logged in as "+e.user.displayName+"!","default",2e3,o(608)),s.Cw.log("üîë Logged in as "+e.user.displayName),(0,c.l4)(e.user),Promise.resolve()))).catch((e=>(new r.Qp("Couldn't log in",e,2e3),Promise.reject(e))))},async logout(){u.A.currentRoute?.value?.meta?.requiresAuth&&await u.A.push({path:"/"}),c.j2.signOut(),this.clear(),new r.y8("Logged Out","default",1500,o(5476))},async get_remote(){let e=await(0,i.x7)(this.active_ref);s.Cw.log("üìÑ Got user doc remote"),e.exists()?this.set_active(e.data()):this.personal_account?(s.Cw.log("üîó Linked account doesn't exist, removing it and going home"),new r.MY("Linked account doesn't exist, removing it and going home",2e3),this.account_doc.linked_to=null,await this.update_wrapper_acc_doc(),this.linked_account_doc=null,u.A.push("/")):(await this.create_doc(),await this.get_remote())},async update_remote(){await(0,i.BN)(this.active_ref,this.active_doc,{merge:!0}),s.Cw.log("‚è∂ Pushed changes to remote")},async update_wrapper_acc_doc(){await(0,i.BN)(this.account_ref,this.account_doc,{merge:!0})},async update_wrapper_with_merge(e){try{return await(0,i.BN)(this.account_ref,e,{merge:!0}),Promise.resolve()}catch(t){return Promise.reject(t)}},async create_doc(){if(window?.navigator?.onLine||(s.Cw.warn("üî• No internet connection, won't create doc to prevent overwrite"),new r.Qp("Prevented destructuive offline userdoc create",2e3)),!this.user)return s.Cw.warn("üî• No user to create doc for");s.Cw.log("üìÑ User document doesn't exist, creating new one..."),new r.MY("User document doesn't exist, creating new one...",2e3),this.account_doc={name:this.user.displayName,email:this.user.email,classes:[],prefs:{theme:this.get_theme}},this.personal_account&&(this.account_doc={...this.account_doc,linked_to:null,personal_account:!0}),await this.update_wrapper_acc_doc(),new r.rQ("Created user document; Let's get started",2e3),this.personal_account||u.A.push({name:"portal"}),this.is_teacher&&(await this.create_teacher_doc(),new r.rQ("Created user & teacher documents; Let's get started",2e3))},async create_teacher_doc(){let e=(0,i.H9)(c.db,"classes",this.active_doc.email||this.user.email);await(0,i.BN)(e,{name:this.active_doc.name||this.user.displayName,email:this.active_doc.email||this.user.email}),this.teacher={doc_ref:e,collection_ref:(0,i.rJ)(e,"classes")},u.A.push("/portal/create")},async fetch_classes(){let e=Math.random().toString(36).substring(7);if(s.Cw.log(`üìö Started fetch   | <${e}>`),!this.active_doc?.classes){let e=0;const t=1e4,o=1500,a=100;while(!this.active_doc?.classes&&e<t/a)await new Promise((e=>setTimeout(e,a))),e++;if(!this.active_doc?.classes)return Promise.reject("Classes not found in user doc within load cycle");e*a>=o&&(s.Cw.warn(`üìö Initial class fetch took ${e*a}ms, warning set at ${o}ms`),new r.MY(`Initial class fetch took ${e*a}ms. Your network connection may negativly affect site preformance.`,3500))}let t=[...new Set(this.active_doc.classes)];t.length!=this.active_doc.classes.length&&(this.personal_account?this.linked_account_doc.classes=t:this.account_doc.classes=t,await this.update_remote(),new r.MY("Removed duplicate classes",2e3),s.Cw.log("üìö Removed duplicate classes"));let o=[];for(let a of this.active_doc.classes){let[e,t]=a.split("/");if(!e||!t){await this.remove_invalid(a);continue}let s=(0,i.rJ)(c.db,"classes",e,"classes");if(!s){await this.remove_invalid(a);continue}let r=(0,i.H9)(s,t),n=await(0,i.x7)(r);if(!n.exists()){await this.remove_invalid(a);continue}let l=n.data();l.id=a,l.ref=[e,t].join("/"),o.push(l)}s.Cw.log(`üìö Got class docs  | <${e}>`),o=o.map((e=>{let[t,o]=e.ref.split("/");return e.tasks=e.tasks||[],e.tasks=e.tasks.map((e=>(e.ref=[t,o,e.id].join("/"),delete e.id,e))),e})),s.Cw.log(`üìö Processed tasks | <${e}>`),o.sort(((e,t)=>e.period==t.period?e.name.localeCompare(t.name):e.period||0===e.period?t.period||0===t.period?e.period-t.period:-1:1)),this.classes=o,this.get_tasks(),Promise.resolve()},async fetch_classes_by_email(e){if(this.loaded_email=null,!e||!f(e))return this.loaded_classes=null,void(this.loaded_email=e);s.Cw.log("üìÑ Getting classes from email");let t=[],o=(0,i.rJ)((0,i.H9)(c.db,"classes",e),"classes"),a=await(0,i.GG)(o);s.Cw.log("üìÑ Got classes subcollection from email"),a.forEach((o=>{let a=o.data();a.id=o.id,a.is_joined=this.active_doc?.classes.includes([e,o.id].join("/")),t.push(a)})),t.sort(((e,t)=>e.period==t.period?e.name.localeCompare(t.name):e.period-t.period)),this.loaded_classes=t,this.loaded_email=e},async add_class(e,t,o,a){if(!this.active_doc?.classes)return;if(!t)return;let s=[e,t].join("/");return this.active_doc.classes.includes(s)?void 0:(this.personal_account?this.linked_account_doc.classes.push(s):this.account_doc.classes.push(s),await this.update_remote(),await this.fetch_classes(),new r.rQ(`Added "${this.class_text({name:o,period:a})}" to your classes`,2e3),Promise.resolve())},async create_class(e){if(s.Cw.log("üî® Creating class",e),this.is_teacher){if(e.name)try{if(!this.teacher.doc_ref||!this.teacher.collection_ref)return await this.create_teacher_doc(),void await this.create_class(e);let t=await(0,i.gS)(this.teacher.collection_ref,e);return new r.rQ(`Created class "${this.class_text(e)}"`,2e3),s.Cw.log("üè´ class_doc_ref",t),await this.add_class(this.active_doc.email||this.user.email,t.id,e.name,e.period),Promise.resolve()}catch(t){return new r.Qp("Couldn't create class",(0,r.Cs)(t),2e3),Promise.reject(t)}}else new r.MY("You need to be a teacher to create a class",2e3)},async create_task(e,t){try{if(!e.name&&"note"!=e?.type)return Promise.reject("No task name specified");if(!t||0==t.length)return Promise.reject("No classes selected");let o=(0,i.wP)(c.db),a=Array.from(this.classes);t.forEach((t=>{let s=t,[r,n]=t.split("/"),l=(0,i.rJ)(c.db,"classes",r,"classes",n,"tasks");e.class_id=s;let d=(0,i.H9)(l);o.set(d,e),a.forEach((t=>{t.id==s&&t.tasks.push({...e,ref:[r,n,d.id].join("/"),class_id:s,_proxy:!0})}))})),await o.commit(),this.classes=a,this.get_tasks();let s="note"==e.type?"":`"${e.name}"`;return new r.rQ(`Added ${e.type||"task"} ${s} to ${t.length} class${1==t.length?"":"es"}`,2e3),Promise.resolve()}catch(o){return Promise.reject(o)}},async update_class(e,t){try{let[o,a]=e.split("/");o+=this.ORG_DOMAIN,await(0,i.mZ)((0,i.H9)(c.db,"classes",o,"classes",a),t),s.Cw.log("üìù Updated remote class");let r=this.classes;const n=r.findIndex((e=>e.id===[o,a].join("/")));return-1!==n&&(r[n]={...r[n],...t,_proxy:!0},s.Cw.log("üìù Updated local class")),this.classes=[...r],this.get_tasks(),Promise.resolve()}catch(o){return Promise.reject(o)}},async update_task(e,t){try{delete t.class_id,delete t.ref,delete t._class;let[o,a,r]=e.split("/");o.includes(this.ORG_DOMAIN)||(o+=this.ORG_DOMAIN),await(0,i.mZ)((0,i.H9)(c.db,"classes",o,"classes",a,"tasks",r),t),s.Cw.log("üìù Updated remote task");let n=this.classes,l=[o,a].join("/");const d=n.findIndex((e=>e.id===l)),u=[o,a,r].join("/");if(-1!==d){const e=n[d].tasks.findIndex((e=>e.ref===u));-1!==e&&(n[d].tasks[e]={...t,ref:u,class_id:l,_proxy:!0},s.Cw.log("üìù Updated local task"))}return this.classes=[...n],this.get_tasks(),Promise.resolve()}catch(o){return Promise.reject(o)}},async archive_task(e){let[t,o,a]=e.split("/");t+=this.ORG_DOMAIN;try{await(0,i.kd)((0,i.H9)(c.db,"classes",t,"classes",o,"tasks",a)),s.Cw.log("üìÑ Archived task");try{let e=this.classes;e.forEach((e=>{e.id==[t,o].join("/")&&(e.tasks=e.tasks.filter((e=>e.ref!=[t,o,a].join("/"))))})),this.classes=e,this.get_tasks()}catch(r){throw s.Cw.error("üî• Error removing task from local",r),r}}catch(r){return Promise.reject(r)}return Promise.resolve()},async task_from_ref(e){try{let[t,o,a]=e.split("/");t+=this.ORG_DOMAIN,s.Cw.log("üìÑ Getting task from ref:",[t,o,a].join(" - "));let r=await(0,i.x7)((0,i.H9)(c.db,"classes",t,"classes",o));if(!r.exists())return Promise.resolve(null);let n=r.data();delete n.tasks,s.Cw.log("üìö Got class from ref");let l=await(0,i.x7)((0,i.H9)(c.db,"classes",t,"classes",o,"tasks",a));if(!l.exists())return Promise.resolve(null);s.Cw.log("üìÑ Got task from ref");let d=l.data();return d={...d,ref:e,class_id:[t,o].join("/"),class_name:this.class_text(n),_class:{...n,ref:[t.split(this.ORG_DOMAIN)[0],o].join("~")}},Promise.resolve(d)}catch(t){return Promise.reject(t)}},async class_from_ref(e,t=!1){try{let[o,a]=e.split("/");o+=this.ORG_DOMAIN;let r=await(0,i.x7)((0,i.H9)(c.db,"classes",o,"classes",a));if(s.Cw.log("üìÑ Got class doc"),!r.exists())return Promise.reject("Class doesn't exist");let n=r.data();return t||delete n.tasks,s.Cw.log("üìö Got class data"),Promise.resolve(n)}catch(o){return Promise.reject(o)}},async upcoming_from_ref(e,t){try{if(!e)throw"No class ref provided";t||(t=await this.class_from_ref(e));let[o,a]=e.split("/");o+=this.ORG_DOMAIN;let r=await(0,i.x7)((0,i.H9)(c.db,"classes",o,"classes",a));if(!r.exists())throw"Class doesn't exist";let n=r.data()?.tasks||[];n=n.filter((e=>"note"!=e.type&&(0,s.kX)(e.date).getTime()>=(new Date).getTime())),n.sort(((e,t)=>(0,s.kX)(e.date).getTime()-(0,s.kX)(t.date).getTime())),n=n.slice(0,6);let l=[];return n.forEach((r=>{let i=r.id;delete r.id,l.push({...r,ref:[...e.split("/"),i].join("~"),date:(0,s.kX)(r.date),color:t.color,class_id:[o,a].join("/"),class_name:this.class_text(t)})})),s.Cw.log("üìö Got upcoming tasks"),Promise.resolve(l)}catch(o){return Promise.reject(o)}},show_timeout(){s.Cw.log("üïí Showing timeout"+(this.account_doc?.prefs?.hide_timeout?" | Hidden locally due to prefs":"")),this.paused=!0},hide_timeout(){this.paused&&(this.account_doc?.prefs?.hide_timeout||s.Cw.log("üïí Hiding timeout"),this.paused=!1)}}})},962:function(e,t,o){"use strict";o.d(t,{F:function(){return i}});o(4603),o(7566),o(8721);var a=o(6265),s=o(3367);const r="https://api.mvtt.app/",i=(0,s.nY)({id:"magic",state:()=>({last:{},types:[{key:"note",name:"Note",list_as:"Add a Note",shortcuts:["n"]},{key:"task",name:"Assignment",list_as:"Schedule an Assignment",shortcuts:["a"]},{key:"test",name:"Test",list_as:"Schedule a Test",shortcuts:["t"]},{key:"project",name:"Project",list_as:"Schedule a Project",shortcuts:["p"]},{key:"quiz",name:"Quiz",list_as:"Schedule a Quiz",shortcuts:["q"]},{key:"exam",name:"Exam",list_as:"Schedule an Exam",shortcuts:["e"]}],prefixes:{note:"",task:"Complete ",test:"Study for ",project:"Prepare ",quiz:"Study for ",exam:"Study for "},done_prefixes:{note:"",task:"",test:"Studying for ",project:"Preparation for ",quiz:"Studying for ",exam:"Studying for "}}),getters:{},actions:{prefix(e){return this.prefixes[e.type]},done_prefix(e){return e?.type&&e.name?`${this.done_prefixes[e.type]?this.done_prefixes[e.type]+e.type:this.type_full(e.type)} "${e.name}"`:"Task"},type_full(e){return this.types.find((t=>t.key===e))?.name||e},async text(e){if(e)return await this.rated_api_get("get/magic/link-text",{path:e})},async type(e){if(e)return await this.rated_api_get("get/magic/task-type",{task:e})},async api_get(e,t){if(t=t||{},!e)return;const o=new URL(r+e);Object.keys(t).forEach((e=>o.searchParams.append(e,t[e])));const s=Math.random().toString(36).substring(7);a.Cw.log(`üõú Running API fetch | <${s}>`),this.last[e]={time:Date.now(),hash:s};try{const e=await fetch(o.href,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw"Non-valid response";const t=await e.json();return a.Cw.log(`üõú API fetch success | <${s}>`),t.data}catch(i){return a.Cw.error(`üõú API fetch failed  | <${s}>`,i),null}},async rated_api_get(e){a.Cw.log("üõú API fetch requested");const t=Math.random().toString(36).substring(7),o=this.last[e]?.time,s=this.last[e]?.hash;if(Date.now()-o<2e3){if(a.Cw.warn("üõú API fetch rate limited"),await new Promise((e=>setTimeout(e,15e3))),this.last[e]?.time!==o||this.last[e]?.hash!==s)return void a.Cw.warn("üõú Outdated API fetch skipped");a.Cw.log("üõú API fetch rate limit lifted")}return await this.api_get(...arguments,t)}}})},7251:function(e,t,o){"use strict";o.d(t,{A:function(){return b}});var a=o(6768),s=o(4232);const r=e=>((0,a.Qi)("data-v-793cb3ff"),e=e(),(0,a.jt)(),e),i={class:"modal",ref:"modal"},n={key:0,class:"modal_header",ref:"title"},l={class:"header_style modal_header_title"},c={key:1,ref:"contents",class:"overlay_contents"},d=["innerHTML"],u={class:"bottom_actions"},h={key:1,class:"progress_display"},_=["onClick"],m=r((()=>(0,a.Lk)("div",{class:"flex_spacer"},null,-1))),p=["disabled"];function f(e,t,o,r,f,g){return(0,a.uX)(),(0,a.CE)("main",i,[o.title?((0,a.uX)(),(0,a.CE)("header",n,[(0,a.Lk)("h2",l,(0,s.v_)(o.title),1)],512)):(0,a.Q3)("",!0),o.content||o.html?((0,a.uX)(),(0,a.CE)("div",c,[((0,a.uX)(),(0,a.Wv)((0,a.$y)(o.content),{ref:"container",onUpdate:t[0]||(t[0]=t=>e.$emit("update",t)),onStatus:t[1]||(t[1]=t=>e.$emit("status",t)),onSkip:t[2]||(t[2]=t=>e.$emit("skip")),load:o.load},null,40,["load"])),o.html?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"overlay_contents__html",innerHTML:o.html},null,8,d)):(0,a.Q3)("",!0)],512)):(0,a.Q3)("",!0),(0,a.Lk)("div",u,[o.skippable?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"close_action click_escape",onClick:t[3]||(t[3]=t=>e.$emit("skip"))},(0,s.v_)(o.skip_text||(o.progress&&o.progress.current>1?"Abandon":"Close")),1)):(0,a.Q3)("",!0),o.progress&&o.progress.total>1?((0,a.uX)(),(0,a.CE)("div",h,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.progress.total,(t=>((0,a.uX)(),(0,a.CE)("span",{class:"progress_display__dot_container",key:t,onClick:o=>e.$emit("open",t-1)},[(0,a.Lk)("span",{class:(0,s.C4)(["progress_display__dot",{dot_active:t==o.progress.current,dot_finished:t<o.progress.current}])},null,2)],8,_)))),128))])):(0,a.Q3)("",!0),m,(0,a.Lk)("button",{class:"continue_action click_ctrlenter",onClick:t[4]||(t[4]=(...e)=>o.continue_action&&o.continue_action(...e)),disabled:!o.can_continue},(0,s.v_)(g.button_text),9,p)])],512)}o(4114);var g=o(6471),k=o.n(g),w={name:"ModalVue",mixins:[k()],mounted(){this.$smoothReflow({el:this.$refs.contents,hideOverflow:!0,childTransitions:!0}),this.$smoothReflow({el:this.$refs.title,hideOverflow:!0})},emits:["open","update","status","skip"],data(){return{}},props:{load:{type:Object,default:()=>({})},skippable:{type:Boolean,default:!1,required:!1},title:{type:String,default:"",required:!1},content:{type:Object,default:null,required:!1},html:{type:String,default:null,required:!1},can_continue:{type:Boolean,required:!0},continue_action:{type:Function,default:()=>{(void 0).$status.log("‚èµ ModalVue: continue_action not provided"),window.onbeforeunload=null,(void 0).$router.push((void 0).$route.query.redirect||{name:"portal",query:(void 0).$route.query})},required:!1},progress:{type:Object,default:null,required:!1},is_notification:{type:Boolean,default:!1,required:!1},submit_text:{type:String,required:!1},skip_text:{type:String,required:!1}},computed:{button_text(){return this.submit_text?this.submit_text:this.is_notification?"Ok":this.progress&&this.progress.current==this.progress.total?"Finish":"Continue"}}},v=o(1241);const y=(0,v.A)(w,[["render",f],["__scopeId","data-v-793cb3ff"]]);var b=y},9685:function(e,t,o){"use strict";o.d(t,{A:function(){return d}});var a=o(6768),s=o(4232);const r=["closable"];function i(e,t,o,i,n,l){return(0,a.uX)(),(0,a.CE)("div",{class:(0,s.C4)(["overlay overlay_center_view overlay_slot__wrapper",{animate_out:n.animating_out}])},[(0,a.Lk)("div",{class:"overlay_close",onClick:t[0]||(t[0]=e=>l.closable?l.close():null),closable:l.closable},null,8,r),o.component?((0,a.uX)(),(0,a.Wv)((0,a.$y)(o.component),{key:0,class:"overlay_slot",onClose:l.close},null,40,["onClose"])):(0,a.RG)(e.$slots,"default",{key:1,class:"overlay_slot",close:l.close})],2)}var n={name:"OverlayWrapper",emits:["close"],props:{component:{type:Object,default:null}},data(){return{animating_out:!1}},computed:{closable(){return!0!==this.$route?.meta?.block_close}},methods:{close(){this.animating_out=!0,setTimeout((()=>{window.onbeforeunload=null,this.$emit("close"),this.animating_out=!1}),250)}}},l=o(1241);const c=(0,l.A)(n,[["render",i]]);var d=c},7620:function(e,t,o){"use strict";e.exports=o.p+"img/connection-error.a3350cd0.svg"},1087:function(e,t,o){"use strict";e.exports=o.p+"img/connection-success.c29d81cf.svg"},3662:function(e,t,o){"use strict";e.exports=o.p+"img/connection-warn.99f5cb05.svg"},477:function(){},2634:function(){}},t={};function o(a){var s=t[a];if(void 0!==s)return s.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,a,s,r){if(!a){var i=1/0;for(d=0;d<e.length;d++){a=e[d][0],s=e[d][1],r=e[d][2];for(var n=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(o.O).every((function(e){return o.O[e](a[l])}))?a.splice(l--,1):(n=!1,r<i&&(i=r));if(n){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,s,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,a){return o.f[a](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/"+e+"."+{21:"a5c728d7",25:"c579e647",59:"84456203",75:"075bf7b6",101:"38fe67d3",143:"5543d0ff",170:"391d141b",173:"6425fa45",178:"edd0b1e9",230:"29a5f131",233:"4891a359",255:"46268019",260:"5f2c264a",277:"f30ec836",280:"a1367c42",326:"60359db8",420:"7473b860",491:"7e0bcff0",501:"2955476b",503:"8b19d3ce",538:"6b497436",582:"a4b3701b",583:"54d0e39f",651:"cd5ea023",658:"78f98164",661:"0638886c",663:"6d0f52d0",812:"a20b7679",860:"d3036ebe",883:"3de4f32b",892:"54ae712c",938:"6eae06b9",948:"e666c0a6",960:"2088e04e",984:"e0afb4e2"}[e]+".js"}}(),function(){o.miniCssF=function(e){return"css/"+e+"."+{21:"d576e19c",25:"c75d4dee",59:"ef72487f",75:"fc1cc063",101:"9e20b7b5",170:"d9c24380",173:"328c80e9",178:"393d89d9",230:"e873138f",233:"97310356",260:"5cdab7df",277:"e7cd22dc",280:"0e59c6ca",326:"73525aed",420:"3d7b288d",501:"5ad27c67",503:"2402cdda",538:"742e3057",582:"fb57c3bd",583:"ca8b15ce",651:"834c139e",658:"2575b215",661:"56bd4e99",663:"cbb005e9",812:"75a97a72",860:"61dcd1ec",892:"383763c1",938:"2b0d65a8",948:"94b9ff58",960:"76b29f15",984:"317ccfc2"}[e]+".css"}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="mvtime:";o.l=function(a,s,r,i){if(e[a])e[a].push(s);else{var n,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+r){n=u;break}}n||(l=!0,n=document.createElement("script"),n.charset="utf-8",n.timeout=120,o.nc&&n.setAttribute("nonce",o.nc),n.setAttribute("data-webpack",t+r),n.src=a),e[a]=[s];var h=function(t,o){n.onerror=n.onload=null,clearTimeout(_);var s=e[a];if(delete e[a],n.parentNode&&n.parentNode.removeChild(n),s&&s.forEach((function(e){return e(o)})),t)return t(o)},_=setTimeout(h.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=h.bind(null,n.onerror),n.onload=h.bind(null,n.onload),l&&document.head.appendChild(n)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,a,s,r){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",o.nc&&(i.nonce=o.nc);var n=function(o){if(i.onerror=i.onload=null,"load"===o.type)s();else{var a=o&&o.type,n=o&&o.target&&o.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+a+": "+n+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=a,l.request=n,i.parentNode&&i.parentNode.removeChild(i),r(l)}};return i.onerror=i.onload=n,i.href=t,a?a.parentNode.insertBefore(i,a.nextSibling):document.head.appendChild(i),i},t=function(e,t){for(var o=document.getElementsByTagName("link"),a=0;a<o.length;a++){var s=o[a],r=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(r===e||r===t))return s}var i=document.getElementsByTagName("style");for(a=0;a<i.length;a++){s=i[a],r=s.getAttribute("data-href");if(r===e||r===t)return s}},a=function(a){return new Promise((function(s,r){var i=o.miniCssF(a),n=o.p+i;if(t(i,n))return s();e(a,n,null,s,r)}))},s={524:0};o.f.miniCss=function(e,t){var o={21:1,25:1,59:1,75:1,101:1,170:1,173:1,178:1,230:1,233:1,260:1,277:1,280:1,326:1,420:1,501:1,503:1,538:1,582:1,583:1,651:1,658:1,661:1,663:1,812:1,860:1,892:1,938:1,948:1,960:1,984:1};s[e]?t.push(s[e]):0!==s[e]&&o[e]&&t.push(s[e]=a(e).then((function(){s[e]=0}),(function(t){throw delete s[e],t})))}}}(),function(){var e={524:0};o.f.j=function(t,a){var s=o.o(e,t)?e[t]:void 0;if(0!==s)if(s)a.push(s[2]);else{var r=new Promise((function(o,a){s=e[t]=[o,a]}));a.push(s[2]=r);var i=o.p+o.u(t),n=new Error,l=function(a){if(o.o(e,t)&&(s=e[t],0!==s&&(e[t]=void 0),s)){var r=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;n.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",n.name="ChunkLoadError",n.type=r,n.request=i,s[1](n)}};o.l(i,l,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,r,i=a[0],n=a[1],l=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(s in n)o.o(n,s)&&(o.m[s]=n[s]);if(l)var d=l(o)}for(t&&t(a);c<i.length;c++)r=i[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(d)},a=self["webpackChunkmvtime"]=self["webpackChunkmvtime"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[504],(function(){return o(8988)}));a=o.O(a)})();
//# sourceMappingURL=app.b4cb36ad.js.map