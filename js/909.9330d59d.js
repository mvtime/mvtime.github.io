"use strict";(self["webpackChunkmvtime"]=self["webpackChunkmvtime"]||[]).push([[909],{7909:function(e,t,a){a.r(t),a.d(t,{default:function(){return ve}});var s=a(6768),l=a(4232);const i=e=>((0,s.Qi)("data-v-5430b10a"),e=e(),(0,s.jt)(),e),_=["page"],m={key:0,class:"msg_choose"},n=["onClick"],c={key:1,class:"msg_page_wrapper"},g={key:0,class:"msg_page_info admin_in",style:{animationDelay:"0.1s"}},p=i((()=>(0,s.Lk)("div",{class:"msg_page__back__icon themed_icon"},null,-1))),o=[p],d={class:"msg_page_info__text"},v=i((()=>(0,s.Lk)("hr",{class:"msg_page_wrapper__separator admin_in",style:{animationDelay:3*.05+"s"}},null,-1))),r={class:"msg_page_container admin_in",style:{animationDelay:"0.2s"}},u={key:0,class:"msg_page msg__view"},k={class:"msg_page_list msg__view_list"},h={class:"msg_page_list_header msg__view_list_header"},y=i((()=>(0,s.Lk)("th",{style:{flex:"1 4 7em"}},"Recepient",-1))),C=i((()=>(0,s.Lk)("th",{style:{flex:"1 1 10em"}},"Template",-1))),w=i((()=>(0,s.Lk)("th",{style:{flex:"4 3 15em"}},"Subject",-1))),L=i((()=>(0,s.Lk)("th",{style:{flex:"1 1 5em"}},"Date",-1))),f={style:{flex:"1 4 7em"}},E={class:"msg__view_to"},X=["title"],b=["title"],x={style:{flex:"1 1 10em"}},$={style:{flex:"4 3 15em"}},Q={style:{flex:"1 1 5em"}},T={key:0,class:"msg_page_list_item_content msg_view_preview"},j=i((()=>(0,s.Lk)("div",{class:"msg_view_preview__json"},null,-1))),D=[j],F=["onClick"],K=["title"],M={key:0,class:"msg_page_list_item__empty admin_in",style:{animationDelay:"0.26s"}},A=i((()=>(0,s.Lk)("span",null,"No sent messages exist yet",-1))),I=[A],S=i((()=>(0,s.Lk)("div",{class:"part_loading_animation msg_page_list_item_loading_button"},null,-1))),q=[S],H={key:1,class:"msg_page msg__send"},N={key:2,class:"msg_page msg__templates"},O={class:"msg_page_list msg__templates_list"},B={class:"msg_page_list_header msg__templates_list_header"},R=i((()=>(0,s.Lk)("th",{style:{flex:"0 1 10em"}},"Template",-1))),V=i((()=>(0,s.Lk)("th",{style:{flex:"1 4 20em"}},"Subject",-1))),z=i((()=>(0,s.Lk)("th",{style:{flex:"4 10 20em"}},"Text",-1))),G={style:{flex:"1 1 10em"}},J={style:{flex:"2 4 20em"}},P={style:{flex:"8 10 20em"}},U={key:0,class:"msg_page_list_item_content msg_templates_preview"},W=["innerHTML"],Y={key:1,class:"msg_page_list_item_content msg_templates_preview"},Z=["innerHTML"],ee=["onClick"],te=["title"],ae={key:0,class:"msg_page_list_item__empty admin_in",style:{animationDelay:"0.26s"}},se=i((()=>(0,s.Lk)("span",null,"No templates exist yet",-1))),le=[se],ie=i((()=>(0,s.Lk)("div",{class:"part_loading_animation msg_page_list_item_loading_button"},null,-1))),_e=[ie];function me(e,t,a,i,p,j){return(0,s.uX)(),(0,s.CE)("div",{class:"messagesalerts",page:p.page},["choose"==p.page?((0,s.uX)(),(0,s.CE)("div",m,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.choices,((e,t,a)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,l.C4)(`msg_choose_page msg_choose__${t} admin_in`),key:t,onClick:e=>p.page=t,style:(0,l.Tr)({animationDelay:.05*(a+2)+"s"})},(0,l.v_)(e.name),15,n)))),128))])):((0,s.uX)(),(0,s.CE)("div",c,["choose"!=p.page?((0,s.uX)(),(0,s.CE)("div",g,[(0,s.Lk)("button",{class:"msg_page__back",onClick:t[0]||(t[0]=e=>p.page="choose")},o),(0,s.Lk)("div",d,(0,l.v_)(p.choices[p.page].active),1)])):(0,s.Q3)("",!0),v,(0,s.Lk)("div",r,["view"==p.page?((0,s.uX)(),(0,s.CE)("div",u,[(0,s.Lk)("table",k,[(0,s.Lk)("tr",h,[y,p.data.view.active?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[C,w,L],64))]),p.data.view.loading?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(j.placeholder(3),(e=>((0,s.uX)(),(0,s.CE)("tr",{class:"msg_page_list_item msg_page_list_item_loading msg__view_list_item part_loading_animation",key:e},q)))),128)):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.data.view.list,((e,t,a)=>((0,s.uX)(),(0,s.CE)("tr",{class:(0,l.C4)(["msg_page_list_item msg__view_list_item admin_in",{active:p.data.view.active==t}]),key:t,style:(0,l.Tr)({animationDelay:.03*(a+2)+.2+"s"})},[(0,s.Lk)("td",f,[(0,s.Lk)("span",E,(0,l.v_)(e.to),1),e.cc?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"msg__view_cc",title:`CC: ${Array.isArray(e.cc)?e.cc.join(", "):e.cc}`}," +cc",8,X)):(0,s.Q3)("",!0),e.bcc?((0,s.uX)(),(0,s.CE)("span",{key:1,class:"msg__view_bcc",title:`BCC: ${Array.isArray(e.cc)?e.bcc.join(", "):e.bcc}`}," +bcc",8,b)):(0,s.Q3)("",!0)]),(0,s.Lk)("td",x,(0,l.v_)(e.template),1),(0,s.Lk)("td",$,(0,l.v_)(e.subject),1),(0,s.Lk)("td",Q,(0,l.v_)(e.date),1),p.data.view.active==t?((0,s.uX)(),(0,s.CE)("div",T,D)):(0,s.Q3)("",!0),(0,s.Lk)("button",{class:(0,l.C4)(["msg__view_list_item__toggle msg_list_item__toggle",{click_escape:p.data.view.active==t}]),onClick:e=>p.data.view.active=p.data.view.active==t?null:t,title:"Close email data"},[(0,s.Lk)("div",{class:"msg_list_item__toggle__icon themed_icon",title:`${p.data.view.active==t?"Collapse":"Expand"} preview of ${t}`},null,8,K)],10,F)],6)))),128)),Object.keys(p.data.view.list).length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("tr",M,I))],64))])])):"send"==p.page?((0,s.uX)(),(0,s.CE)("div",H)):"templates"==p.page?((0,s.uX)(),(0,s.CE)("div",N,[(0,s.Lk)("table",O,[(0,s.Lk)("tr",B,[R,p.data.view.active?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[V,z],64))]),p.data.templates.loading?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(j.placeholder(8),(e=>((0,s.uX)(),(0,s.CE)("tr",{class:"msg_page_list_item msg_page_list_item_loading msg__templates_list_item part_loading_animation",key:e},_e)))),128)):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.data.templates.list,((e,t,a)=>((0,s.uX)(),(0,s.CE)("tr",{class:(0,l.C4)(["msg_page_list_item msg__templates_list_item admin_in",{active:p.data.templates.active==t}]),key:t,style:(0,l.Tr)({animationDelay:.03*(a+2)+.2+"s"})},[(0,s.Lk)("td",G,(0,l.v_)(t),1),(0,s.Lk)("td",J,(0,l.v_)(e.subject),1),(0,s.Lk)("td",P,(0,l.v_)(e.text),1),p.data.templates.active==t?((0,s.uX)(),(0,s.CE)("div",U,[(0,s.Lk)("div",{class:"msg_templates_preview__html",innerHTML:e.html},null,8,W)])):(0,s.Q3)("",!0),p.data.templates.active==t?((0,s.uX)(),(0,s.CE)("div",Y,[(0,s.Lk)("div",{class:"msg_templates_preview__text",innerHTML:e.text.replace(/\\n/g,"<br/>")},null,8,Z)])):(0,s.Q3)("",!0),(0,s.Lk)("button",{class:(0,l.C4)(["msg__templates_list_item__toggle msg_list_item__toggle",{click_escape:p.data.templates.active==t}]),onClick:e=>p.data.templates.active=p.data.templates.active==t?null:t,title:"Close email contents preview"},[(0,s.Lk)("div",{class:"msg_list_item__toggle__icon themed_icon",title:`${p.data.templates.active==t?"Collapse":"Expand"} preview of ${t}`},null,8,te)],10,ee)],6)))),128)),Object.keys(p.data.templates.list).length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("tr",ae,le))],64))])])):(0,s.Q3)("",!0)])]))],8,_)}a(4114);var ne=a(6669),ce=a(9218),ge=a(4186),pe={name:"MessagesAlerts",data(){return{page:"choose",choices:{view:{name:"View Sent",active:"Sent Messages"},send:{name:"Send New",active:"Create Message"},templates:{name:"Templates",active:"Message Templates"}},data:{view:{list:[],loading:!0,active:null,placeholder:this.placeholder(3)},templates:{list:{},loading:!0,active:null,placeholder:this.placeholder(8)}}}},methods:{async fetch_templates(){this.data.templates.list={},this.data.templates.loading=!0;const e=(0,ce.Qg)(ne.Cn,"getTemplates"),t=Date.now(),{data:a,error:s}=await e(),l=Date.now()-t;if(s)return this.$status.error(`📃 Failed to fetch templates after ${l}ms`,s),void new ge.Qp("Something went wrong loading the templates",s,2500);{const e=Object.keys(a||{}).length;this.$status.log(`📃 Fetched ${e} template${1==e?"":"s"} in ${l}ms`),this.data.templates.list=a||{},this.data.templates.loading=!1}},placeholder(e){return Array.from({length:e},((e,t)=>t))}},mounted(){this.$route?.query?.action&&(this.page=this.$route.query.action)},watch:{page(){this.$router.push({query:{...this.$route.query,action:"choose"==this.page?void 0:this.page}}),"templates"==this.page&&this.data.templates.loading&&this.fetch_templates(),this.data.templates.active=null,this.data.view.active=null}}},oe=a(1241);const de=(0,oe.A)(pe,[["render",me],["__scopeId","data-v-5430b10a"]]);var ve=de}}]);
//# sourceMappingURL=909.9330d59d.js.map