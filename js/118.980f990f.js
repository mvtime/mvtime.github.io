"use strict";(self["webpackChunkmvtime"]=self["webpackChunkmvtime"]||[]).push([[118],{8118:function(e,t,a){a.r(t),a.d(t,{default:function(){return pe}});var s=a(6768),i=a(4232);const l=e=>((0,s.Qi)("data-v-693629eb"),e=e(),(0,s.jt)(),e),_=["page"],n={key:0,class:"msg_choose"},m=["onClick","disabled"],c={key:1,class:"msg_page_wrapper"},g={key:0,class:"msg_page_info admin_in",style:{animationDelay:"0.1s"}},o=l((()=>(0,s.Lk)("div",{class:"msg_page__back__icon themed_icon"},null,-1))),d=[o],p={class:"msg_page_info__text"},r=l((()=>(0,s.Lk)("hr",{class:"msg_page_wrapper__separator admin_in",style:{animationDelay:3*.05+"s"}},null,-1))),v={class:"msg_page_container admin_in",style:{animationDelay:"0.2s"}},u={key:0,class:"msg_page msg__view"},h={class:"msg_page_list msg__view_list"},y={class:"msg_page_list_header msg__view_list_header"},k=l((()=>(0,s.Lk)("th",{style:{flex:"1 2 6em","min-width":"6em"}},"Recepient",-1))),w=l((()=>(0,s.Lk)("th",{class:"msg__nomobile",style:{flex:"1 1 6em"}},"Template",-1))),C=l((()=>(0,s.Lk)("th",{style:{flex:"2 1 6.5em"}},"Date",-1))),f=l((()=>(0,s.Lk)("th",{style:{flex:"0 0 5em"}},"Status",-1))),L={style:{flex:"1 2 6em","min-width":"6em"}},b=["title"],E=["title"],X=["title"],$={class:"msg__nomobile",style:{flex:"1 1 6em"}},x={style:{flex:"2 1 6.5em"}},Q={style:{flex:"0 0 5em"}},T={key:0,class:"msg_page_list_item_content msg_view_preview"},D={class:"msg_view_preview__json"},F=["onClick"],A=["title"],j={key:0,class:"msg_page_list_item__empty admin_in",style:{animationDelay:"0.26s"}},S=l((()=>(0,s.Lk)("span",null,"No sent messages exist yet",-1))),K=[S],M=l((()=>(0,s.Lk)("div",{class:"part_loading_animation msg_page_list_item_loading_button"},null,-1))),N=[M],I={key:1,class:"msg_page msg__send"},O={key:2,class:"msg_page msg__templates"},q={class:"msg_page_list msg__templates_list"},H={class:"msg_page_list_header msg__templates_list_header"},B=l((()=>(0,s.Lk)("th",{style:{flex:"0 1 10em"}},"Template",-1))),J=l((()=>(0,s.Lk)("th",{style:{flex:"1 4 20em"}},"Subject",-1))),R=l((()=>(0,s.Lk)("th",{class:"msg__nomobile",style:{flex:"4 10 20em"}},"Text",-1))),U={style:{flex:"1 1 10em"}},V={style:{flex:"2 4 20em"}},z={class:"msg__nomobile",style:{flex:"8 10 20em"}},G={key:0,class:"msg_page_list_item_content msg_templates_preview"},P=["innerHTML"],W={key:1,class:"msg_page_list_item_content msg_templates_preview"},Y=["innerHTML"],Z=["onClick"],ee=["title"],te={key:0,class:"msg_page_list_item__empty admin_in",style:{animationDelay:"0.26s"}},ae=l((()=>(0,s.Lk)("span",null,"No templates exist yet",-1))),se=[ae],ie=l((()=>(0,s.Lk)("div",{class:"part_loading_animation msg_page_list_item_loading_button"},null,-1))),le=[ie];function _e(e,t,a,l,o,S){return(0,s.uX)(),(0,s.CE)("div",{class:"messagesalerts",page:o.page},["choose"==o.page?((0,s.uX)(),(0,s.CE)("div",n,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.choices,((e,t,a)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,i.C4)(`msg_choose_page msg_choose__${t} admin_in`),key:t,onClick:a=>{e.disabled||(o.page=t)},style:(0,i.Tr)({animationDelay:.05*(a+2)+"s"}),disabled:e.disabled},(0,i.v_)(e.name),15,m)))),128))])):((0,s.uX)(),(0,s.CE)("div",c,["choose"!=o.page?((0,s.uX)(),(0,s.CE)("div",g,[(0,s.Lk)("button",{class:"msg_page__back",onClick:t[0]||(t[0]=e=>o.page="choose")},d),(0,s.Lk)("div",p,(0,i.v_)(o.choices[o.page].active),1)])):(0,s.Q3)("",!0),r,(0,s.Lk)("div",v,["view"==o.page?((0,s.uX)(),(0,s.CE)("div",u,[(0,s.Lk)("table",h,[(0,s.Lk)("tr",y,[k,o.data.view.active?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[w,C,f],64))]),o.data.view.loading?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(S.placeholder(3),(e=>((0,s.uX)(),(0,s.CE)("tr",{class:"msg_page_list_item msg_page_list_item_loading msg__view_list_item part_loading_animation",key:e},N)))),128)):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.data.view.list,((e,t,a)=>((0,s.uX)(),(0,s.CE)("tr",{class:(0,i.C4)(["msg_page_list_item msg__view_list_item admin_in",{active:o.data.view.active==t}]),key:t,style:(0,i.Tr)({animationDelay:.03*(a+2)+.2+"s"})},[(0,s.Lk)("td",L,[e.to?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"msg__view_to",title:`TO: ${Array.isArray(e.to)?e.to.join(", ")||"empty":e.to}`},(0,i.v_)(Array.isArray(e.to)?e.to.length+" emails":e.to.split("@")[0])+" ",9,b)):(0,s.Q3)("",!0),e.cc?((0,s.uX)(),(0,s.CE)("span",{key:1,class:"msg__view_cc",title:`CC: ${Array.isArray(e.cc)?e.cc.join(", ")||"empty":e.cc}`},"[cc] ",8,E)):(0,s.Q3)("",!0),e.bcc?((0,s.uX)(),(0,s.CE)("span",{key:2,class:"msg__view_bcc",title:`BCC: ${Array.isArray(e.cc)?e.bcc.join(", ")||"empty":e.bcc}`},"[bcc]",8,X)):(0,s.Q3)("",!0)]),(0,s.Lk)("td",$,(0,i.v_)(e.template&&e.template.name),1),(0,s.Lk)("td",x,(0,i.v_)(S.date_of(e)),1),(0,s.Lk)("td",Q,(0,i.v_)(S.status_of(e)),1),o.data.view.active==t?((0,s.uX)(),(0,s.CE)("div",T,[(0,s.Lk)("div",D,[(0,s.Lk)("pre",null,(0,i.v_)(JSON.stringify(e,null,2)),1)])])):(0,s.Q3)("",!0),(0,s.Lk)("button",{class:(0,i.C4)(["msg__view_list_item__toggle msg_list_item__toggle",{click_escape:o.data.view.active==t}]),onClick:e=>o.data.view.active=o.data.view.active==t?null:t,title:"Close email data"},[(0,s.Lk)("div",{class:"msg_list_item__toggle__icon themed_icon",title:`${o.data.view.active==t?"Collapse":"Expand"} preview of ${t}`},null,8,A)],10,F)],6)))),128)),Object.keys(o.data.view.list).length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("tr",j,K))],64))])])):"send"==o.page?((0,s.uX)(),(0,s.CE)("div",I)):"templates"==o.page?((0,s.uX)(),(0,s.CE)("div",O,[(0,s.Lk)("table",q,[(0,s.Lk)("tr",H,[B,o.data.view.active?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[J,R],64))]),o.data.templates.loading?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(S.placeholder(8),(e=>((0,s.uX)(),(0,s.CE)("tr",{class:"msg_page_list_item msg_page_list_item_loading msg__templates_list_item part_loading_animation",key:e},le)))),128)):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.data.templates.list,((e,t,a)=>((0,s.uX)(),(0,s.CE)("tr",{class:(0,i.C4)(["msg_page_list_item msg__templates_list_item admin_in",{active:o.data.templates.active==t}]),key:t,style:(0,i.Tr)({animationDelay:.03*(a+2)+.2+"s"})},[(0,s.Lk)("td",U,(0,i.v_)(t),1),(0,s.Lk)("td",V,(0,i.v_)(e.subject),1),(0,s.Lk)("td",z,(0,i.v_)(e.text),1),o.data.templates.active==t?((0,s.uX)(),(0,s.CE)("div",G,[(0,s.Lk)("div",{class:"msg_templates_preview__html",innerHTML:e.html},null,8,P)])):(0,s.Q3)("",!0),o.data.templates.active==t?((0,s.uX)(),(0,s.CE)("div",W,[(0,s.Lk)("div",{class:"msg_templates_preview__text",innerHTML:e.text.replace(/\\n/g,"<br/>")},null,8,Y)])):(0,s.Q3)("",!0),(0,s.Lk)("button",{class:(0,i.C4)(["msg__templates_list_item__toggle msg_list_item__toggle",{click_escape:o.data.templates.active==t}]),onClick:e=>o.data.templates.active=o.data.templates.active==t?null:t,title:"Close email contents preview"},[(0,s.Lk)("div",{class:"msg_list_item__toggle__icon themed_icon",title:`${o.data.templates.active==t?"Collapse":"Expand"} preview of ${t}`},null,8,ee)],10,Z)],6)))),128)),Object.keys(o.data.templates.list).length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("tr",te,se))],64))])])):(0,s.Q3)("",!0)])]))],8,_)}a(4114);var ne=a(6669),me=a(9218),ce=a(4186),ge={name:"MessagesAlerts",data(){return{page:"choose",choices:{view:{name:"View Sent",active:"Sent Messages"},send:{name:"Send New",active:"Create Message",disabled:!0},templates:{name:"Templates",active:"Message Templates"}},data:{view:{list:{},loading:!0,active:null,placeholder:this.placeholder(3)},templates:{list:{},loading:!0,active:null,placeholder:this.placeholder(8)}}}},methods:{async fetch_templates(){this.data.templates.list={},this.data.templates.loading=!0;const e=(0,me.Qg)(ne.Cn,"getTemplates"),t=Date.now(),{data:a,error:s}=await e(),i=Date.now()-t;if(s)return this.$status.error(`📃 Failed to fetch templates after ${i}ms`,s),void new ce.Qp("Something went wrong loading the templates",s,2500);{const e=Object.keys(a||{}).length;this.$status.log(`📃 Fetched ${e} template${1==e?"":"s"} in ${i}ms`),this.data.templates.list=a||{},this.data.templates.loading=!1}},async fetch_messages(){this.data.view.list={},this.data.view.loading=!0;const e=(0,me.Qg)(ne.Cn,"getSentMessages"),t=Date.now(),{data:a,error:s}=await e(),i=Date.now()-t;if(s)return this.$status.error(`📃 Failed to fetch messages after ${i}ms`,s),void new ce.Qp("Something went wrong loading sent messages",s,2500);{const e=Object.keys(a||{}).length;this.$status.log(`📃 Fetched ${e} messages${1==e?"":"s"} in ${i}ms`),this.data.view.list=a||{},this.data.view.loading=!1}},placeholder(e){return Array.from({length:e},((e,t)=>t))},date_of(e){const t=1e3*(e?.delivery?.startTime?._seconds+e?.delivery?.startTime?._nanoseconds/1e9),a=new Date(t);return isNaN(a.getTime())?"Unknown":a.toLocaleDateString()},status_of(e){return e?.delivery?.state||"N/A"}},mounted(){this.$route?.query?.action&&(this.page=this.$route.query.action)},watch:{page(){this.$router.push({query:{...this.$route.query,action:"choose"==this.page?void 0:this.page}}),"templates"==this.page&&this.data.templates.loading?this.fetch_templates():"view"==this.page&&this.data.view.loading&&this.fetch_messages(),this.data.templates.active=null,this.data.view.active=null}}},oe=a(1241);const de=(0,oe.A)(ge,[["render",_e],["__scopeId","data-v-693629eb"]]);var pe=de}}]);
//# sourceMappingURL=118.980f990f.js.map