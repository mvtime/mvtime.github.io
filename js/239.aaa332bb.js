"use strict";(self["webpackChunkmvtime"]=self["webpackChunkmvtime"]||[]).push([[239],{4027:function(e,t,a){a.d(t,{A:function(){return g}});var s=a(6768),l=a(4232);const i=e=>((0,s.Qi)("data-v-521703de"),e=e(),(0,s.jt)(),e),n=["disabled"],d=i((()=>(0,s.Lk)("span",{class:"loading_bg"},null,-1))),_=[d],m=i((()=>(0,s.Lk)("div",{class:"toggle_switch_knob"},null,-1)));function o(e,t,a,i,d,o){return(0,s.uX)(),(0,s.CE)("div",{class:(0,l.C4)(["toggle_switch",{toggle_switch__on:d.is_on,transition:!a.loads}]),disabled:a.disabled,onClick:t[0]||(t[0]=(...e)=>o.toggle&&o.toggle(...e))},[a.loads?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,l.C4)(["toggle_switch__loading",{is_loading:d.loading}])},_,2)):(0,s.Q3)("",!0),m],10,n)}var c={name:"ToggleBar",props:{value:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loads:{type:Boolean,default:!1}},emits:["update"],data(){return{is_on:this.value,loading:!1}},watch:{value(){this.is_on=this.value,this.loading=!1}},methods:{toggle(){this.disabled||(this.loads?this.loading=!0:this.is_on=!this.is_on,this.$emit("update",!this.is_on))}}},r=a(1241);const p=(0,r.A)(c,[["render",o],["__scopeId","data-v-521703de"]]);var g=p},1620:function(e,t,a){a.r(t),a.d(t,{default:function(){return Ge}});var s=a(6768),l=a(4232),i=a(5130);const n=e=>((0,s.Qi)("data-v-20c7a614"),e=e(),(0,s.jt)(),e),d=["page"],_={key:0,class:"msg_choose"},m=["onClick","disabled"],o={key:1,class:"msg_page_wrapper"},c={key:0,class:"msg_page_info admin_in",style:{animationDelay:"0.1s"}},r=n((()=>(0,s.Lk)("div",{class:"msg_page__back__icon themed_icon"},null,-1))),p=[r],g={class:"msg_page_info__text"},u=n((()=>(0,s.Lk)("hr",{class:"msg_page_wrapper__separator admin_in",style:{animationDelay:3*.05+"s"}},null,-1))),h={class:"msg_page_container admin_in",style:{animationDelay:"0.2s"}},v={key:0,class:"msg_page msg__view"},k={class:"msg_page_list msg__view_list"},y={class:"msg_page_list_header msg__view_list_header"},w=n((()=>(0,s.Lk)("th",{style:{flex:"1 2 6em","min-width":"6em"}},"Recepient",-1))),f=n((()=>(0,s.Lk)("th",{class:"msg__nomobile",style:{flex:"1 1 6em"}},"Template",-1))),b=n((()=>(0,s.Lk)("th",{style:{flex:"2 1 6.5em"}},"Date",-1))),L=n((()=>(0,s.Lk)("th",{style:{flex:"0 0 5em"}},"Status",-1))),C={style:{flex:"1 2 6em","min-width":"6em"}},E=["title"],x=["title"],X=["title"],$={class:"msg__nomobile",style:{flex:"1 1 6em"}},T={style:{flex:"2 1 6.5em"}},S={style:{flex:"0 0 5em"}},A={key:0,class:"msg_page_list_item_content msg_view_preview"},Q={class:"msg_view_preview__json"},N=["onClick"],j=["title"],D={key:0,class:"msg_page_list_item__empty admin_in",style:{animationDelay:"0.26s"}},M=n((()=>(0,s.Lk)("span",null,"No sent messages exist yet",-1))),F=[M],J=n((()=>(0,s.Lk)("div",{class:"part_loading_animation msg_page_list_item_loading_button"},null,-1))),O=[J],U={key:1,class:"msg_page msg__send"},V={class:"msg__send_form"},B={class:"msg__send_form_item"},H={class:"msg__send_form_item msg__send_form_pair"},I=n((()=>(0,s.Lk)("label",{for:"msg__send_to"},"To:",-1))),K={class:"msg__send_form_item msg__send_form_pair"},q=n((()=>(0,s.Lk)("label",{for:"msg__send_cc"},"CC:",-1))),P={class:"msg__send_form_item msg__send_form_pair"},R=n((()=>(0,s.Lk)("label",{for:"msg__send_bcc"},"BCC:",-1))),W={class:"msg__send_form_item msg__send_form_pair"},G=n((()=>(0,s.Lk)("label",{for:"msg__send_from"},"From:",-1))),Y=["placeholder"],z={class:"msg__send_form_item msg__send_form_template"},Z={class:"msg__send_form_item msg__send_form_pair"},ee=n((()=>(0,s.Lk)("label",{for:"msg__send_template"},"Template:",-1))),te={value:"",disabled:"",selected:""},ae=n((()=>(0,s.Lk)("option",{value:"custom"},"[custom] - Create your own message",-1))),se=["value"],le={key:0,class:"msg__send_template_options msg__send_form_item"},ie={key:0,class:"msg__send_form_item"},ne={class:"toggle_line"},de=n((()=>(0,s.Lk)("span",null,"Display w/o Handlebars",-1))),_e={class:"toggle_line"},me=n((()=>(0,s.Lk)("span",null,"Display as raw HTML markdown",-1))),oe={class:"msg__send_form_item"},ce={class:"msg_page_list_item_content msg__send_preview"},re={key:0,class:"msg_page_list_item_content__html msg__send_preview__html msg__send_template_preview__html"},pe={key:0},ge=["innerHTML"],ue={key:1,class:"msg_page_list_item_content__html msg__send_preview__text msg__send_custom_preview__html_text"},he=["innerHTML"],ve={key:3,class:"msg_page_list_item_content__html msg__send_preview__html"},ke=n((()=>(0,s.Lk)("span",null,"Select a template to preview it here",-1))),ye=[ke],we={key:2,class:"msg_page msg__templates"},fe={class:"msg_page_list msg__templates_list"},be={class:"msg_page_list_header msg__templates_list_header"},Le=n((()=>(0,s.Lk)("th",{style:{flex:"0 1 10em"}},"Template",-1))),Ce=n((()=>(0,s.Lk)("th",{style:{flex:"1 4 20em"}},"Subject",-1))),Ee=n((()=>(0,s.Lk)("th",{class:"msg__nomobile",style:{flex:"4 10 20em"}},"Text",-1))),xe={style:{flex:"1 1 10em"}},Xe={style:{flex:"2 4 20em"}},$e={class:"msg__nomobile",style:{flex:"8 10 20em"}},Te={key:0,class:"msg_page_list_item_content msg_templates_preview"},Se=["innerHTML"],Ae={key:1,class:"msg_page_list_item_content msg_templates_preview"},Qe=["innerHTML"],Ne=["onClick"],je=["title"],De={key:0,class:"msg_page_list_item__empty admin_in",style:{animationDelay:"0.26s"}},Me=n((()=>(0,s.Lk)("span",null,"No templates exist yet",-1))),Fe=[Me],Je=n((()=>(0,s.Lk)("div",{class:"part_loading_animation msg_page_list_item_loading_button"},null,-1))),Oe=[Je];function Ue(e,t,a,n,r,M){const J=(0,s.g2)("ToggleBar");return(0,s.uX)(),(0,s.CE)("div",{class:"messagesalerts",page:r.page},["choose"==r.page?((0,s.uX)(),(0,s.CE)("div",_,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.choices,((e,t,a)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,l.C4)(`msg_choose_page msg_choose__${t} admin_in`),key:t,onClick:a=>{e.disabled||(r.page=t)},style:(0,l.Tr)({animationDelay:.05*(a+2)+"s"}),disabled:e.disabled},(0,l.v_)(e.name),15,m)))),128))])):((0,s.uX)(),(0,s.CE)("div",o,["choose"!=r.page?((0,s.uX)(),(0,s.CE)("div",c,[(0,s.Lk)("button",{class:"msg_page__back",onClick:t[0]||(t[0]=e=>r.page="choose")},p),(0,s.Lk)("div",g,(0,l.v_)(r.choices[r.page].active),1)])):(0,s.Q3)("",!0),u,(0,s.Lk)("div",h,["view"==r.page?((0,s.uX)(),(0,s.CE)("div",v,[(0,s.Lk)("table",k,[(0,s.Lk)("tr",y,[w,r.data.view.active?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[f,b,L],64))]),r.data.view.loading?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(M.placeholder(3),(e=>((0,s.uX)(),(0,s.CE)("tr",{class:"msg_page_list_item msg_page_list_item_loading msg__view_list_item part_loading_animation",key:e},O)))),128)):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.data.view.list,((e,t,a)=>((0,s.uX)(),(0,s.CE)("tr",{class:(0,l.C4)(["msg_page_list_item msg__view_list_item admin_in",{active:r.data.view.active==t}]),key:t,style:(0,l.Tr)({animationDelay:.03*(a+2)+.2+"s"})},[(0,s.Lk)("td",C,[e.to?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"msg__view_to",title:`TO: ${Array.isArray(e.to)?e.to.join(", ")||"empty":e.to}`},(0,l.v_)(Array.isArray(e.to)?e.to.length+" emails":e.to.split("@")[0])+"âŸ",9,E)):(0,s.Q3)("",!0),e.cc?((0,s.uX)(),(0,s.CE)("span",{key:1,class:"msg__view_cc",title:`CC: ${Array.isArray(e.cc)?e.cc.join(", ")||"empty":e.cc}`},"[cc]âŸ",8,x)):(0,s.Q3)("",!0),e.bcc?((0,s.uX)(),(0,s.CE)("span",{key:2,class:"msg__view_bcc",title:`BCC: ${Array.isArray(e.cc)?e.bcc.join(", ")||"empty":e.bcc}`},"[bcc]",8,X)):(0,s.Q3)("",!0)]),(0,s.Lk)("td",$,(0,l.v_)(e.template&&e.template.name),1),(0,s.Lk)("td",T,(0,l.v_)(M.date_of(e)),1),(0,s.Lk)("td",S,(0,l.v_)(M.status_of(e)),1),r.data.view.active==t?((0,s.uX)(),(0,s.CE)("div",A,[(0,s.Lk)("div",Q,[(0,s.Lk)("pre",null,(0,l.v_)(JSON.stringify(e,null,2)),1)])])):(0,s.Q3)("",!0),(0,s.Lk)("button",{class:(0,l.C4)(["msg__view_list_item__toggle msg_list_item__toggle",{click_escape:r.data.view.active==t}]),onClick:e=>r.data.view.active=r.data.view.active==t?null:t,title:"Close email data"},[(0,s.Lk)("div",{class:"msg_list_item__toggle__icon themed_icon",title:`${r.data.view.active==t?"Collapse":"Expand"} preview of ${t}`},null,8,j)],10,N)],6)))),128)),Object.keys(r.data.view.list).length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("tr",D,F))],64))])])):"send"==r.page?((0,s.uX)(),(0,s.CE)("div",U,[(0,s.Lk)("form",{onSubmit:t[15]||(t[15]=(0,i.D$)(((...e)=>M.send_message&&M.send_message(...e)),["prevent"])),style:{"max-width":"100%"}},[(0,s.Lk)("div",V,[(0,s.Lk)("div",B,[(0,s.Lk)("div",H,[I,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.data.send.to=e),type:"text",id:"msg__send_to",name:"to",placeholder:"Email address(es)"},null,512),[[i.Jo,r.data.send.to]])]),(0,s.Lk)("div",K,[q,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.data.send.cc=e),type:"text",id:"msg__send_cc",name:"cc",placeholder:"Email address(es)"},null,512),[[i.Jo,r.data.send.cc]])]),(0,s.Lk)("div",P,[R,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.data.send.bcc=e),type:"text",id:"msg__send_bcc",name:"bcc",placeholder:"Email address(es)"},null,512),[[i.Jo,r.data.send.bcc]])]),(0,s.Lk)("div",W,[G,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>r.data.send.from=e),type:"text",id:"msg__send_from",name:"from",placeholder:`The ${this.$env.VUE_APP_BRAND_NAME_LONG} Team`},null,8,Y),[[i.Jo,r.data.send.from]])])]),(0,s.Lk)("div",z,[(0,s.Lk)("div",Z,[ee,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>r.data.send.template=e),id:"msg__send_template",name:"template",onClick:t[6]||(t[6]=e=>{r.data.templates.loading&&M.fetch_templates()})},[(0,s.Lk)("option",te,(0,l.v_)(r.data.templates.loading?r.data.templates.load_triggered?"Loading...":"Click to load options":"Select a template"),1),ae,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.data.templates.list,((e,t)=>((0,s.uX)(),(0,s.CE)("option",{key:t,value:t},[(0,s.eW)(" ["),(0,s.Lk)("strong",null,(0,l.v_)(t),1),(0,s.eW)('] - "'+(0,l.v_)(e.subject)+'" ',1)],8,se)))),128))],512),[[i.u1,r.data.send.template]])]),r.data.send.template?((0,s.uX)(),(0,s.CE)("div",le,["custom"==r.data.send.template?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>r.data.send.subject=e),type:"text",id:"msg__send_subject",placeholder:"Enter the subject of your message",title:"Enter the subject of your message"},null,512),[[i.Jo,r.data.send.subject]]),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[8]||(t[8]=e=>r.data.send.content=e),id:"msg__send_contents",placeholder:"Enter the primary (HTML) content of your message - note that most email clients will strip out <style> tags and inline styles are recommended; css3 is not supported in most clients.",title:"Enter the html content of your message",rows:"5"},null,512),[[i.Jo,r.data.send.content]]),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[9]||(t[9]=e=>r.data.send.text=e),id:"msg__send_text",placeholder:"Enter the alt (plaintext) content of your message (optional)",title:"Enter the text content of your message",rows:"5"},null,512),[[i.Jo,r.data.send.text]])],64)):(0,s.bo)(((0,s.uX)(),(0,s.CE)("textarea",{key:1,onInput:t[10]||(t[10]=(...e)=>M.format_template_data&&M.format_template_data(...e)),"onUpdate:modelValue":t[11]||(t[11]=e=>r.data.send.data=e),id:"msg__send_data",placeholder:"JSON data to be used when rendering the handlebars template",title:"Enter data to be used in the template",rows:"5"},null,544)),[[i.Jo,r.data.send.data]])])):(0,s.Q3)("",!0)]),r.data.send.template&&"custom"!=r.data.send.template?((0,s.uX)(),(0,s.CE)("div",ie,[(0,s.Lk)("div",ne,[(0,s.bF)(J,{class:"click-action",value:r.data.send.raw,onUpdate:t[12]||(t[12]=e=>r.data.send.raw=!r.data.send.raw),loads:!1},null,8,["value"]),(0,s.eW)("Â Â "),de]),(0,s.Lk)("div",_e,[(0,s.bF)(J,{disabled:M.template_html.error,class:"click-action",value:r.data.send.raw_html&&!M.template_html.error,onUpdate:t[13]||(t[13]=e=>r.data.send.raw_html=!r.data.send.raw_html),loads:!1},null,8,["disabled","value"]),(0,s.eW)("Â Â "),me])])):(0,s.Q3)("",!0),(0,s.Lk)("div",oe,[(0,s.Lk)("button",{type:"submit",class:(0,l.C4)({disabled:M.send_issues}),title:"Attempt to send this message"},"Send",2),(0,s.Lk)("button",{type:"button",title:"Clear message options",onClick:t[14]||(t[14]=e=>M.clear_send()),style:{flex:"0 0 auto"}},"Clear")])])],32),(0,s.Lk)("div",ce,["custom"==r.data.send.template?((0,s.uX)(),(0,s.CE)("div",re,[r.data.send.content?((0,s.uX)(),(0,s.CE)("div",{key:1,innerHTML:r.data.send.content},null,8,ge)):((0,s.uX)(),(0,s.CE)("span",pe,"Add some content to preview your messages"))])):r.data.send.template&&r.data.send.raw_html&&!M.template_html.error?((0,s.uX)(),(0,s.CE)("div",ue,(0,l.v_)(M.template_html.html),1)):r.data.send.template?((0,s.uX)(),(0,s.CE)("div",{key:2,class:"msg_page_list_item_content__html msg__send_preview__html msg__send_custom_preview__html",innerHTML:M.template_html.html},null,8,he)):((0,s.uX)(),(0,s.CE)("div",ve,ye))])])):"templates"==r.page?((0,s.uX)(),(0,s.CE)("div",we,[(0,s.Lk)("table",fe,[(0,s.Lk)("tr",be,[Le,r.data.view.active?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[Ce,Ee],64))]),r.data.templates.loading?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(M.placeholder(8),(e=>((0,s.uX)(),(0,s.CE)("tr",{class:"msg_page_list_item msg_page_list_item_loading msg__templates_list_item part_loading_animation",key:e},Oe)))),128)):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.data.templates.list,((e,t,a)=>((0,s.uX)(),(0,s.CE)("tr",{class:(0,l.C4)(["msg_page_list_item msg__templates_list_item admin_in",{active:r.data.templates.active==t}]),key:t,style:(0,l.Tr)({animationDelay:.03*(a+2)+.2+"s"})},[(0,s.Lk)("td",xe,(0,l.v_)(t),1),(0,s.Lk)("td",Xe,(0,l.v_)(e.subject),1),(0,s.Lk)("td",$e,(0,l.v_)(e.text),1),r.data.templates.active==t?((0,s.uX)(),(0,s.CE)("div",Te,[(0,s.Lk)("div",{class:"msg_templates_preview__html msg_page_list_item_content__html",innerHTML:e.html},null,8,Se)])):(0,s.Q3)("",!0),r.data.templates.active==t?((0,s.uX)(),(0,s.CE)("div",Ae,[(0,s.Lk)("div",{class:"msg_templates_preview__text",innerHTML:e.text.replace(/\\n/g,"<br/>")},null,8,Qe)])):(0,s.Q3)("",!0),(0,s.Lk)("button",{class:(0,l.C4)(["msg__templates_list_item__toggle msg_list_item__toggle",{click_escape:r.data.templates.active==t}]),onClick:e=>r.data.templates.active=r.data.templates.active==t?null:t,title:"Close email contents preview"},[(0,s.Lk)("div",{class:"msg_list_item__toggle__icon themed_icon",title:`${r.data.templates.active==t?"Collapse":"Expand"} preview of ${t}`},null,8,je)],10,Ne)],6)))),128)),Object.keys(r.data.templates.list).length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("tr",De,Fe))],64))])])):(0,s.Q3)("",!0)])]))],8,d)}a(4114);var Ve=a(6669),Be=a(9218),He=a(4186),Ie=a(8144),Ke=a.n(Ie),qe=a(4027),Pe={name:"MessagesAlerts",components:{ToggleBar:qe.A},data(){return{page:"choose",choices:{view:{name:"View Sent",active:"Sent Messages"},send:{name:"Send New",active:"Create Message"},templates:{name:"Templates",active:"Message Templates"}},data:{view:{list:{},loading:!0,active:null,placeholder:this.placeholder(3)},send:{sending:!1,to:"",cc:"",bcc:"",template:"",data:"",content:"",text:"",subject:"",raw:!1,raw_html:!1},templates:{list:{},loading:!0,load_triggered:!1,active:null,placeholder:this.placeholder(8)}}}},methods:{async fetch_templates(){if(this.data.templates.list={},this.data.templates.loading=!0,this.data.templates.load_triggered)return;this.data.templates.load_triggered=!0;const e=(0,Be.Qg)(Ve.Cn,"getTemplates"),t=Date.now(),{data:a,error:s}=await e(),l=Date.now()-t;if(s)return this.$status.error(`ðŸ“ƒ Failed to fetch templates after ${l}ms`,s),void new He.Qp("Something went wrong loading the templates",s,2500);{const e=Object.keys(a||{}).length;this.$status.log(`ðŸ“ƒ Fetched ${e} template${1==e?"":"s"} in ${l}ms`),this.data.templates.list=a||{},this.data.templates.loading=!1,this.data.templates.load_triggered=!1}},async fetch_messages(){this.data.view.list={},this.data.view.loading=!0;const e=(0,Be.Qg)(Ve.Cn,"getSentMessages"),t=Date.now(),{data:a,error:s}=await e(),l=Date.now()-t;if(s)return this.$status.error(`ðŸ“ƒ Failed to fetch messages after ${l}ms`,s),void new He.Qp("Something went wrong loading sent messages",s,2500);{const e=Object.keys(a||{}).length;this.$status.log(`ðŸ“ƒ Fetched ${e} messages${1==e?"":"s"} in ${l}ms`),this.data.view.list=a||{},this.data.view.loading=!1}},placeholder(e){return Array.from({length:e},((e,t)=>t))},date_of(e){const t=1e3*(e?.delivery?.startTime?._seconds+e?.delivery?.startTime?._nanoseconds/1e9),a=new Date(t);return isNaN(a.getTime())?"Unknown":a.toLocaleDateString()},status_of(e){return e?.delivery?.state||"N/A"},format_template_data(){try{this.data.send.data=JSON.stringify(JSON.parse(this.data.send.data),null,2);let e=document.querySelector(".toast:not(.noremove)");return e&&(e.style="animation:slideOut 0.25s forwards"),!0}catch(e){return new He.MY("Failed to parse JSON data, your message will not send correctly: "+e,3500),!1}},clear_send(e=!0){this.data.send={sending:!1,to:"",cc:"",bcc:"",template:"",data:"",content:"",text:"",subject:""},e&&new He.rQ("Message options cleared",2e3)},async send_message(){if(this.send_issues)new He.Qp("Cannot send message",this.send_issues,Math.max(2500,Math.min(1e3*this.send_issues.split(",").length,8e3)));else{this.data.send.sending=!0;const e=(0,Be.Qg)(Ve.Cn,"sendEmail"),t=Date.now(),{data:a}=await e({to:this.data.send.to,cc:this.data.send.cc,from:{name:this.data.send.from||`The ${this.$env.VUE_APP_BRAND_NAME_LONG} Team`,address:this.$env.VUE_APP_BRAND_MAIL_ADDRESS},bcc:this.data.send.bcc,..."custom"==this.data.send.template?{message:{subject:this.data.send.subject,html:this.data.send.content,text:this.data.send.text}}:{template:{name:this.data.send.template,data:JSON.parse(this.data.send.data)}}}),s=Date.now()-t;a?(this.$status.log(`ðŸ“§ Queued message in ${s}ms as ${a.id}`,a),new He.rQ("Message queued successfully",2e3),this.clear_send(!1)):(this.$status.error(`ðŸ“§ Failed to send message after ${s}ms`,a),new He.Qp("Failed to send message",a,2500))}}},computed:{template_html(){if(this.data.send.raw)return{html:new(Ke().SafeString)(this.data.templates.list[this.data.send.template]?.html),error:!1};const e=Ke().compile(this.data.templates.list[this.data.send.template]?.html);try{const t=JSON.parse(this.data.send.data||"{}");return{html:e(t||{}),error:!1}}catch(t){return{html:new(Ke().SafeString)(`<b>Failed to build html from template:</b> <pre>${t}</pre>`),error:!0}}},send_issues(){let e=[];if(this.data.send.sending)return"Message already being queued...";if(this.data.send.to||this.data.send.cc||this.data.send.bcc)for(let t of["to","cc","bcc"]){if(!this.data.send[t])continue;let a=this.data.send[t].trim().split(/[\s,]+/);for(let s of a)s.match(/^[^@]+@[^@]+\.[^@]+$/)||e.push(`Invalid email address in '${t}': "${s}"`)}else e.push("No recipient email address provided");return this.data.send.template?"custom"==this.data.send.template?(this.data.send.subject||e.push("No subject provided"),this.data.send.content||e.push("No content provided")):this.data.send.data?this.format_template_data()||e.push("Cannot parse JSON template data"):e.push("No data provided for template"):e.push("No template selected"),e.join(", ")}},mounted(){this.$route?.query?.action&&(this.page=this.$route.query.action)},watch:{page(){this.$router.push({query:{...this.$route.query,action:"choose"==this.page?void 0:this.page}}),"templates"==this.page&&this.data.templates.loading?this.fetch_templates():"view"==this.page&&this.data.view.loading&&this.fetch_messages(),this.data.templates.active=null,this.data.view.active=null}}},Re=a(1241);const We=(0,Re.A)(Pe,[["render",Ue],["__scopeId","data-v-20c7a614"]]);var Ge=We}}]);